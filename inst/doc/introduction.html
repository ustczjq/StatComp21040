<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jiaqi Zhang" />

<meta name="date" content="2021-12-19" />

<title>Introduction to StatComp21040</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Introduction to StatComp21040</h1>
<h4 class="author">Jiaqi Zhang</h4>
<h4 class="date">2021-12-19</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p><br />
Three functions are included and three numeric experiments are implemented in this package to demonstrate two methods for the detection of change point. <em>ChangePoint</em> is implemented using the MCMC method, and the <em>Checkfunction1</em> and <em>Checkfunction2</em> are inspired by an intuitive idea, enable to deal with different types of change points. Specific procedures will be introduced later.<br />
<br />
The numeric study consists of one simulation test and two real-data analysis. Notably, the ChangePoint is a universal method, Checkfunction1 is easy to implement and Checkfunction2 can detect possible change points in different perspectives. Notably, Checkfunction1 and Checkfunction2 can act as auxiliary tools for further improvement of ChangePoint.</p>
</div>
<div id="changepoint" class="section level2">
<h2><em>ChangePoint</em></h2>
<p><br />
Suppose that the expected value of <span class="math inline">\(Z_{i}\)</span> is constant, being the same for the first <span class="math inline">\(r\)</span> observations but different for the last <span class="math inline">\(N-r\)</span> observations, i.e. the change point occurs at <span class="math inline">\(r\)</span>.<br />
Exact form of the model is <span class="math display">\[
Z_{i} \sim \begin{cases}N\left(\mu_{1}, \sigma^{2}\right), &amp; 1 \leqslant i \leqslant r, \\ N\left(\mu_{2}, \sigma^{2}\right), &amp; r&lt;i \leqslant N,\end{cases}
\]</span> where <span class="math inline">\(r, \mu_{1}, \mu_{2}\)</span> and <span class="math inline">\(\sigma^{2}\)</span> are unknown random parameters to be estimated.<br />
<br />
Use Bayesian approach and MCMC method to estimate them.<br />
Notice that we will use the notation <span class="math inline">\(Z_{i} \sim N\left(\mu_{i}, 1 / \gamma\right), i=1,2,\gamma=1 / \sigma^{2}\)</span> for a simplification of result.</p>
<p>Assume that <span class="math inline">\(r, \mu_{1}, \mu_{2}\)</span> and <span class="math inline">\(\gamma\)</span> are independent random variables. <span class="math inline">\(r\)</span> follows a discrete uniform distribution on the set <span class="math inline">\(\{1, \ldots, N\}, \quad \mathcal{L}\left(\mu_{1}\right) \sim N\left(\nu_{1}, \xi_{1}^{2}\right), \quad \mathcal{L}\left(\mu_{2}\right) \sim N\left(\nu_{2}, \xi_{2}^{2}\right),\quad \mathcal{L}(\gamma) \sim G a(1,1)\)</span></p>
<p><br />
Then the density of the prior distribution is <span class="math display">\[f\left(\mu_{1}, \mu_{2}, \gamma, r\right) \propto \exp \left\{-\frac{1}{2}\left(\mu_{1}-\nu_{1}\right)^{2} / \xi_{1}^{2}-\frac{1}{2}\left(\mu_{2}-\nu_{2}\right)^{2} / \xi_{2}^{2}-\gamma\right\}\]</span><br />
The likelihood function of the sequence <span class="math inline">\(Z_{1}, \ldots, Z_{N}\)</span> for given values of parameters is <span class="math display">\[
f\left(z_{1}, \ldots, z_{N} \mid \mu_{1}, \mu_{2}, \gamma, r\right) \propto \gamma^{N / 2} \exp \left(-\frac{\gamma}{2}\left[\sum_{i=1}^{r}\left(z_{i}-\mu_{1}\right)^{2}+\sum_{i=r+1}^{N}\left(z_{i}-\mu_{2}\right)^{2}\right]\right)
\]</span> and the posterior distribution: <span class="math display">\[
f_{\mu_{1}, \mu_{2}, \gamma, r \mid z} \propto \gamma^{N / 2} \exp \left(-\frac{\left(\mu_{1}-\nu_{1}\right)^{2}}{2 \xi_{1}^{2}}-\frac{\left(\mu_{2}-\nu_{2}\right)^{2}}{2 \xi_{2}^{2}}-\gamma-\frac{\gamma}{2}\left[\sum_{i=1}^{r}\left(z_{i}-\mu_{1}\right)^{2}+\sum_{i=r+1}^{N}\left(z_{i}-\mu_{2}\right)^{2}\right]\right),
\]</span><br />
<br />
The MCMC algorithm generates each observation of the desired random sample in four steps as follows:<br />
(1) Generate a candidate <span class="math inline">\(r^{\prime}\)</span> for new value of the parameter <span class="math inline">\(r\)</span> from <span class="math inline">\(R\{1, \ldots, N\}\)</span>.<br />
(2) Accept the candidate <span class="math inline">\(r^{\prime}\)</span> from step 1 with an appropriate probability, i.e. <span class="math inline">\(r^{(n+1)}=r^{\prime}\)</span> if accepted else <span class="math inline">\(r^{(n+1)}=r^{(n)} .\)</span><br />
(3) Generate new values <span class="math inline">\(\mu_{1}^{(n+1)}\)</span> and <span class="math inline">\(\mu_{2}^{(n+1)}\)</span> from the conditional distribution <span class="math inline">\(f_{\mu_{1}, \mu_{2}} \mid \gamma, r, z\)</span>, where the values <span class="math inline">\(\gamma=\gamma^{(n)}\)</span> and <span class="math inline">\(r=r^{(n+1)}\)</span> are given.<br />
(4) Generate a new value <span class="math inline">\(\gamma^{(n+1)}\)</span> from the conditional distribution <span class="math inline">\(f_{\gamma \mid \mu_{1}, \mu_{2}, r, \boldsymbol{z}}\)</span>, where the values <span class="math inline">\(\mu_{1}=\mu_{1}^{(n+1)}, \mu_{2}=\mu_{2}^{(n+1)}\)</span> and <span class="math inline">\(r=r^{(n+1)}\)</span> are given.<br />
<br />
The density of the conditional distributions for steps 3 and 4 <span class="math inline">\(f_{\mu_{1}, \mu_{2} \mid \gamma, r, z}\)</span> has the form <span class="math display">\[
\begin{aligned}
f_{\mu_{1}, \mu_{2}} \mid \gamma, r, z \propto &amp; \exp \left(-\left[\frac{\left(\mu_{1}-\nu_{1}\right)^{2}}{2 \xi_{1}^{2}}+\frac{\gamma}{2} \sum_{i=1}^{r}\left(z_{i}-\mu_{1}\right)^{2}\right]\right) \\
&amp; \times \exp \left(-\left[\frac{\left(\mu_{2}-\nu_{2}\right)^{2}}{2 \xi_{2}^{2}}+\frac{\gamma}{2} \sum_{i=r+1}^{N}\left(z_{i}-\mu_{2}\right)^{2}\right]\right)
\end{aligned}
\]</span><br />
Further, elementary calculations and substitutions <span class="math inline">\(M_{1}(r)=\sum_{i=1}^{r} z_{i}\)</span> and <span class="math inline">\(M_{2}(r)=\sum_{i=r+1}^{N} z_{i}\)</span> show that <span class="math inline">\(f_{\mu_{1}, \mu_{2}} \mid \gamma, r, z\)</span> is the density of a two-dimensional normal distribution with the mean <span class="math inline">\(\boldsymbol{\mu}\)</span> and the variance matrix <span class="math inline">\(\boldsymbol{\Sigma}\)</span>, where <span class="math display">\[
\boldsymbol{\mu}=\left(\begin{array}{c}
\frac{\nu_{1}+\gamma \xi_{1}^{2} M_{1}(r)}{1+\gamma \xi_{1}^{2} r} \\
\frac{\nu_{2}+\gamma \xi_{2}^{2} M_{2}(r)}{1+\gamma \xi_{2}^{2}(N-r)}
\end{array}\right) \quad \text { and } \quad \boldsymbol{\Sigma}=\left(\begin{array}{cc}
\frac{\xi_{1}^{2}}{1+\gamma \xi_{1}^{2} r} &amp; 0 \\
0 &amp; \frac{\xi_{2}^{2}}{1+\gamma \xi_{2}^{2}(N-r)}
\end{array}\right)
\]</span><br />
The density <span class="math inline">\(f_{\gamma \mid \mu_{1}, \mu_{2}, r, z}\)</span> can be calculated analogously as above and we get <span class="math display">\[
f_{\gamma \mid \mu_{1}, \mu_{2}, r, z} \propto \gamma^{N / 2} \exp \left(-\gamma\left[1+\frac{1}{2} \sum_{i=1}^{r}\left(z_{i}-\mu_{1}\right)^{2}+\frac{1}{2} \sum_{i=r+1}^{N}\left(z_{i}-\mu_{2}\right)^{2}\right]\right),
\]</span> i.e. <span class="math inline">\(f_{\gamma \mid \mu_{1}, \mu_{2}, r, z}\)</span> is the density of a gamma distribution with the shape parameter <span class="math inline">\(\frac{1}{2} N+1\)</span> and the scale parameter <span class="math inline">\(\left(1+\frac{1}{2}\left[\sum_{i=1}^{r}\left(z_{i}-\mu_{1}\right)^{2}+\sum_{i=r+1}^{N}\left(z_{i}-\mu_{2}\right)^{2}\right]\right)^{-1} .\)</span><br />
<br />
The only parameter we generate using the <em>Metropolis-Hastings algorithm</em> is the <strong>change point <span class="math inline">\(r\)</span></strong>. Notice that we do not use the Gibbs sampler due to the fact that the conditional distribution <span class="math inline">\(f_{r \mid \mu_{1}, \mu_{2}, \gamma, z}\)</span> is too complex to sample. Therefore, we always generate a candidate for <span class="math inline">\(r\)</span> and this is accepted with some probability in the next step. The formal way to fix this acceptance probability has been derived in,so we just state the right form of it. More precisely, we use <span class="math inline">\(\alpha\left(\boldsymbol{x}^{(n)}, \boldsymbol{x}^{\prime}\right)=\min \left(1, \beta\left(\boldsymbol{x}^{(n)}, \boldsymbol{x}^{\prime}\right)\right)\)</span>, where <span class="math display">\[
\beta\left(\boldsymbol{x}^{(n)}, \boldsymbol{x}^{\prime}\right)=\frac{f_{\mu_{1}, \mu_{2}, \gamma, r \mid z}\left(\boldsymbol{x}^{\prime}\right)}{f_{\mu_{1}, \mu_{2}, \gamma, r \mid z}\left(\boldsymbol{x}^{(n)}\right)}
\]</span> Substituting the posterior density to it, we obtain the final form of the acceptance probability <span class="math inline">\(\beta\left(\boldsymbol{x}^{(n)}, \boldsymbol{x}^{\prime}\right)\)</span> equal to <span class="math display">\[
\begin{aligned}
\exp \left(\frac { \gamma ^ { ( n ) } } { 2 } \left[\sum_{i=1}^{r^{(n)}}\left(z_{i}-\mu_{1}^{(n)}\right)^{2}+\sum_{i=r^{(n)}+1}^{N}\left(z_{i}-\mu_{2}^{(n)}\right)^{2}\right.\right.&amp;-\sum_{i=1}^{r^{\prime}}\left(z_{i}-\mu_{1}^{(n)}\right)^{2}\left.\left.-\sum_{i=r^{\prime}+1}^{N}\left(z_{i}-\mu_{2}^{(n)}\right)^{2}\right]\right)
\end{aligned}
\]</span> which can be equivalently written in the form <span class="math display">\[
\beta\left(\boldsymbol{x}^{(n)}, \boldsymbol{x}^{\prime}\right)=\left\{\begin{array}{l}
\exp \left(\frac { \gamma ^ { ( n ) } } { 2 } \left[\sum_{i=r^{(n)}}+1\right.\right. \qquad r^{\prime}&gt;r^{(n)}\\
\exp \left(\frac{\gamma^{(n)}}{2}\left[\sum_{i=r^{\prime}+1}^{r^{(n)}}\left(z_{i}-\mu_{2}^{(n)}\right)^{2}-\sum_{i=r^{(n)}+1}^{r^{\prime}}\left(z_{i}-\mu_{1}^{(n)}\right)^{2}\right]\right) \qquad r^{\prime} \leqslant r^{(n)}\\
\end{array}\right.
\]</span><br />
The R codes for ChangePoint is as follows:<br />
</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>ChangePoint<span class="ot">&lt;-</span><span class="cf">function</span> (y,v1,v2,e1,e2,N,burnin){</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  mu1<span class="ot">&lt;-</span>mu2<span class="ot">&lt;-</span>sd1<span class="ot">&lt;-</span>sd2<span class="ot">&lt;-</span>GAMMA<span class="ot">&lt;-</span>R<span class="ot">&lt;-</span>prob<span class="ot">&lt;-</span>cp<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">length</span>(y) </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  prob[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  R[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="dv">1</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  GAMMA[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rgamma</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  m<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(N)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  sd1<span class="ot">&lt;-</span>e1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>GAMMA[<span class="dv">1</span>]<span class="sc">*</span>e1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>R[<span class="dv">1</span>])</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  sd2<span class="ot">&lt;-</span>e2<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>GAMMA[<span class="dv">1</span>]<span class="sc">*</span>e2<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(n<span class="sc">-</span>R[<span class="dv">1</span>]))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  mean1<span class="ot">&lt;-</span>(v1<span class="sc">+</span>GAMMA[<span class="dv">1</span>]<span class="sc">*</span>e1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>(y[<span class="dv">1</span><span class="sc">:</span>R[<span class="dv">1</span>]]))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>GAMMA[<span class="dv">1</span>]<span class="sc">*</span>e1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>R[<span class="dv">1</span>])</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  mean2<span class="ot">&lt;-</span>(v2<span class="sc">+</span>GAMMA[<span class="dv">1</span>]<span class="sc">*</span>e2<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>(y[(R[<span class="dv">1</span>]<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n]))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>GAMMA[<span class="dv">1</span>]<span class="sc">*</span>e2<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(n<span class="sc">-</span>R[<span class="dv">1</span>]))</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  mu1[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span>mean1,<span class="at">sd=</span>sd1)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  mu2[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span>mean2,<span class="at">sd=</span>sd2)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#generate the change point r using the Metropolis-Hastings algorithm for the complex conditional </span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">#distribution of r given other parameters is hard to sample from.</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>R[i]<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="dv">1</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>kt<span class="ot">&lt;-</span>R[i<span class="dv">-1</span>]</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (kt<span class="sc">&lt;</span>R[i]) {prob[i<span class="dv">-1</span>]<span class="ot">&lt;-</span><span class="fu">exp</span>(GAMMA[i<span class="dv">-1</span>]<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span>(<span class="fu">sum</span>((y[(kt<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>R[i]]<span class="sc">-</span>mu2[i<span class="dv">-1</span>])<span class="sc">^</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">sum</span>((y[(kt<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>R[i]]<span class="sc">-</span>mu1[i<span class="dv">-1</span>])<span class="sc">^</span><span class="dv">2</span>)))}</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> {prob[i<span class="dv">-1</span>]<span class="ot">&lt;-</span><span class="fu">exp</span>(GAMMA[i<span class="dv">-1</span>]<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span>(<span class="fu">sum</span>((y[<span class="fu">min</span>(R[i<span class="dv">-1</span>]<span class="sc">+</span><span class="dv">1</span>,n)<span class="sc">:</span>kt]<span class="sc">-</span>mu1[i<span class="dv">-1</span>])<span class="sc">^</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">sum</span>((y[<span class="fu">min</span>(R[i<span class="dv">-1</span>]<span class="sc">+</span><span class="dv">1</span>,n)<span class="sc">:</span>kt]<span class="sc">-</span>mu2[i<span class="dv">-1</span>])<span class="sc">^</span><span class="dv">2</span>)))}</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (u[i]<span class="sc">&lt;=</span><span class="fu">min</span>(prob[i<span class="dv">-1</span>],<span class="dv">1</span>))  {r<span class="ot">&lt;-</span>R[i];  m<span class="ot">&lt;-</span>m<span class="sc">+</span><span class="dv">1</span>;}</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> {r<span class="ot">&lt;-</span>kt}</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>cp[i]<span class="ot">&lt;-</span>r;</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (r<span class="sc">==</span>n){</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>mean1<span class="ot">&lt;-</span>(v1<span class="sc">+</span>GAMMA[i<span class="dv">-1</span>]<span class="sc">*</span>e1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>(y[<span class="dv">1</span><span class="sc">:</span>r]))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>GAMMA[i<span class="dv">-1</span>]<span class="sc">*</span>e1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>r)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>mean2<span class="ot">&lt;-</span>v2<span class="sc">+</span>GAMMA[i<span class="dv">-1</span>]<span class="sc">*</span>e2<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>y[n]</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>sd1<span class="ot">&lt;-</span>e1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>GAMMA[i<span class="dv">-1</span>]<span class="sc">*</span>e1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>r)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>sd2<span class="ot">&lt;-</span>e2<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>mu1[i]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span>mean1,<span class="at">sd=</span>sd1)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>mu2[i]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span>mean2,<span class="at">sd=</span>sd2)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">+</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>((y[<span class="dv">1</span><span class="sc">:</span>r]<span class="sc">-</span>mu1[i])<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span>(y[n]<span class="sc">-</span>mu2[i])<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>GAMMA[i]<span class="ot">&lt;-</span><span class="fu">rgamma</span>(<span class="dv">1</span>,<span class="at">shape=</span>n<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>,<span class="at">rate=</span>z)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> {</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>mean1<span class="ot">&lt;-</span>(v1<span class="sc">+</span>GAMMA[i<span class="dv">-1</span>]<span class="sc">*</span>e1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>(y[<span class="dv">1</span><span class="sc">:</span>r]))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>GAMMA[i<span class="dv">-1</span>]<span class="sc">*</span>e1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>r)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>mean2<span class="ot">&lt;-</span>(v2<span class="sc">+</span>GAMMA[i<span class="dv">-1</span>]<span class="sc">*</span>e2<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>(y[(r<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n]))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>GAMMA[i<span class="dv">-1</span>]<span class="sc">*</span>e2<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(n<span class="sc">-</span>r))</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>sd1<span class="ot">&lt;-</span>e1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>GAMMA[i<span class="dv">-1</span>]<span class="sc">*</span>e1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>r)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>sd2<span class="ot">&lt;-</span>e2<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>GAMMA[i<span class="dv">-1</span>]<span class="sc">*</span>e2<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(n<span class="sc">-</span>r))</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>mu1[i]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span>mean1,<span class="at">sd=</span>sd1)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>mu2[i]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span>mean2,<span class="at">sd=</span>sd2)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">+</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>((y[<span class="dv">1</span><span class="sc">:</span>r]<span class="sc">-</span>mu1[i])<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>((y[(r<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n]<span class="sc">-</span>mu2[i])<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>GAMMA[i]<span class="ot">&lt;-</span><span class="fu">rgamma</span>(<span class="dv">1</span>,<span class="at">shape=</span>n<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>,<span class="at">rate=</span>z)</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(cp)[(burnin<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="checkfunction1" class="section level2">
<h2><em>Checkfunction1</em></h2>
<p><br />
The function Checkfunction1 can be used as a preliminary detection for possible change point. This function is inspired by the intuitive idea that <strong>the slope of change point and its neighbor points should be large</strong>. To simulate the different degrees of impact, I adopt the idea of kernel density estimation by computing a weighted mean of slopes. This is an easy and feasible method for many cases, like a prominent <strong>“V” type</strong> change point,<strong>the piece-wise constant case with a sudden change</strong> and so on.<br />
<br />
The R codes for Checkfunction1 is as follows:<br />
</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Checkfunction1<span class="ot">&lt;-</span><span class="cf">function</span> (y,k,p){</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  index1<span class="ot">&lt;-</span><span class="fu">seq</span>(k,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  index2<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">1</span>,k,<span class="dv">1</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  weight1<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">^</span>index1)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  weight2<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">^</span>index2)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  weight<span class="ot">&lt;-</span><span class="fu">c</span>(weight1,<span class="dv">0</span>,weight2)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">length</span>(y)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  averageslope<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i<span class="sc">&gt;</span>k <span class="sc">&amp;</span> i<span class="sc">&lt;</span>n<span class="sc">-</span>k ){averageslope[i]<span class="ot">&lt;-</span><span class="fu">weighted.mean</span>(<span class="at">x=</span><span class="fu">abs</span>(y[(i<span class="sc">-</span>k)<span class="sc">:</span>(i<span class="sc">+</span>k)]<span class="sc">-</span>y[i]),<span class="at">wt=</span>weight<span class="sc">/</span><span class="fu">sum</span>(weight))}</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {averageslope[i]<span class="ot">&lt;-</span><span class="sc">-</span><span class="dv">1</span> }</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">match</span>(<span class="fu">sort</span>(averageslope,<span class="at">decreasing=</span><span class="cn">TRUE</span>),averageslope)[<span class="dv">1</span><span class="sc">:</span>p])</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
</div>
<div id="checkfunction2" class="section level2">
<h2><em>Checkfunction2</em></h2>
<p><br />
However,for some certain types,for example: <strong>a sudden continuing increase/decrease like a cliff</strong>, function Checkfunction1 fails to detect the most obvious change point as the change point’ slope might be smaller than the non-change ones’ slopes. Therefore, I further improve the original algorithm <strong>using the ratio of two near slopes to magnify the change</strong> which are computed with k nearest points.<br />
<br />
This function manifests priority in detecting possible change point in both <strong>macro and micro perspective</strong> (i.e. the span of period considered, by adjusting the parameter k, which means the number of k nearest points).<br />
<br />
The R codes for Checkfunction2 is as follows:<br />
</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Checkfunction2<span class="ot">&lt;-</span><span class="cf">function</span> (y,k,p){</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">length</span>(y)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  deviation<span class="ot">&lt;-</span>slope1<span class="ot">&lt;-</span>slope2<span class="ot">&lt;-</span>ratio<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i<span class="sc">&gt;</span>k <span class="sc">&amp;</span> i<span class="sc">&lt;</span>n<span class="sc">-</span>k ) {slope1[i]<span class="ot">&lt;-</span>(y[i]<span class="sc">-</span>y[i<span class="sc">-</span>k])<span class="sc">/</span>k</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    slope2[i]<span class="ot">&lt;-</span>(y[i<span class="sc">+</span>k]<span class="sc">-</span>y[i])<span class="sc">/</span>k</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    ratio[i]<span class="ot">&lt;-</span>(slope1[i]<span class="sc">/</span>slope2[i])</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (ratio[i]<span class="sc">&lt;</span><span class="dv">0</span><span class="sc">&amp;</span><span class="fu">abs</span>(slope1[i])<span class="sc">&gt;</span><span class="fu">median</span>(<span class="fu">abs</span>(slope1))<span class="sc">&amp;</span><span class="fu">abs</span>(slope2[i])<span class="sc">&gt;</span><span class="fu">median</span>(<span class="fu">abs</span>(slope2)) )</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    {deviation[i]<span class="ot">&lt;-</span><span class="fu">max</span>(ratio[i],<span class="dv">1</span><span class="sc">/</span>ratio[i])<span class="sc">+</span><span class="fu">max</span>(<span class="fu">abs</span>(slope1[i]<span class="sc">/</span><span class="fu">median</span>(slope1[i])),<span class="fu">abs</span>(slope2[i]<span class="sc">/</span><span class="fu">median</span>(slope2[i])))       }</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (ratio[i]<span class="sc">&gt;</span><span class="dv">0</span>) {deviation[i]<span class="ot">&lt;-</span><span class="fu">max</span>(ratio[i],<span class="dv">1</span><span class="sc">/</span>ratio[i]) }</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {deviation[i]<span class="ot">&lt;-</span><span class="sc">-</span><span class="fl">0.001</span> }</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">match</span>(<span class="fu">sort</span>(deviation,<span class="at">decreasing=</span><span class="cn">TRUE</span>),deviation)[<span class="dv">1</span><span class="sc">:</span>p])</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><br />
</p>
</div>
<div id="numeric-experiments" class="section level2">
<h2><em>Numeric</em> <em>Experiments</em></h2>
<p><br />
<br />
<strong>·Piece-wise constant case with a sudden change</strong><br />
</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">40</span>,<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">60</span>,<span class="dv">10</span>,<span class="dv">1</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">c</span>(x1,x2)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y,<span class="at">main=</span><span class="st">&quot;The overview of simulation data&quot;</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">length</span>(x1),<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>s<span class="ot">&lt;-</span><span class="fu">ChangePoint</span>(y,<span class="at">v1=</span><span class="dv">5</span>,<span class="at">v2=</span><span class="dv">10</span>,<span class="at">e1=</span><span class="dv">1</span>,<span class="at">e2=</span><span class="dv">1</span>,<span class="at">N=</span><span class="dv">10000</span>,<span class="at">burnin=</span><span class="dv">1000</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(s,<span class="at">freq=</span><span class="cn">FALSE</span>,<span class="at">main=</span><span class="st">&quot;histogram of the change point&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>dens<span class="ot">&lt;-</span><span class="fu">density</span>(s,<span class="at">bw =</span> <span class="st">&quot;nrd0&quot;</span>,<span class="at">kernel=</span><span class="st">&#39;gaussian&#39;</span>,<span class="at">window=</span>kernel)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dens,<span class="at">main=</span><span class="st">&quot;kernel estimation of the density of change point&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>dens<span class="sc">$</span>x[<span class="fu">which.max</span>(dens<span class="sc">$</span>y)],<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">length</span>(x1),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(results)<span class="ot">&lt;-</span><span class="st">&quot;Change point&quot;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Theoretical&quot;</span>,<span class="st">&quot;Computed&quot;</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>results[,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="dv">40</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>results[,<span class="dv">2</span>]<span class="ot">&lt;-</span>dens<span class="sc">$</span>x[<span class="fu">which.max</span>(dens<span class="sc">$</span>y)]</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(results,<span class="at">align=</span><span class="fu">rep</span>(<span class="st">&#39;c&#39;</span>, <span class="dv">5</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">Theoretical</th>
<th align="center">Computed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Change point</td>
<td align="center">40</td>
<td align="center">37.56592</td>
</tr>
</tbody>
</table>
<p><br />
We can see that the theoretical change point detected by ChangePoint almost has the highest density value.<br />
<br />
</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Checkfunction1</span>(y,<span class="dv">3</span>,<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 41 40</code></pre>
<p><br />
The Checkfunction1 successfully the two change points, showing its attribute to perform well in dealing with piece-wise constant situation.<br />
<br />
<strong>·“V” type change point case</strong><br />
</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>Japan<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">36.42584</span> ,<span class="fl">36.59264</span> ,<span class="fl">36.79944</span> ,<span class="fl">37.03648</span> ,<span class="fl">37.32840</span> ,<span class="fl">37.67568</span> ,<span class="fl">38.09784</span> ,<span class="fl">38.60000</span> ,<span class="fl">39.22192</span> ,<span class="fl">39.97360</span> ,<span class="fl">40.89944</span> ,<span class="fl">42.04432</span> ,<span class="fl">42.61632</span> ,<span class="fl">45.65936</span> ,<span class="fl">48.24248</span> ,<span class="fl">30.53680</span> ,<span class="fl">51.69000</span> ,<span class="fl">56.83000</span> ,<span class="fl">57.71000</span> ,<span class="fl">61.15200</span> ,<span class="fl">61.58300</span> ,<span class="fl">62.42700</span> ,<span class="fl">63.23400</span> ,<span class="fl">64.00500</span> ,<span class="fl">64.73900</span> ,<span class="fl">65.43700</span> ,<span class="fl">66.09900</span> ,<span class="fl">66.72700</span> ,<span class="fl">67.32200</span> ,<span class="fl">67.88700</span> ,<span class="fl">68.42400</span> ,<span class="fl">68.93500</span> ,<span class="fl">69.42600</span> ,<span class="fl">69.89800</span> ,<span class="fl">70.35100</span> ,<span class="fl">70.78600</span> ,<span class="fl">71.20000</span> ,<span class="fl">71.59600</span> ,<span class="fl">71.98000</span> ,<span class="fl">72.35800</span> ,<span class="fl">72.74000</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="dv">1930</span><span class="sc">:</span><span class="dv">1970</span>,<span class="at">y=</span>Japan,<span class="at">main=</span><span class="st">&quot;The overview of life expectancy of Japan from 1930 to 1970&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Life expectancy (year)&quot;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">which.min</span>(Japan)<span class="sc">+</span><span class="dv">1930-1</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAw1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmOpBmkLZmkNtmtttmtv+QOgCQOmaQZjqQkLaQtpCQttuQ27aQ29uQ2/+2ZgC2Zjq2ZpC2kGa227a229u22/+2/7a2/9u2///bkDrbtmbbtpDb27bb29vb2//b/7bb////AAD/tmb/25D/27b//7b//9v///96NyiTAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAOdUlEQVR4nO1dC3vbxhEcuXIqpW6ah5i6D0t1k1ZM07oJkrSVKZP4/7+quPcBxAF7hyN2LXH8SQapvdnh4F4ADiDaMyYBbgHSAW4B0gFuAdIBbgHSAW4B0gFuAdIBbgHSAW4B0gFuAdIBbgHSAW4B0gFuAdIBbgHSAW4B0gFuAdIBbgHSAW4B0gFuAdIBbgHSAW4B0gFuAdIBbgHSAW4B0gFuAdIBbgHSAW4B0gFuAdIBbgHSAW4B0gFuAdIBbgHSAW4B0oHZiMN318CXeusOLx/0r+jNKjj848fFFANFO+C2BhFmC3SZgBtdNBgU3qyBD69fLDZoqKjYoAERZgs0uLg3W8abwZs1sMVyg4aKig0aEGGrP/RW00WkP/8B+NWfzF9gi4Qa5N48fNf99+WDZ/OvH6/VZ+5iu9/dx/9nx3b5rhfR4adXXY43NkUX+PPr7v/P7o3Iv3eBl/dxXMd2NfzoYzJ7BgXOnoxUKk/Uvf3Na7x412KnaPcbXavCnmyg0Xk3ZZAq1uHS7f7odaMIGy1ya7g0SVzCvn/jDNqFsCYqEuIaIy+qb6MyY4MizlhGKlVskCVGt69v1Q7v9o7bRboCdH/TH3LYxEw7a2zOzuIu1rXY6HUXdvHNtaud3ds/qQxxRCfyq4cPG1vHdHX79YP9W6P3tMkf4rRU5bFVmZAZGRRzRjJSqaIm1r3x8l37n/YR2pVG70IjoA07Sf+XNqiTeqMZ7R7tvVae+xpwa8niCJOj+eJfUZ345ftX2kdT9TqKqzaKMzswamHjMntNLHBGMlKp+gbdmhTdpmoyn2xUtbI6XW+sY9MGaQ+i6tl/vXWDgZWkikQRUY9vIw5vzd+unEhdV+I4a6x7nZAZGxRxRjISqfoGabouRcd08bcN3tzhxqd24TpJ2iDbkr1B/de7a/u+VabIoojQnlvfxHD51182xwb5OFXFbSWckBkZFHNGMhKpRgzq3lc/n1+r6vOJT02vQb2RtPdaiTAs/Rp02/ZzeINMl7AfMcjHKbMiIxIyTT5tUMzZlzGWKlGDdFt4+bCLRwFyH+R3brxHbR68Mm2s3wf1q027++xbu7lzncFNX3UUp95/FfxKyNQdrhok7nuckYxUqmODVB+kW8aVHoB9avIodvGm7QYYVy56rRj+t3HjazSK+Ygu7ZeKzTUPnfPD3VHHEMWZXi7Mcsdluo7O1ErPGclIpRox6BGG0DTX3v6384Apg+ysxle88NrvwKswAVF7Oy6x9R2l2kUvfrjDeM8Z4rTIeNI9KtMVuLXt3HfSXsYhlerYIHWoYT6MH9gM9BT1z6HAqEHth7eduV+886X8613UurpK/cNbFxaX0DNklUNNry/fqaHl8tsmtBen2se11vJpme3h+y6HbpJtxBnLSKYaNejUqHGk5VB8hFUsA4XpMlDRoA+vy7megUG6Ays+x/I8DLr4am0ZKE74TABuAdIBbgHSAW4B0gFuAdIBbgHSAb/lztWUzlSfKGD+C8ci5krEGQ7Qv/e/jz3pv3rmALcA6YDbONxVu5L8pAC3sd+ce+cxwG/tzn3zGOA27MlQnMewPsAtQDrALUA64LdcGzs3sR7gt7YvHxp1yeg8mPUAt7Hf3LQ7dUEnXLg8ox3Mgx5/86P+OSMAbkPNpPdf358NGgB+q1FXH2/OTWwAhM2tXsFwHsT6ALcA6QC3AOlA2NyrZTvb80mPPuC3dhf3XQetpkNnRIDbUMO8GsGaRb00PhpkG6QmisqgZaeFyHnZYL0BOd5tuBq0XTQPIudlga057odWxm+ZPqiZvC7mFvclaxk57+ow5vjqA3K5sKnPd0ze5dS45Uu71Domct5VEcyBqz4gl83IE134SB2Q5NCtg745pzUouvCR6spz6E6PEXPMixKDhsvmR/BR1aCUOcWjmFmVPT1L9D34yfqg9+8XEhhMm6MjyFS9V3MeufPWyakAOW8CFQzSNsT/jszRUWS6wetmahDPp8vFcoOgDYl/H5ljw8h8AWqJkLprI3uumD+DT2ChQW4iaFsXxs3RkWRKvxVu90kNUfvNrHPkvAksMOi4V57aYck/JAP3m9k74febz69njvXJeRMoNGgwE7RVZ7IEmTpDhjoV0kxPBnLoxlBmEI7NmRMy9/dBIG2FmTlXNLwjqSxvAgUG+X7HTZNJHSElJg4krVH0J9N2yZGOnDeBTIPGmhaxJDmF35pf5Uo420jOWwXIb1pR0cqBrTSDQtPKNUeXrh7IQpdMMzx/kT0BI8fnEq9Ll85S0u8MKCoHstCNpljUtDxL9UAWuvEMS5pWRFM5kIXuiH5QexYwZQcSTpjVzJvA9DwIxpclTSuiyg6cP2FWMW8CUwahRtPyZGWBiz0i501gwiBUaVqBrTBQ6AkzW3uMQ0uTaMKiwOITZvl5E0gYhDB0Lc0QGHMD50+Y1cybwJhBvaFraQJPmh1IOGFWM28CQ4PCMUWtzscRVw9ch25gEOrMCkdApooCt/qxUMsGenLeBPoGoa0zKxwBmS0EmnUv+82i6SI5L5ntBLXHUecFugvvkhZQabb6tcdTZwW6C+9FS/CqXRcb8raLjykmmDMDzYX3x7kLO5XyUvlOYY4mLggMT19dIS83UD1wfbqT1R5NXj1wdTrUpRthzwycXaBZNW8Cbh7kas9SviTIxCFwW+M+H3LeBKxBsIcXkgyqcw8COW8CxiC0foK4kC8JMrEPrPNoCnLeBIJBJ5ogOpCZfeDhrsIp6ZoGiRvFdjWePUXOm0Dog048pSKz+8A6z+4g501gOIqdDGR6cuA6dJWWAc8D1QPXoZNsUJVnd5DzcgP5gVWe3UHOyw1kB9Z5dgc5LzeQHUh6dsdHfEPdAMgOpDy7Y50b6k4+xOsk+YHzz+5Y53Yo1KEhZMkNnH12xyo31KESDylNzcB2lRr0/j2q8MyCnMAHqv5HYeqyzxo31KEKzyzICXygM2jyss8aN9ShAs08yBlsoPviGwkLqISOYq4GlaWrdeFQ8rHYPPzdPqeZKCp7RRs0u7pDG6THr+T5WXLe8aKQbND86g5lkLWm/jBvSgo2iLC6Qxlkj/brTxRNScEGEVZ3rFCDyssXpcsKnF/dYWZBV+3ERTRy3vGiC4oXZMsNpKzu2G/MdxemXCTnHSu7xvzHJ6seeFq6Vc3RCasHnpQO5UULQc4WBdZ4jiI570ipsrKFICcLgVWeo0jOO1KqrGwhyMl8YKXnKC4opX4LngexPkcRrqhgg3ifo+hGMcEGkZ6jWC9vXCYa4iUbRHiOYsW8Lt7d62Qh2qBV8/pwU31cubNBR9HozRJFG6Sb2MJH/pPz6mBVez4eg3a6+2mWdULkvK2xBm1/saZggw53ZvhaaZgPN6Ke5m6e2fzZgZQLh/XyonU3olJLVAY5rQ90NWiF9UHRbcwrH8NHGvIDzTLgsoli1nUx+NrD50/RsVj4lCe8b75Xe7jaVyt0HmRqGH/t0VqyAw//PWneYA5/7dF6sgPdFcPDX6qPYgNzpmqP4HlQ10mrOWJTcZ208qVvzmztkWyQXcJa4Zx0MCZUmLFp8whEG6QdWnjHD8JPbEwwZ6bvEW3QFnhzt/BoFeEQPdscBcEGdfMgs/pnaR+EtqDmOEg26I+m6iwexdAORquco1HBBtXL639sZ51TXrRB1a6sFhjjINkgxiurDEB2IOeVVQYgO/C5fEOdBbIDn8M31EVAfuAT/4a6AVAQ+HS/oW4EqB7YfmTfLzYDVA9sV7mhzt0OdXKQ05AD2zVqEOztUKcHOQs5UOHUN9SZm1mWcZBT1Q7UOPENdR+/QSemE27QgoPVrAuHUzyS+yDywepuYrZEzpuA4FGMdLC6BW4ef/dwkhvqNASf7qAcrKrjtK1ZRpQa5heiq0ErIdsgwsGqrjePnyqDpo/5qdmJcSxhx+HzB6umf9LXqKcXyVA1EONYwkbCCQerrt7MdOVUDcQ4lrCycLuCce6JglRSYhxLWD+8610WPVigUAMxjiWsH941mbNBk+FNGP8qPBSYqoEYxxJ2FH6uQVXC65IS41jCCsOfH6B/q066ysNunx7ALUA6wC1AOjB8Y9ml56cHDN84G9QHhm+cDeoDwzfOBvWB4Rtng/rA8I2zQX1A/65zL9STBLgFSAe4BUgH6tDY55g37qS235i6ykimC0+XK6Lrs+1sV3JLY0NutlHsN7rnUtfM9IMW1dl9fR+++rXL/khDOnOpqS2kG7KZ966IbMjUPoqd6drNtQ53/Vp9m5JZUbTN/FqlIZ0fWYvojtgU1B6ksSFPe0LCjf4IZm+4faIMMnssc+n1MV1jP0QJ3ag4/bRIGhtypE/IiDTYa0LqEhHlMiyBbvtb6Dv9CumOxelv46OxIVP6lAa7S7SGnf5E/TpVSrffqIaxvSmlOxJnn/tMYkOm9CkNth+0Nehw9/JhkUF9OvXeEoNitphnVYPU8pgX//46DDmLmtiArqsCS5pYzGYWaKzfxAz8V7uoT1TSSafoPr0vpBuy2ZUF63fSBt1IalJ375UN87Xp+mzOmRWHeafBz750Hdb5yyaKR3TqQ2yL6QZsnmG9iaLbSeqQwCTcwt5h3hQdatSlG7L5VkVhQ2625wZwC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQDnALkA5wC5AOcAuQjv8DAv1YKNjO2oAAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>s<span class="ot">&lt;-</span><span class="fu">ChangePoint</span>(Japan,<span class="at">v1=</span><span class="dv">40</span>,<span class="at">v2=</span><span class="dv">65</span>,<span class="at">e1=</span><span class="dv">2</span>,<span class="at">e2=</span><span class="dv">2</span>,<span class="at">N=</span><span class="dv">10000</span>,<span class="at">burnin=</span><span class="dv">1000</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(s,<span class="at">freq=</span><span class="cn">FALSE</span>,<span class="at">main=</span><span class="st">&quot;histogram of the change point&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>dens<span class="ot">&lt;-</span><span class="fu">density</span>(s,<span class="at">bw =</span> <span class="st">&quot;nrd0&quot;</span>,<span class="at">kernel=</span><span class="st">&#39;gaussian&#39;</span>,<span class="at">window=</span>kernel)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dens,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">main=</span><span class="st">&quot;kernel estimation of the density of change point&quot;</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>dens<span class="sc">$</span>x[<span class="fu">which.max</span>(dens<span class="sc">$</span>y)],<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">which.min</span>(Japan),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(results)<span class="ot">&lt;-</span><span class="st">&quot;Change point&quot;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Theoretical&quot;</span>,<span class="st">&quot;Computed&quot;</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>results[,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">which.min</span>(Japan)<span class="sc">-</span><span class="dv">1</span><span class="sc">+</span><span class="dv">1930</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>results[,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">round</span>(dens<span class="sc">$</span>x[<span class="fu">which.max</span>(dens<span class="sc">$</span>y)]<span class="sc">-</span><span class="dv">1</span><span class="sc">+</span><span class="dv">1930</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(results,<span class="at">align=</span><span class="fu">rep</span>(<span class="st">&#39;c&#39;</span>, <span class="dv">5</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">Theoretical</th>
<th align="center">Computed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Change point</td>
<td align="center">1945</td>
<td align="center">1944</td>
</tr>
</tbody>
</table>
<p>ChangePoint performs well in this case.<br />
The change point of life expectancy of Japan occurs at <strong>1945</strong>,which corresponds to <strong>Japan’s surrender in the world war Ⅱ</strong>.<br />
</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Checkfunction1</span>(Japan,<span class="dv">2</span>,<span class="dv">1</span>)<span class="sc">+</span><span class="dv">1930-1</span></span></code></pre></div>
<pre><code>## [1] 1945</code></pre>
<p><br />
The change point is detected precisely by Checkfunction1.<br />
<br />
<strong>cliff type change point case</strong><br />
</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>China<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.1422</span> ,<span class="fl">0.1792</span> ,<span class="fl">0.2197</span> ,<span class="fl">0.2255</span> ,<span class="fl">0.2668</span> ,<span class="fl">0.3112</span> ,<span class="fl">0.3473</span> ,<span class="fl">0.4056</span> ,<span class="fl">0.8193</span> ,<span class="fl">1.1076</span> ,<span class="fl">1.2096</span> ,<span class="fl">0.8505</span> ,<span class="fl">0.6738</span> ,<span class="fl">0.6579</span> ,<span class="fl">0.6504</span> ,<span class="fl">0.6908</span> ,<span class="fl">0.7401</span> ,<span class="fl">0.6035</span> ,<span class="fl">0.6320</span> ,<span class="fl">0.7540</span> ,<span class="fl">0.9763</span> ,<span class="fl">1.0712</span> ,<span class="fl">1.1140</span> ,<span class="fl">1.1336</span> ,<span class="fl">1.1317</span> ,<span class="fl">1.2774</span> ,<span class="fl">1.3010</span> ,<span class="fl">1.3998</span> ,<span class="fl">1.5355</span> ,<span class="fl">1.5471</span> ,<span class="fl">1.4944</span> ,<span class="fl">1.4561</span> ,<span class="fl">1.5629</span> ,<span class="fl">1.6253</span> ,<span class="fl">1.7434</span> ,<span class="fl">1.8577</span> ,<span class="fl">1.9216</span> ,<span class="fl">2.0229</span> ,<span class="fl">2.1322</span> ,<span class="fl">2.1269</span> ,<span class="fl">2.1114</span> ,<span class="fl">2.1847</span> ,<span class="fl">2.2630</span> ,<span class="fl">2.3971</span> ,<span class="fl">2.5203</span> ,<span class="fl">2.7060</span> ,<span class="fl">2.7989</span> ,<span class="fl">2.7814</span> ,<span class="fl">2.6419</span> ,<span class="fl">2.6144</span> ,<span class="fl">2.6649</span> ,<span class="fl">2.7056</span> ,<span class="fl">2.9622</span> ,<span class="fl">3.4555</span> ,<span class="fl">3.9482</span> ,<span class="fl">4.4159</span> ,<span class="fl">4.8481</span> ,<span class="fl">5.1847</span> ,<span class="fl">5.5386</span> ,<span class="fl">5.7939</span> ,<span class="fl">6.2950</span> ,<span class="fl">6.9223</span> ,<span class="fl">7.0623</span> ,<span class="fl">7.1506</span> ,<span class="fl">7.1353</span> ,<span class="fl">7.0003</span> ,<span class="fl">6.8742</span> ,<span class="fl">6.9812</span> ,<span class="fl">7.2077</span> ,<span class="fl">7.3163</span> ,<span class="fl">7.4117</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="dv">1950</span><span class="sc">:</span><span class="dv">2020</span>,<span class="at">y=</span>China,<span class="at">main=</span><span class="st">&quot;The overview of Annual CO2 emissions per capita of China from 1950 to 2020&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Annual CO2 emissions per capita (ton)&quot;</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">2001</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Changepoint method</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>s<span class="ot">&lt;-</span><span class="fu">ChangePoint</span>(China,<span class="at">v1=</span><span class="dv">1</span>,<span class="at">v2=</span><span class="dv">5</span>,<span class="at">e1=</span><span class="dv">1</span>,<span class="at">e2=</span><span class="dv">2</span>,<span class="at">N=</span><span class="dv">10000</span>,<span class="at">burnin=</span><span class="dv">1000</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(s,<span class="at">freq=</span><span class="cn">FALSE</span>,<span class="at">main=</span><span class="st">&quot;histogram of the change point&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>dens<span class="ot">&lt;-</span><span class="fu">density</span>(s,<span class="at">bw =</span> <span class="st">&quot;nrd0&quot;</span>,<span class="at">kernel=</span><span class="st">&#39;gaussian&#39;</span>,<span class="at">window=</span>kernel)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dens,<span class="at">main=</span><span class="st">&quot;kerne estimation of the density of changepoint&quot;</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>dens<span class="sc">$</span>x[<span class="fu">which.max</span>(dens<span class="sc">$</span>y)],<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">50</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(results)<span class="ot">&lt;-</span><span class="st">&quot;Change point&quot;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Theoretical&quot;</span>,<span class="st">&quot;Computed&quot;</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>results[,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="dv">2001</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>results[,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">round</span>(dens<span class="sc">$</span>x[<span class="fu">which.max</span>(dens<span class="sc">$</span>y)]<span class="sc">+</span><span class="dv">1950</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(results,<span class="at">align=</span><span class="fu">rep</span>(<span class="st">&#39;c&#39;</span>, <span class="dv">5</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">Theoretical</th>
<th align="center">Computed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Change point</td>
<td align="center">2001</td>
<td align="center">2000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Checkfunction2 method</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>micro<span class="ot">&lt;-</span><span class="fu">Checkfunction2</span>(China,<span class="dv">3</span>,<span class="dv">6</span>)<span class="sc">+</span><span class="dv">1950-1</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>macro<span class="ot">&lt;-</span><span class="fu">Checkfunction2</span>(China,<span class="dv">10</span>,<span class="dv">6</span>)<span class="sc">+</span><span class="dv">1950-1</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">6</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(results)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;micro perspective&quot;</span>,<span class="st">&quot;macro perspective&quot;</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>results[<span class="dv">1</span>,]<span class="ot">&lt;-</span>micro</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>results[<span class="dv">2</span>,]<span class="ot">&lt;-</span>macro</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(results,<span class="at">align=</span><span class="fu">rep</span>(<span class="st">&#39;c&#39;</span>, <span class="dv">5</span>))</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">micro perspective</td>
<td align="center">1969</td>
<td align="center">2001</td>
<td align="center">1982</td>
<td align="center">1958</td>
<td align="center">1979</td>
<td align="center">1971</td>
</tr>
<tr class="even">
<td align="left">macro perspective</td>
<td align="center">2001</td>
<td align="center">2000</td>
<td align="center">1999</td>
<td align="center">2002</td>
<td align="center">1998</td>
<td align="center">1967</td>
</tr>
</tbody>
</table>
<p><br />
We can see Checkfunction2 returns not exactly the same possible change points with different settings of parameters.<br />
<br />
In a microscopic perspective,i.e. consider a short period, using small k, the detection turns delicate,corresponds to many historical events affecting China’s development of industry,and further affecting the CO2 emissions.<br />
But in a macroscopic perspective,i.e. consider a long span, using large k, the detection still turns useful. The years around <strong>2001</strong> are prominent, which corresponds to <strong>China’s participation in WTO</strong>, and of course this is the most important affair affecting China’s development in industry.<br />
</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="dv">1950</span><span class="sc">:</span><span class="dv">2020</span>,<span class="at">y=</span>China,<span class="at">main=</span><span class="st">&quot;The most possible 6 change points of CO2 emissions of China&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Annual CO2 emissions per capita (ton)&quot;</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>micro,<span class="at">col=</span><span class="st">&quot;green&quot;</span>,<span class="at">lwd=</span><span class="fl">1.5</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="dv">1950</span><span class="sc">:</span><span class="dv">2020</span>,<span class="at">y=</span>China,<span class="at">main=</span><span class="st">&quot;The most possible 6 change points of CO2 emissions of China&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Annual CO2 emissions per capita (ton)&quot;</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>macro,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">lwd=</span><span class="fl">1.5</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
<br />
In summary, all three methods work well in the numeric experiments. But pros and cons exist for different methods.<br />
<br />
ChangePoint is a general recommendation in detecting the most prominent change point. But as the model considered in the Changepoint is quite simple, it may not perform well in dealing with complex problems.<br />
Checkfunction1 and Checkfunction2 then can be used as assistance,which satisfies the detection of change points with different types. What’s more, they can also be used to help decide the span to use a one-time Changepoint for some times, which well surely improve the preciseness.<br />
<br />
</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
