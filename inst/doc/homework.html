<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jiaqi Zhang" />

<meta name="date" content="2021-12-19" />

<title>Homework to StatComp21040</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Homework to StatComp21040</h1>
<h4 class="author">Jiaqi Zhang</h4>
<h4 class="date">2021-12-19</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>Codes of previous homework in this class.</p>
</div>
<div id="title-20210916" class="section level2">
<h2>title: “2021—09—16”</h2>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p><br />
<strong>Example 1:</strong><br />
<br />
(a). Generate two random number vectors of uniform distribution.<br />
(b). Try to obtain normal distributed random numbers based on the first step.Plot the histograms of the generated normal ones.</p>
<p><br />
<strong>Example 2:</strong><br />
<br />
(a). Compare the generated normal random numbers with the ones generated by function rnorm() via Q-Q plots.<br />
(b). Use Cramer-von Mises test to further verify if we successfully generate random numbers of normal distribution.</p>
<p><br />
<strong>Example 3:</strong><br />
<br />
Implement a linear regression on the dataset <em>trees</em> and see if the linear form is suitable.<br />
<br />
</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p><br />
</p>
<p><strong>Example 1:</strong></p>
<p><br />
First,generate two random number vectors <span class="math inline">\(U\)</span>,<span class="math inline">\(V\)</span>.<br />
</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7725</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1</span>)          <span class="co"># U ~ U[0,1]</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>V <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1</span>)          <span class="co"># v ~ U[0,1]</span></span></code></pre></div>
As <span class="math inline">\(U,V \sim U[0,1]\)</span>,we can further generate random numbers from normal distribution:<br />
<br />

<center>
<span class="math inline">\(Z_{1}=\sqrt{-2logU}cos(2\pi V)\sim N[0,1]\)</span>
</center>
<br />

<center>
<span class="math inline">\(Z_{2}=\sqrt{-2logU}sin(2\pi V)\sim N[0,1]\)</span>
</center>
<p><br />
<em>Proof:</em>   Solve <span class="math inline">\(U,V\)</span> through <span class="math inline">\(Z_{1},Z_{2}\)</span> ,the Jacobian <span class="math inline">\(J\)</span> yields as:<br />
</p>
<center>
<span class="math inline">\(J=\frac{\partial (U,V)}{\partial (Z_1,Z_2)}=\begin{vmatrix} \frac{\partial U}{\partial Z_1} &amp; \frac{\partial U}{\partial Z_2}\\ \\ \frac{\partial V}{\partial Z_1}&amp; \frac{\partial V}{\partial Z_2} \end{vmatrix}=-\frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}} \cdot \frac{1}{\sqrt{2\pi}}e^{-\frac{y^2}{2}}\)</span>
</center>
Therefore,
<center>
<span class="math inline">\(f_{Z_1,Z_2}(x,y)=\frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}} \cdot \frac{1}{\sqrt{2\pi}}e^{-\frac{y^2}{2}},x,y \in R\)</span>
</center>
<br />

<center>
<span class="math inline">\(Z_{1},Z_{2}\sim N[0,1]\)</span>
</center>
<p><br />
Generate normal random numbers and plot the histograms：<br />
</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(U))<span class="sc">*</span><span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>V)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(U))<span class="sc">*</span><span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>V)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(m,<span class="at">main =</span> <span class="st">&quot;Histogram of Z1&quot;</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(n,<span class="at">main =</span> <span class="st">&quot;Histogram of Z2&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The histograms show highly possible normality.</p>
<p><br />
</p>
<p><strong>Example 2:</strong></p>
<p><br />
Use Q-Q plots to compare the generated normal random numbers with the ones generated by function rnorm().<br />
</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>r<span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(r,m,<span class="at">ann=</span><span class="st">&quot;FALSE&quot;</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Normal Q-Q plots for U&quot;</span>,<span class="at">adj=</span><span class="fl">0.5</span>,<span class="at">line=</span><span class="dv">1</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(r,n,<span class="at">ann=</span><span class="st">&quot;FALSE&quot;</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Normal Q-Q plots for V&quot;</span>,<span class="at">adj=</span><span class="fl">0.5</span>,<span class="at">line=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As the curves are close to straight lines,we can regard the generated randoms are from normal contribution <span class="math inline">\(N(0,1)\)</span>.<br />
</p>
<p>In spite of the strong visuality,the methods already presented are both subject methods.Therefore,we consider objective methods like Cramer-von Mises test to verify.<br />
</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nortest)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cvm.test</span>(m)</span></code></pre></div>
<pre><code>## 
##  Cramer-von Mises normality test
## 
## data:  m
## W = 0.11223, p-value = 0.07638</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cvm.test</span>(n)</span></code></pre></div>
<pre><code>## 
##  Cramer-von Mises normality test
## 
## data:  n
## W = 0.097633, p-value = 0.1211</code></pre>
<p><br />
Considering the randomness,the relatively low p-values verify the feasibility to generate normal random numbers from uniform ones.</p>
<p><br />
</p>
<p><strong>Example 3:</strong></p>
<p><br />
First of all,introduce the dataset <em>trees</em> ,which contains 31 observations on 3 variables.<br />
<br />
Variables used in the linear regression are:<br />
Girth：numeric diameter in inches<br />
Height：numeric Height in ft<br />
Volume：numeric Volume of timber in cubic ft</p>
<p>Have a qucik glimpse of the dataset trees and show the main components as following table:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(trees))     </span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Girth</th>
<th align="right">Height</th>
<th align="right">Volume</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">8.3</td>
<td align="right">70</td>
<td align="right">10.3</td>
</tr>
<tr class="even">
<td align="right">8.6</td>
<td align="right">65</td>
<td align="right">10.3</td>
</tr>
<tr class="odd">
<td align="right">8.8</td>
<td align="right">63</td>
<td align="right">10.2</td>
</tr>
<tr class="even">
<td align="right">10.5</td>
<td align="right">72</td>
<td align="right">16.4</td>
</tr>
<tr class="odd">
<td align="right">10.7</td>
<td align="right">81</td>
<td align="right">18.8</td>
</tr>
<tr class="even">
<td align="right">10.8</td>
<td align="right">83</td>
<td align="right">19.7</td>
</tr>
</tbody>
</table>
<p>Implement the linear regression in the form: <span class="math inline">\(Y=\beta_{0}+\beta_{1}X_{1}+\beta_{2}X_{2}\)</span>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>lmtrees <span class="ot">&lt;-</span> <span class="fu">lm</span>(Volume<span class="sc">~</span>Girth<span class="sc">+</span>Height,<span class="at">data=</span>trees)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmtrees)<span class="sc">$</span>coef</span></code></pre></div>
<pre><code>##                Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept) -57.9876589  8.6382259 -6.712913 2.749507e-07
## Girth         4.7081605  0.2642646 17.816084 8.223304e-17
## Height        0.3392512  0.1301512  2.606594 1.449097e-02</code></pre>
<p>Therefore we have regression:<span class="math inline">\(Volume=-57.9876589+ 4.7081605 Girth+0.3392512 Height\)</span>.</p>
<p>Use plot(lm) to check whether the linear regression is suitable or not.<br />
</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lmtrees)  </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p><br />
<strong>The above four figures contain useful information:</strong><br />
</p>
<p>The first figure indicates that a model-correction can be considered since residuals(real value - fitted value) and fitted value are correlated(quadratic relationship).</p>
<p>Linear regression requires the normality of residual.The second figure manifests that the residuals are approximately normal distributed.</p>
<p>Equal variance hypothesis is also needed for regression,which is verified in the third picture.</p>
<p>The last figure indicates possible outliers and influential points(Cook’s distance &gt; 0.5),the 31th observation should be studied carefully.</p>
<p><br />
<br />
</p>
</div>
<div id="title-20210923" class="section level2">
<h2>title: “2021—09—23”</h2>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p><br />
<strong>3.4</strong><br />
The Rayleigh density is <span class="math inline">\(f(x) = \frac{x}{\sigma ^2}e^{-\frac{x^2}{2\sigma ^2}},\  x\geq 0,\sigma\geq 0\)</span> Develop an algorithm to generate random samples from a Rayleigh<span class="math inline">\((\sigma)\)</span> distribution. Generate Rayleigh<span class="math inline">\((\sigma)\)</span> samples for several choices of <span class="math inline">\(\sigma &gt; 0\)</span> and check that the mode of the generated samples is close to the theoretical mode <span class="math inline">\((\sigma)\)</span> (check the histogram).</p>
<p><br />
<strong>3.11</strong><br />
</p>
<p>Generate a random sample of size 1000 from a normal location mixture. The components of the mixture have <span class="math inline">\(N(0, 1)\)</span> and <span class="math inline">\(N(3, 1)\)</span> distributions with mixing probabilities <span class="math inline">\(p_1\)</span>and <span class="math inline">\(p_2=1-p_1\)</span>. Graph the histogram of the sample with density superimposed, for <span class="math inline">\(p_1 = 0.75\)</span>. Repeat with different values for p1 and observe whether the empirical distribution of the mixture appears to be bimodal. Make a conjecture about the values of<span class="math inline">\(p_1\)</span> that produce bimodal mixtures.</p>
<p><br />
<strong>3.20</strong><br />
<em>A compound Poisson process</em> is a stochastic process <span class="math inline">\({X(t), t ≥ 0}\)</span> that can be represented as the random sum <span class="math inline">\(X(t) =\sum_{i=1}^{N(t)}Y_i,\ t\geq 0\)</span>,where <span class="math inline">\(N(t),\ t\geq 0\)</span> is a Poisson process and <span class="math inline">\(Y1, Y2\)</span>,… are iid and independent of <span class="math inline">\(N(t),\ t\geq 0\)</span>. Write a program to simulate a compound Poisson(<span class="math inline">\(\lambda\)</span>)–Gamma process (<span class="math inline">\(Y\)</span> has a Gamma distribution). Estimate the mean and the variance of <span class="math inline">\(X(10)\)</span> for several choices of the parameters and compare with the theoretical values. Hint: Show that <span class="math inline">\(E[X(t)] = λtE[Y_1]\)</span> and <span class="math inline">\(Var(X(t)) = λtE[Y_1^2]\)</span>.<br />
</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p><br />
</p>
<p><strong>3.4:</strong><br />
For continuous situation,we can use the inverse transition method:<br />
<br />
As <span class="math inline">\(f(x) = \frac{x}{\sigma ^2}e^{-\frac{x^2}{2\sigma ^2}},\  x\geq 0\)</span>, <span class="math inline">\(F(x)=1-e^{-\frac{x^2}{2\sigma ^2}}\)</span><br />
Then,<span class="math inline">\(U=F_X(x)\sim U(0,1)\)</span><br />
Because <span class="math inline">\(x\geq 0\)</span>,we have <span class="math inline">\(x=\sqrt{2\sigma^2 ln^{\tfrac{1}{1-u}}}\)</span>,which should be Rayleigh distributed.<br />
Set <span class="math inline">\(\sigma=1,5,15\)</span>,respectively.<br />
Plot the histograms.<br />
</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1</span>)        </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>C1<span class="ot">&lt;-</span><span class="dv">1</span>                                 <span class="co"># sigma = 1</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>C1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>U)) </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">probability=</span><span class="cn">TRUE</span>,<span class="at">main=</span><span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span>x<span class="sc">%.%</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">frac</span>(x<span class="sc">^</span><span class="dv">2</span>,<span class="dv">2</span>))))</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>z1<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(z1,z1<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>z1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>C2<span class="ot">&lt;-</span><span class="dv">5</span>                                 <span class="co"># sigma = 5</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>C2<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>U)) </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y,<span class="at">probability=</span><span class="cn">TRUE</span>,<span class="at">main=</span><span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fu">frac</span>(x,<span class="dv">25</span>)<span class="sc">%.%</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">frac</span>(x<span class="sc">^</span><span class="dv">2</span>,<span class="dv">50</span>))))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>z2<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,<span class="fl">0.05</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(z2,z2<span class="sc">/</span><span class="dv">25</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>z2<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">50</span>),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>C3<span class="ot">&lt;-</span><span class="dv">15</span>                                <span class="co"># sigma = 15</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>w<span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>C3<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>U)) </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(w,<span class="at">probability=</span><span class="cn">TRUE</span>,<span class="at">main=</span><span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fu">frac</span>(x,<span class="dv">225</span>)<span class="sc">%.%</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">frac</span>(x<span class="sc">^</span><span class="dv">2</span>,<span class="dv">500</span>))))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>z3<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">55</span>,<span class="fl">0.1</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(z3,z3<span class="sc">/</span><span class="dv">225</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>z3<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">500</span>),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><br />
The histograms show that the mode of the generated samples is close to the theoretical mode <span class="math inline">\(\sigma\)</span>.<br />
<br />
<strong>3.11:</strong><br />
<br />
Generate two random samples <span class="math inline">\(X_1 \sim N(0,1),X_2 \sim N(3,1)\)</span>.<br />
Mix them with probability <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span>,respectively to obtain a mixture <span class="math inline">\(Z\)</span>,<span class="math inline">\(Z=p_1X_1+p_2X_2\)</span>.<br />
Firstly,consider <span class="math inline">\(p_1=0.75,p_2=0.25\)</span>.<br />
</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>X1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>X2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Use sample method to simulate p1=0.75</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>r1<span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),n,<span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.75</span>,<span class="fl">0.25</span>))</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>Z1<span class="ot">&lt;-</span>r1<span class="sc">*</span>X1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>r1)<span class="sc">*</span>X2</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Z1,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">9</span>),<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.28</span>),<span class="at">main=</span><span class="st">&quot;p1=0.75,p2=0.25&quot;</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(Z1),<span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
The center of the figure is at around 0,which is the mean of <span class="math inline">\(X_1\)</span>.The considerable proportion of <span class="math inline">\(p_1\)</span> may be accountable for this.<br />
<br />
Consider the counterpart form <span class="math inline">\(p_1=0.25,p_2=0.75\)</span>.<br />
</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>r2<span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),n,<span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.75</span>))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>Z2<span class="ot">&lt;-</span>r2<span class="sc">*</span>X1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>r2)<span class="sc">*</span>X2</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Z2,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">xlim =</span>  <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">9</span>),<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.3</span>),<span class="at">main=</span><span class="st">&quot;p1=0.25,p2=0.75&quot;</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(Z2),<span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
The center of the figure is at around 3,which is the mean of <span class="math inline">\(X_2\)</span>.The considerable proportion of <span class="math inline">\(p_2\)</span> may be accountable for this.<br />
<br />
Finally,let <span class="math inline">\(p_1=0.5,p_2=0.5\)</span>.<br />
</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>r3<span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),n,<span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>Z3<span class="ot">&lt;-</span>r3<span class="sc">*</span>X1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>r3)<span class="sc">*</span>X2</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Z3,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">9</span>),<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.25</span>),<span class="at">main=</span><span class="st">&quot;p1=0.5,p2=0.5&quot;</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(Z3),<span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAjVBMVEUAAAAAADoAAGYAAP8AOmYAOpAAZrY6AAA6ADo6Ojo6OmY6ZpA6ZrY6kNtmAABmADpmOgBmOjpmkLZmkNtmtttmtv+QOgCQZgCQZjqQttuQ2/+2ZgC2Zjq227a229u22/+2/7a2/9u2///T09PbkDrbkGbbtmbbtpDb////tmb/25D/27b//7b//9v///8CbspMAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKBElEQVR4nO2deWObNhyGSdTGO7ps3dasq7d1K/Qgjf39P94QAswh8QpdyOn7/OG6Nv4ZPdGNLIozWaXY+wRyh4IAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgLsIuhYvPwye+n0V1Hc/Hp5tSpa7nQf//q6eeeH9x4RNrCDIJmSuaDTwyw1R3Py6kP71s075whbSC/o8y/FUlBV3Px5/lgUb7r/P90XPxk+35i4fXd+PMxibIiwiSSCjsXt302xeCFLRZPzb1TiHlVOkHmhSfRdm/T+792898YQ4en14U698mFLBFcSCSqGUlEVL/55mAvq/tyXuqkuiu/H9cw4Qv/KRBCM4EoqQbfvz5/aCuHjqy+nhaDmqUre7YfhExMf4wgtbRHbEsGVVILenC9n3wkaMU/e6e2hKU2fL/XMLIKsYaYlCEZwJVUdJE+76v6eWFBHNWSAWYSv9/N6HkZwJaWguvurWxQxRT0X1EWQn9wawZUdc9BaFatYCFIRej+bIriyYx00baSbVy6N9OPrw6LKHSI8DeVrSwRXkrdiZ10dJLPG76qb177ZPDTdvk+H5gPq4HGE47KfuRrBj6T9oL6FWQq6DBTUm13eUJlCCeojDNlmmjfMEfxIVQf997Yofux6bRpBzQDtoIaa3ZtyQHrzavj/KEI3CJ0LMkfwI2Ul7frpuxB1iSv5C3o8vKGgFU5vf/OM4Ef2gkJFcIVTrgAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAcIIKgaChMuJwCmioLThMoCCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFATgpD2AOQiQlyAhRJjzCEdOgkRLqFMJREaCpJyMBT3de2+1c/YSpNwAQ+n1jVIk953x3bzSS9D4H8Mh6TPYNEXrjp7u5Xv1cuseU7gtyLTLfkLzr6HDIHapo+bnUa0kvxVUyc2Lnu4N24A6C2pTXpQNQsjHchHJqgiGZ3IeMnPIPcAM+1pJQZ2aynCIh6DzIEgYBKnH3QRdNperDVlICmq3OzIf4iCoGBWsFUFiqKPSGhq1YnDHwTg5aFSu2qedoVGkTqGqmfYT9LPyY8obZ5XH1FZ/qrpeC7fhDEa5piwHW4X+iPVmLgILQdXqVk+Noyaj1camzllQOREkNILUEWvNXBS6r+n3KfTtCrkJElDQ+AhTMxeHRQ4KFG7DR4Yk94JKnaByb0G7hSuG7DESJKaCxFSQvh8QhzwElVNB5UyQmB6xg6CmVVJN1Now4jwcYj4qmCAxFVROBYnUgiw5PaDdDF0EiecjqDEEpkTcBJVzQeWkOyjmR+wjSHb+KrS/cK2/WYXPpL2NoDIHQUd5G4a7du/dEOGsWeSPuSGhESR26Ac1gyyZP1aGGlvC2bNIfm9oeP9ywHgwsoegYyNnfahhHc4eoyDRv19kIagpW0/3L7883VsVMZPGcIIKMUwAZSKoHYfCZso6nC3LGuYiqLvMoRMk8mzmI4TT1DDq+WUOeimopKA2/V0py0RQd9+F1a2/4TFhBfVB8xB0xM1X1U8WGWfMNp+1rhFXz0foBIn0zTycKTs9DIcEm5PWtVHz57qnewiCd7wbHRLsqsb1CLJo4CPkIG0vJ09BpnHomKo/JFgdpO3l2AlKdHFjvLoDt2L9QcYhfzJBZXJB+4SjoHX0AwlLQWkMjVLUlJ+XX45+K4Q2C9J2A20EpcpCo0r65l0lR/MpLxxekyDZhsvGO+l8kJ+gJIYmHUUpyGlG0XVO2kdQkVhQn4OOXncF3CbINJmRpaCuDqr87rG9VdD5igSpXqDnfVvTCkphaNd+kJ+gNEup9hQkrkqQGmYlvfm4cUI1R0FHVTlXnmvtEwtKYKhLUd1Xzt0yX89w+LjRwlVnQUmykErRaLYszbX5bhmLOfmZCRqNwNIMNYpyvvbXTVB8Q70gONu8JZzFcUMG8hGUIgtREDrT9nEPQSKIoOiG9hS0lnw7QQmyUC8Irl/dEs7iuCsTlDxcCEGjn1GFTYRTigKH0yyv3yyofYy+nnNHQavJtxckKOibFKRZXu8kKPpyxTCxN0/aa1ePOwoSVyBoc7hwgmIvNnsOgqKuhNlJkP73B06CIi8V2k0QSP4mQTG70/sIMqwedxMU19A2QaGWARuWtl69oFDLgE1rfx0FRTW0RVCwRZymlZuugmJeZN0iKNgy4BiCYhnaIwcZ1/46C4o4tbixDgqyDNi4MNFdUDxD21qxIMuAzSs3PQRFM5S+H7SyaspZkJpbjDK5uIegc3BB8kHEmRpK3VEUa2tevAQpQ/sK8u8o9jVFDEGliNHap2zmRV9PmJZ0eAqKoihVR7H7ha51mt0ElcMPgYMRNQeJKVvS7Cio+zX5BCcvhhQBjB1F/Zz0RE5KdhOEO4rPj0Q/bLxeKAjgKMhvod41ET0HJa2dzbiff0AXG75gy6vxQthAQYDAg1XbL3imgvBg1fYLnqcgi6GG7Rc8T0FOa2G/JUHMQQh8VcP2C56pIJfB6rcl6BuEggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAVIIstsWrdZuf9XOgmvnVjRRHw+F7m668s6fzlu2JBBUW82OyP1n6oWh00PzUqVLtSZq3byiuatD1d5Tz9VQfEHtBp/wKDVbudh6Ru3Wo7mOq4mqQiyOVTvbOG9qE19Q9fIPC0FGE5JlztJFffxOu0Fd7oKa07apg1TqDNcCltvt66LWt//e6+qrvIuYzPc2glQm0WSVs24GXBu1ktczdRur66t/S2ILst3cc0VQvayjtVGrG30mlPnv8eC6N1tkQW3J8Stimiso+qiqAltswrZau2HiCWpvzV51q09gDWBMhm5fPn1UZXdRVa8VXgty6SgamvmzeW/ZRVR14XeRCZV6522RchFk6Ciu1B3LqLJmGl39HQ7MuQ5qsRtqVLq2pitMuvKhiVrrhyVH02jFBg5WARQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCBAxoL6XxD/ZLhun4aMBSnkujG5bMh5gY8nuQuS61baOzDqFh+mIHNBp4d+kQsFaamGglWxiGkYFobVHkug/Mha0KWATZ+nJGtBk2K1UzOWs6DpL3c870LtSs6C+p9oeC7k9SNjQZcfoBz163uTkLGgY7ee/k493aWAZS0oDygIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIMD/ItOStXt1wtQAAAAASUVORK5CYII=" /><!-- --></p>
<p><br />
The center of the figure is at around 2.<br />
Besides,the empirical distribution of the mixture appears to be bimodal.This happens when the mixture proportion is equal.<br />
<br />
<strong>Conjecture：</strong><br />
So we can speculate that for the normal distribution with different location parameter,but with the same shape parameter,<strong>the equal proportion (i.e. <span class="math inline">\(p_1=p_2\)</span>)situation</strong> is most likely to yield a bimodal mixture.<br />
<br />
</p>
<p><strong>3.20:</strong><br />
<br />
</p>
<p><span class="math inline">\(X=\sum_{i=1}^{N(t)}Y_i\)</span>,where <span class="math inline">\(N(t) \sim Possion(\lambda t),Y \sim \Gamma(\alpha ,\beta )\)</span><br />
<br />
<span class="math inline">\(E(N)=Var(N)=\lambda t,E(Y)=\frac{\alpha}{\beta},Var(Y)=\frac{\alpha}{\beta^2}\)</span><br />
<br />
We can obtain <span class="math inline">\(E(X)\)</span> and <span class="math inline">\(Var(X)\)</span> through the conditional expectation and conditional variance as follows:</p>
<p><span class="math display">\[\begin{split}
E(X)&amp;=E[E(\sum_{i=1}^{N}Y_i)|N]\\
&amp; =E(NE(Y_1))\\
&amp; =ENE(Y_1)&amp; \\
&amp; =\lambda tE(Y_1)
\end{split}\]</span><br />
</p>
<p><span class="math display">\[\begin{split}
Var(X)&amp;=Var(E(X|N))+E(Var(X|N))  \  \  (*)\\
&amp;=E(E[(\sum_{i=1}^{N}Y_i)^2]|N) \\
&amp;=E(N)Var(Y_1)+E(N^2)[E(Y_1)^2]$ \\
&amp;=Var(NE(Y_1))+E(NVar(Y_1)) \\
&amp;=E^2(Y_1)Var(N)+Var(Y_1)E(N)\\
&amp;=\lambda tE(Y_1^2)
\end{split}\]</span><br />
</p>
<p><span class="math display">\[\begin{split}
(*):\ Var(X)&amp;=E(X-EX)^2 \\
&amp;=E(X-E(X|N)+E(X|N)-EX)^2 \\
&amp;=E[E(X-E(X|N))^2|N]+Var(E(X|N))\\
&amp;=E(Var(X|N))+Var(E(X|N))
\end{split}\]</span></p>
<p><br />
Here is the program to simulate the compound Poisson–Gamma process.<br />
Firstly,define a function CPG to try different value combinations.<br />
(Note that <span class="math inline">\(t=10\)</span> is fixed,other parameters can be changed.)<br />
</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compound Poisson–Gamma process</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>CPG<span class="ot">&lt;-</span><span class="cf">function</span>(n,t,lamb,alpha,beta){</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fu">rpois</span>(n,lamb<span class="sc">*</span>t)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    Z[i]<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">rgamma</span>(N[i],alpha,beta));</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;The mean of X is &quot;</span>,<span class="fu">mean</span>(Z),<span class="st">&quot;,which is very close to the theoretical value &quot;</span>,lamb<span class="sc">*</span>t<span class="sc">*</span>alpha<span class="sc">/</span>beta))</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;The variance of X is &quot;</span>,<span class="fu">var</span>(Z),<span class="st">&quot;,which is very close to the theoretical value &quot;</span>,lamb<span class="sc">*</span>t<span class="sc">*</span>((alpha<span class="sc">/</span>beta)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(alpha<span class="sc">/</span>beta<span class="sc">^</span><span class="dv">2</span>))))</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Different parameter value combinations:</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="fu">CPG</span>(<span class="dv">1000</span>,<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)          </span></code></pre></div>
<pre><code>## [1] &quot;The mean of X is  10.3567880709835 ,which is very close to the theoretical value  10&quot;
## [1] &quot;The variance of X is  15.3896760125024 ,which is very close to the theoretical value  15&quot;</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CPG</span>(<span class="dv">2000</span>,<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] &quot;The mean of X is  29.8982985488827 ,which is very close to the theoretical value  30&quot;
## [1] &quot;The variance of X is  36.8109536209854 ,which is very close to the theoretical value  37.5&quot;</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CPG</span>(<span class="dv">1500</span>,<span class="dv">10</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;The mean of X is  4.89327241072687 ,which is very close to the theoretical value  5&quot;
## [1] &quot;The variance of X is  9.88363196342363 ,which is very close to the theoretical value  10&quot;</code></pre>
<p><br />
We can see that for several parameter combinations,both the mean and the variance of <span class="math inline">\(X(10)\)</span> are close to the theoretical values.</p>
<p><br />
<br />
## title: “2021—09—30”</p>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p><br />
<strong>5.4</strong><br />
Write a function to compute a Monte Carlo estimate of the <span class="math inline">\(Beta(3, 3)\)</span> cdf, and use the function to estimate <span class="math inline">\(F(x)\)</span> for <span class="math inline">\(x = 0.1, 0.2,..., 0.9\)</span>. Compare the estimates with the values returned by the pbeta function in R.</p>
<p><br />
<strong>5.9</strong><br />
The Rayleigh density is <span class="math inline">\(f(x) = \frac{x}{\sigma ^2}exp({-\frac{x^2}{2\sigma ^2}}),\  x\geq 0,\sigma\geq 0\)</span>.<br />
Implement a function to generate samples from a Rayleigh <span class="math inline">\((σ)\)</span> distribution,using antithetic variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+{X}&#39;}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X1, X2\)</span>?</p>
<p><br />
<strong>5.13</strong><br />
Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,+\infty)\)</span> and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}},\ x&gt;1\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math inline">\(\int_{1}^{\infty }\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx\)</span> by importance sampling? Explain.</p>
<p><br />
</p>
<p><strong>5.14</strong><br />
Obtain a Monte Carlo estimate of <span class="math inline">\(\int_{1}^{\infty }\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx\)</span> by importance sampling.<br />
</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p><br />
</p>
<p><strong>5.4:</strong><br />
<br />
</p>
<p>Use the Monte Carlo method to estimate <span class="math inline">\(F(x)\)</span> of <span class="math inline">\(Beta(3,3)\)</span>:<br />
</p>
<p><span class="math display">\[\begin{split}
F(x)&amp;=\int_{0}^{x}\frac{\Gamma (6)}{\Gamma (3)\Gamma (3)}t^2(1-t)^2dt,\ x\in [0,1] \\
&amp;=\int_{0}^{x}30t^2(1-t)^2dt \\
&amp;=\int_{0}^{x}x\cdot 30t^2(1-t)^2 \cdot \frac{1}{x}dt \\
&amp;=30x\cdot E(X^2(1-X)^2) ,\ X\sim U[0,1] \\
\end{split}\]</span><br />
</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="at">from=</span><span class="fl">0.1</span>,<span class="at">to=</span><span class="fl">0.9</span>,<span class="at">by=</span><span class="fl">0.1</span>) </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>E<span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">9</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>){</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,x[i])</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>E[i]<span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(x[i]<span class="sc">*</span><span class="dv">30</span><span class="sc">*</span>u<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">^</span><span class="dv">2</span>),<span class="dv">5</span>)   <span class="co">#</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>F<span class="ot">&lt;-</span><span class="fu">pbeta</span>(x,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;The Monte Carlo estimate of Beta(3,3) cdf F(x) for x=&quot;</span>,x,<span class="st">&quot; is &quot;</span>,E,<span class="st">&quot;,while the value returned by the pbeta function in R is &quot;</span>,F))</span></code></pre></div>
<pre><code>## [1] &quot;The Monte Carlo estimate of Beta(3,3) cdf F(x) for x= 0.1  is  0.00867 ,while the value returned by the pbeta function in R is  0.00856&quot;
## [2] &quot;The Monte Carlo estimate of Beta(3,3) cdf F(x) for x= 0.2  is  0.05815 ,while the value returned by the pbeta function in R is  0.05792&quot;
## [3] &quot;The Monte Carlo estimate of Beta(3,3) cdf F(x) for x= 0.3  is  0.16197 ,while the value returned by the pbeta function in R is  0.16308&quot;
## [4] &quot;The Monte Carlo estimate of Beta(3,3) cdf F(x) for x= 0.4  is  0.31824 ,while the value returned by the pbeta function in R is  0.31744&quot;
## [5] &quot;The Monte Carlo estimate of Beta(3,3) cdf F(x) for x= 0.5  is  0.4973 ,while the value returned by the pbeta function in R is  0.5&quot;     
## [6] &quot;The Monte Carlo estimate of Beta(3,3) cdf F(x) for x= 0.6  is  0.67389 ,while the value returned by the pbeta function in R is  0.68256&quot;
## [7] &quot;The Monte Carlo estimate of Beta(3,3) cdf F(x) for x= 0.7  is  0.83629 ,while the value returned by the pbeta function in R is  0.83692&quot;
## [8] &quot;The Monte Carlo estimate of Beta(3,3) cdf F(x) for x= 0.8  is  0.93607 ,while the value returned by the pbeta function in R is  0.94208&quot;
## [9] &quot;The Monte Carlo estimate of Beta(3,3) cdf F(x) for x= 0.9  is  0.99126 ,while the value returned by the pbeta function in R is  0.99144&quot;</code></pre>
<p><br />
The estimated values are close to the ones returned by pbeta(),which means the estimation is satisfactory.<br />
<br />
<br />
<strong>5.9:</strong><br />
<br />
As <span class="math inline">\(f(x) = \frac{x}{\sigma ^2}e^{-\frac{x^2}{2\sigma ^2}},\  x\geq 0\)</span>, <span class="math inline">\(F(x)=1-e^{-\frac{x^2}{2\sigma ^2}}\)</span>. Then,<span class="math inline">\(U=F_X(x)\sim U(0,1)\)</span>.<br />
Because <span class="math inline">\(x\geq 0\)</span>,we have <span class="math inline">\(x=\sqrt{-2\sigma^2 ln^{1-u}}\)</span>,which should be Rayleigh distributed.<br />
<br />
Then we use antithetic variables to generate samples from Rayleigh distribution.</p>
<p><br />
</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>MCR<span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">s=</span><span class="dv">1</span>,<span class="at">N=</span><span class="dv">1000</span>,<span class="at">antithetic=</span><span class="cn">TRUE</span>) {   <span class="co"># s means sigma</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N<span class="sc">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)              <span class="co"># half random numbers from U[0,1]</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>antithetic) </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">runif</span>(N<span class="sc">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)     <span class="co"># antithetic=False,i.e.the original situation</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> u</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">c</span>(u, v)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  X<span class="ot">&lt;-</span><span class="fu">mean</span>(s<span class="sc">*</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u)))</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  X</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>MCR1<span class="ot">&lt;-</span> MCR2<span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  MCR1[i]<span class="ot">&lt;-</span><span class="fu">MCR</span>(<span class="at">s=</span><span class="dv">2</span>,<span class="at">N=</span><span class="dv">1000</span>,<span class="at">anti=</span><span class="cn">FALSE</span>)    <span class="co">#Original method</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>  MCR2[i]<span class="ot">&lt;-</span><span class="fu">MCR</span>(<span class="at">s=</span><span class="dv">2</span>,<span class="at">N=</span><span class="dv">1000</span>,<span class="at">anti=</span><span class="cn">TRUE</span>)     <span class="co">#Antithetic method</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>VarianceRatio<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">var</span>(MCR2)<span class="sc">/</span><span class="fu">var</span>(MCR1),<span class="dv">4</span>)</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;The ratio of variance between two methods is&quot;</span>,VarianceRatio,<span class="st">&quot;and the percent reduction in variance is about&quot;</span>,<span class="fu">round</span>((<span class="fu">var</span>(MCR1)<span class="sc">-</span><span class="fu">var</span>(MCR2))<span class="sc">/</span><span class="fu">var</span>(MCR1),<span class="dv">4</span>)<span class="sc">*</span><span class="dv">100</span>,<span class="st">&quot;%&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;The ratio of variance between two methods is 0.0575 and the percent reduction in variance is about 94.25 %&quot;</code></pre>
<p><br />
Therefore,we can draw the conclusion that the antithetic method can greatly reduce the variance.<br />
<br />
<br />
<strong>5.13:</strong><br />
<br />
We choose <span class="math inline">\(f_1(x)=exp(-(x-1)),x\in(1,+\infty),f_2(x)=\frac{4}{\pi(1+x^2)},x\in(1,+\infty)\)</span> as importance functions.<br />
<br />
Now plot the curves of <span class="math inline">\(g(x),f_1(x),f_2(x)\)</span>.They are printed in red,blue and green,respectively.<br />
</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a> g<span class="ot">&lt;-</span><span class="cf">function</span>(x) </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>   {x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;=</span><span class="dv">1</span>)}  </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a> f1<span class="ot">&lt;-</span><span class="cf">function</span>(x) </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>   {<span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">+</span><span class="dv">1</span>)}     </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a> f2<span class="ot">&lt;-</span><span class="cf">function</span>(x) </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a> {<span class="dv">4</span><span class="sc">/</span>pi<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)}          </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a> x<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="fl">0.01</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>gf1<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">g</span>(x)<span class="sc">==</span><span class="fu">frac</span>(x<span class="sc">^</span><span class="dv">2</span>,<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">frac</span>(x<span class="sc">^</span><span class="dv">2</span>,<span class="dv">2</span>))),<span class="fu">expression</span>(<span class="fu">f1</span>(x)<span class="sc">==</span><span class="fu">exp</span>(<span class="sc">-</span>(x<span class="dv">-1</span>))),<span class="fu">expression</span>(<span class="fu">f2</span>(x)<span class="sc">==</span><span class="fu">frac</span>(<span class="dv">4</span>,pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>))))</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(x,<span class="fu">g</span>(x), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">lwd =</span> <span class="fl">0.3</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">main=</span><span class="st">&#39;The plots of g and f&#39;</span>)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a> <span class="fu">lines</span>(x, <span class="fu">f1</span>(x), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="fl">0.3</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a> <span class="fu">lines</span>(x, <span class="fu">f2</span>(x), <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="fl">0.3</span>,<span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a> <span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> gf1, <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>),<span class="at">lwd =</span> <span class="fl">0.2</span>,<span class="at">cex=</span><span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
Further,plot the curves of <span class="math inline">\(\frac{g(x)}{f_1(x)},\frac{g(x)}{f_2(x)}\)</span>.<br />
</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>gf2<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f1</span>(x)),<span class="fu">expression</span>(<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f2</span>(x)))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(x,<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f1</span>(x), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">lwd =</span> <span class="fl">0.3</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">main=</span><span class="st">&#39;The plots of g/f&#39;</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">lines</span>(x, <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f2</span>(x), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="fl">0.3</span>,<span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> gf2, <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>),<span class="at">lwd =</span> <span class="fl">0.2</span>,<span class="at">cex=</span><span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAwFBMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZrYA/wA6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmOmZmZmZmkLZmkNtmtttmtv+QOgCQOjqQZgCQZjqQkGaQkLaQtpCQtv+Q29uQ2/+2ZgC2Zjq2ZpC2kGa2kJC227a229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb/9vb////tmb/tpD/25D/27b//7b//9v///8dPObyAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKXElEQVR4nO2daYPbthVF6RmPNWrcbKPYiRNNErdp5abpJGaTjqqF//9fBSsXicQFJUAgqXs+eGQJAMkj4HF5JJQVxEmWegWGDgUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASILWiVlcyKPHvxT486+8fs1fPBW//6COp8mGfZF8fvb+Y3H7s+82IcgrZvboCgtVzCQ9v7s87PvBiHoFWGBHU1nQsznott5xIxSGzwTL0Qa/qPD1l2p1Z3L169+KIUIRz88lZ89lQJ+kP8/+W7Z2NZKPrva1Hl86eq5WYJq2GvlqGkiqaWjc96c2FBGtkddgv18s72DNvVxJYYQaa0eGkE5VXtot6eLWEkiOryP69lwd3i5uO4BL16kv8+qB7zJEJoGRvEZog3fpcjUQsSn4l/y8JyY7PZsyxhq9RL1IaRCDmz5/1KmdzMVYnxDLFsqfrOg/5HvmP7w0p9plRoQSbuqD8rvbHZ3X/q7dZL1CSsbA8Vf2SMHpUguaayJ8itLYeUwmytLKIE2UCk6th4kpmQY5utSlQS7NvG7HKkgtZZuyDx/lJtoipl3jAfbt/oGj/pGo0SlQT7tu6L8t1RChI9aNkohHuQYPv+tQ7KplnUg2SMHqkg+z2X4BhkGvuhFrZQDFIhaJyCxGa8+K7YLspDQudeTFUUQ+nLZznObBW8F8vNnmCMgsxxUO17L49yjo6DVMS6+fihGbUaJWoSasdBKkaPVFCx/VHsyKrDYjEwfvtRv9E4kv5WtfBBHWP/LiPQp4dH0t9WTZvlidKfPYkGf12Uce3klR/M5Q58utW7wcNLAicxQUErdW1DBKgZLouZoCB7iHXGuKoxQUHF9u384Kz/DAYjaKhQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAIEFZaMhlaCxdEkKAlAQ4MKCakObgkBzFASaoyDQHAWB5igINEdBoDkKAs1REGju8oJOWiIFhao0fkGnLTCSoFWWzdTjWMuOArEE7f/9U/n6/+8aT/F0L9BRKZKgXD0pqZ6G65gKI5Kg7df1By82X9ef6uhcoKtSHEH7R6FlrR6iyTuexYojaPe2+eDO5pPaxuoF7t6Ybr1bLD0qxRGklr3WT293PJoTRZD6YhrUvh+zvJV5/EmIWuJKE+tB+dGTX5t5ufWZWTX9jf0xt/HRWSl6DDr+esrmwgvaLY6+DeujqATJMvvvs7v3dqS5Kk1hLyanWbh7L7/0tZ1gYabWYFlUf+z6q4cMZ8Xuq3fPa/2Js1IRTZBHc4EatHN7qKlfdHeV27cun5+e2QVKjCD90shwVCqGJegWc1RHdNMvn2VEeVBzJKn3doubXxZmlKztI82ZLW9HlBbkrlTEF5RH3ott5maEqIl0zMjIs9f25do+4dohyF2puHgPCn7R3gwUueOptrWcoKDaVru0bkEtleoVIQONQa2C9JxJ5nNfQS2V6hUhAxVUG2JlOBEB9xvbG2w46RLkrFSvCOm3PXrekKz7EfdQgmpButwhyZ2R3VObHVJWlW8KclUqGjUR/Q4U7fxq6655G2Ps5s1eWk2WpCZtU2uy1IszHAlyVCoaNRG9TzU08U811IHi3+WBojkotlPdPBTVQXG3IEelolET0ftk1azGZU5W9elT92mVY2EpzsUu2IN2Czkl5/aN2sr94+E8LnkzRLfRWUkTKwaVh1yxY5CZkEpv5NGlnU8bR4ntdFUqcNU6/bbHzKvVPXVRMEH7n0WUfvmd/d/39Y1tXirsbsJVaezHQYfsf65dXv6b5+XlkyodMhJB7mXGrDR+QYNK+3g0d9VpH5/mrjnt49Vc0rTP9m01y3mCtI9XcynTPuYETs1yniLt49VcwrTP/jETB07bx8x9flKr5sEIBHmnfXYLcwY/S5b28WguZdpHowQx7dOV9jEnigNL+zgv2t9L3H+P6pye9tGXx5KnfbqbS5322czNlMyDSvvUmkuc9snVb7sw7dMhqPxVIKZ9WtM++0d7IS9V2sejuZRpn9p+PE3ax6e5hGmf8tde7G/WXDrt49VcwrRP+Wsv6peSEqR9vJq75rSPV3NXnfYxbOZdd+BdedrHJn0cty9cedrH5Asv0YMOcGVwTqoULXEox3ECQcGJFoNWImxSkAtxTEFBTjbzlxTkpDoRbGuOgkBzFKSIfSN5dIZ0TXqQcIgBKAgQSZDPjeQjIYognxvJmxw/6NSH82o7iSLI6zbgBuduYTxDkS53eNxIXqflSbme3BYtadcQDKMHnd8BbmMZihWD8I3kNYIMEGEoRDOHRLsepHcBjhvJK8IEkPOHaSvpjoNKgm1ZFEPpBYX75m9vIwyyAQgK12gMQ8kFBR0Xt+H3ZKkFBY4b4SP1xASFN5RYUPgdT+gwlFZQjB1zYEOph1gEwgbqCQoK2zEnKSikoXQX7WNyH87QNHuQMBRK0UQFhTM0VUHBDE1WUBEoVE9ZUJBONGlBIQxNWZAydK6iSQuSnGto6oLEidl5itLl5i+EPHU9R9FQcvMRUYZOVjSMzGps7k9XNIzcfGzu709WdB09qNBp6VMcDSI3fxlMN+rpaAi5+YuhLsb2dDT146Aj7vV+39vS1QkqdDxSZyE+mtLdSJ6YcjqQztngNdO8Jt2DavoUIan5V31+jUOsFxQEmPzJ6rlcwcnqeSQ71RgNMQR5nKz2a9SzXJJipxT36EH9Gp2aII+T1X6NTk4QPlnt1+j0BAVulILClKOgIRY7sXjYRikoTLnpCZoSFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCBBDUPOHqjpQOUjnlW1NLn/2yWuxK3AhuLCXjA8nmnYSQdBu4cwJafaPYrNzvK7yNpK1l6E1ulIu2PzFz3WN8ILWjsx0hZ4PtusumpLd4qFtcvHWkh6C3Om8VoILWmcP/qvh1ze8BOWvfsCC8l6jSxEjBvkLWnmVPJ6//xgxeDxi0OqvfoGvRlJBIP9oC3mUkklfLEjPF77qZSiloLXn/qT221hdyFS4Rw/Si+0ViBIK8uo/uiQaY2rv5CvIMV94C+kE5f7BAG5Sbu5p8dryfvv6ZIJyr63RavyM4x7UpzVLKkGN35FxsFK/x+dV1mcvpn4SchRB2gwKvANf+Y4crxjk35qFJ6sACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCDA0AXJO6nVzdKpGLogefOUe7KiyAxdULG++fWr3s8PBGTwgopVv4dPQjN8Qeue98wFZvCC9o/f9H8CJSCDF5S/+p/fTa6RGLogOTXhCQ8xhWPogvR90gnD9NAFJYeCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgL8CTn77BqpC2KfAAAAAElFTkSuQmCC" /><!-- --><br />
We can believe that <span class="math inline">\(f_1(x)\)</span> would surpass <span class="math inline">\(f_2(x)\)</span> for better simulation to <span class="math inline">\(g(x)\)</span> because compared with <span class="math inline">\(\frac{g(x)}{f_2(x)}\)</span>,<span class="math inline">\(\frac{g(x)}{f_1(x)}\)</span> is more nearly to be a constant,leading to a better estimation. Use <span class="math inline">\(f_1(x)\)</span> and <span class="math inline">\(f_2(x)\)</span> to estimate and compare.<br />
</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(N,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">tan</span>(pi<span class="sc">/</span><span class="dv">4</span><span class="sc">*</span>(u<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>integral1<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f1</span>(x))</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>integral2<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">g</span>(y)<span class="sc">/</span><span class="fu">f2</span>(y))</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>Real<span class="ot">&lt;-</span><span class="fu">integrate</span>(g,<span class="dv">1</span>,<span class="cn">Inf</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;The estimate of the integral using f1 is &quot;</span>,<span class="fu">round</span>(integral1,<span class="dv">5</span>),<span class="st">&quot;and the real value is &quot;</span>,<span class="fu">round</span>(Real<span class="sc">$</span>value,<span class="dv">5</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;The estimate of the integral using f1 is  0.40079 and the real value is  0.40063&quot;</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;The estimate of the integral using f2 is &quot;</span>,<span class="fu">round</span>(integral2,<span class="dv">5</span>),<span class="st">&quot;and the real value is &quot;</span>,<span class="fu">round</span>(Real<span class="sc">$</span>value,<span class="dv">5</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;The estimate of the integral using f2 is  0.40298 and the real value is  0.40063&quot;</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;The standard variance of estimation using f1 is &quot;</span>,<span class="fu">round</span>(<span class="fu">sd</span>(<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f1</span>(x)),<span class="dv">5</span>),<span class="st">&quot;and the one using f2 is &quot;</span>,<span class="fu">round</span>(<span class="fu">sd</span>(<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f2</span>(x)),<span class="dv">5</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;The standard variance of estimation using f1 is  0.1575 and the one using f2 is  0.24224&quot;</code></pre>
<p><br />
The result shows that <span class="math inline">\(f_1\)</span> is a better choice,which corroborates our judgment.</p>
<p><br />
<br />
<strong>5.14:</strong><br />
<br />
Note that <span class="math display">\[\begin{split}
\int_{-\infty }^{+\infty }\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx&amp;=E(X^2),X\sim N(0,1) \\
&amp;=Var(X)+[E(X)]^2=1
\end{split}\]</span> Besides,the integrand function is an even function,so <span class="math inline">\(\int_{-\infty }^{+\infty }\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx=2\int_{0}^{+\infty }\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx\)</span>. Therefore,<span class="math inline">\(\int_{1}^{\infty }\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx=\frac{1}{2}-\int_{0}^{1 }\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx\)</span>.<br />
<br />
Then we can only consider the interval <span class="math inline">\([0,1]\)</span> rather than <span class="math inline">\([1,+\infty]\)</span>,which can improve the efficiency.<br />
<br />
Now introduce the choice of importance functions:<br />
<br />
First,we choose <span class="math inline">\(f_1(x)=\frac{e^{-x}}{1-e^{-1}},x\in(0,1)\)</span>,which is the truncated distribution of <span class="math inline">\(f(x)=e^{-x},x\in(0,+\infty)\)</span>.<br />
Then we set <span class="math inline">\(f_2(x)=\frac{xe^{-\frac{x^2}{2}}}{1-e^{-\frac{1}{2}}},x\in(0,1)\)</span>,which is the truncated distribution of <span class="math inline">\(f(x)=xe^{-\frac{x^2}{2}},x\in(0,+\infty)\)</span>.<br />
<br />
Note that <span class="math inline">\(\int_{-\infty }^{+\infty }\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx=E(\frac{g(X)}{f_2(X)}),X \sim Rayleigh(1)\)</span>.<br />
So <span class="math inline">\(\int_{1}^{\infty }\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx=\frac{1}{2}-\frac{1-e^{-\frac{1}{2}}}{\sqrt{2\pi}} \int_0^1xf(x)dx\)</span>,where <span class="math inline">\(f(x)=e^{-\frac{x^2}{2}}\)</span> is the pdf of <span class="math inline">\(Rayleigh(1)\)</span>.This will be used in following estimation.<br />
(Use the inverse method (<span class="math inline">\(x=\sqrt{-2ln^{1-u}}\)</span>) to generate random numbers from <span class="math inline">\(Rayleigh(1)\)</span>.)<br />
<br />
Now plot the curves of <span class="math inline">\(g(x),f_1(x),f_2(x)\)</span>.They are printed in red,blue and green,respectively.<br />
</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a> g<span class="ot">&lt;-</span><span class="cf">function</span>(x) </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>   {x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)}</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a> f3<span class="ot">&lt;-</span><span class="cf">function</span>(x) </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>   {<span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))}</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a> f4<span class="ot">&lt;-</span><span class="cf">function</span>(x) </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a> {x<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)}</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.001</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a> gf3<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">g</span>(x)<span class="sc">==</span><span class="fu">frac</span>(x<span class="sc">^</span><span class="dv">2</span>,<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">frac</span>(x<span class="sc">^</span><span class="dv">2</span>,<span class="dv">2</span>))),<span class="fu">expression</span>(<span class="fu">f1</span>(x)<span class="sc">==</span><span class="fu">frac</span>(<span class="fu">exp</span>(<span class="sc">-</span>x),(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))),<span class="fu">expression</span>(<span class="fu">f2</span>(x)<span class="sc">==</span><span class="fu">frac</span>(x<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">frac</span>(x<span class="sc">^</span><span class="dv">2</span>,<span class="dv">2</span>)),(<span class="dv">1</span><span class="sc">-</span>e<span class="sc">^</span>(<span class="sc">-</span><span class="fu">frac</span>(<span class="dv">1</span>,<span class="dv">2</span>))))))</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(x,<span class="fu">g</span>(x), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>), <span class="at">lwd =</span> <span class="fl">0.3</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">main=</span><span class="st">&#39;The plots of g and f&#39;</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a> <span class="fu">lines</span>(x, <span class="fu">f3</span>(x), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="fl">0.3</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a> <span class="fu">lines</span>(x, <span class="fu">f4</span>(x), <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="fl">0.3</span>,<span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a> <span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> gf3, <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>),<span class="at">lwd =</span> <span class="fl">0.2</span>,<span class="at">cex=</span><span class="fl">0.9</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAxlBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZmZmZrZmkLZmkNtmtrZmtttmtv+QOgCQOjqQZgCQZjqQkGaQkLaQtpCQttuQtv+Q29uQ2/+2ZgC2Zjq2Zma2ZpC2kDq2kGa227a229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb27bb/9vb////AAD/tmb/25D/27b//7b//9v///8N+VruAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJw0lEQVR4nO2da0PbNhiFDQ1LOrp1SWk3VrJe1o6wKxum7ZhD4v//pybJlm+Jc/QqDpHDeT60JPYrSw+SbNlCjlKykWjfGQgdCgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCNCloFlUMEzj6OjSIWY5jU7uGl/9dgNirkZR9Nwvh8c3wjTCE3R/dgwEJfoIY78c2rSd0whPUFmINhyTXptDm7ZzGl33QarAQ5uDX66iaGCysVQ/HT0vRKh8/vlSbbsuBX1Wn5/8cJdbVsW4PVUh316XKdf3sMVbmmNUpH4+U1ufXa7mYBQNPhT71dLYyA4FZegcLSbmx4EthK1qKoe5oHxv9WMuKC6j02p6do+8cCpcfzitN51sc1weJd+vTDAMQSfX+t+xqTHX6XxUtHmVPfXFJ90SM0Fqm/q32PlGKx3e6T1sSHWPSvNQPoZ3y1lRcJXcV3f5oWJTR7OQbL+rKKgmFl2YujPO/tHf2NzNzDajIhOUV33zn/lHFXHwVzXd6h6Vws1sDa30W1/+ONXq8xyolIZr9gtBkM6Brgk6j2Vl1+Sl1bsYQbYjMjFmY9YkTJdjky33KAtnv66cvt/as0Q1BzZXgXXSNntJtF6Q+v7CFNHslX+Rb7w/yyI+ZhG1PcrC2a9nlSYWDd5/mTQErewXliBVgy5qO+EapLh/d5p1ynmyTjUo630WTUGrNS0oQfb3V4D7oDyxN5Vuy6kPSmy/M67lIPA+SGXv6HV6PykuCTeexUygKuh3d7qd2RDHs5jZ7X7a7INW9gtMUH4dVPm9FxclK9dBpsc6vrmq91q1PSqFa14HFdc7DUHVQ1ay58CDCErv36oTWXlZrCr8P2+zL2pX0ucmhStz/fJJ90DPmlfS52XS+fHU3t9c189igw9x2RLzHCx/H0VPXgfQBzmBh1viBJu3BDqj54Jm5p5FdjG4G3ouyF5i+Q7vMT0XlN6/HDVG/R3DW64ACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEKBjQVFv2JegbpMLAAoCUBCgmxLJm3ZvYA0CUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAFmJ7OIqresCPHJBsV2ULmlbxPJxC1pOCy1xy2orj1vQYlIsRZa0NLLHLYg1CBHb1ezYB7WQL0bWvt7TYxf00MkFAAUBPEsU7/kspq9YfdZ1k8f1dApeopevvMD7bR/X4yYWewiSx/VXUOK5MqAwrreCZp5+pHE9FbSc+rUveZxsLFZ2xns7i8V6+emhWbtW9GoN3zhRiZZTtEDk7gWpEfP8G48TvG+c9IYZaMEP0MSSoc/53TtOWKIk2nyQBxAEf0ndxvWvk15M/BaC9Yzrn6B4HHu9+MgzrneC5l/fLF54LI7sG9c7QfpCz+ci0Teud4IeGgoCBCbo84f6/92k5vr9OsIS9GvRiybn22almloTQepBCaqeh/3O5W2pSbbV2aWg/9pZG6zOxJUPT7d80UEttZWNT12TCaEGLSbR0Tv92iPzXhoz6haNDPIbzVnk4sXPI3OvYbbp3vNy6pp4AIIWk3E6Hx3fLCbDtDLqnrmODMwD31i/pUxHmhFFbFNrZeaauwAEJabiHN/MR6ZjsKPuuPkykdZlOLRJfSfMRJoJBNrVaNwerVLfZYk6Ti7Wv+qkEGTbViYof6vTptqQvzdqnEWa8YSqVE1BzSDX3IUnyI66V2pQa7ztbExkXVCr3z4JajQxO+p2rkHFVBwT2dbEGvRJkO5k9S8/61aLUXdbJ73SBS2nynBydJlFmmo00132wXTS2Wk+O0+Xo+7W0/zqIfRpXr890kQuJq/y99gdzGneoNtZ7dqw9eYNOEQxDW7jlebihWvGAhCUmFc+m3f5Ogw10BHKeYLhDzVciYtnVbfFI4H5955HqEykvL1obrLP81pTlx9PyO5vd+gjlCV1Sy1DX7Fn83b6e7vD7QhlSUWYywHxfem+CdIH8CtphvgmQR8FGVRJr9Al5Cryp4d9mmGmU7cHUCWdn8/PhbfVPJ6u9qgGRWkpKCvp/KNsthgYfrQctVN23MSi/AD2zsiFSFDi8zbWngnK0rclvb2UCPK7idsvQVn6tqTLny7jH987x+b3jYRzYPooyJZUjd/mTz2nusqOGGxyAUBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAQ5Y0MrzU6/Z6YcraM00cp/Z6dI/yezNGmZrn5h5zE4XlahHa5itn0bu8WBDUqIwV6BymUbuMTvdIilRkGuYOU0jl89OL+h9DUqcppG3zk6HCPug8NYwc5tGXp+dLkFWogDXMHObRi6enV7Q++sgt2nk9dnpEnovyGkaOZyd3o5nifa9hlkFl2nkcHZ6O32aYeYAmEbuMbExwCa2zV8+g2nkux5qPEhyW/3l84Zp5Klo/nhBCIPVxEy0z1fP6u4vn/dwu2NHg1WzpIZyrwV1+5fPHRDAUGOma2QcDc60IN+/fN4ZHQ9W3RIF27fbvG34Frs71CC3RA9VkMNg1S3RgxWEB6tuiR6uoI4SpaDttlMQBW23nYIevaBDgoIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQG6FJSYWQTrPsjDU7BaLQiP5UsstNChIL2iRrF+SO2DPFx/lr1KrhaupwGhd6Q40p2g7KFQ/uKB2gd5eGqeD0gENY4+FB69ne4EzUf6N5ZPHKp9kIfrn07eSATVwgMVZB6k549cax/k4eajqA+qhwfZxLIOIO8Gah/k4abFiAQ1Dig/RbQRqCD9aHsLQXoqos96XGsIs4mZD/5NTN4DthNmJ53PDhf0IrVwef1tJ9jTvLAG1cIzW5L62064F4rCK+laeJB9kGkYR5f2KiQWn0dq4al4qFELn0lfhtkKB6sACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCBA6IL0nDHz6uJ9EbogPXNs82JFOyZ0QWly/LffW507InhB6Uz4OueOCV9QRzPmfQle0HL6qpPZqr4ELyg++Xe6x5NY8IL00oTdTHj2JHRBei7wXtebDF3Q3qEgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggD/A7hkEuv/nK7NAAAAAElFTkSuQmCC" /><!-- --><br />
Clearly,We can see <span class="math inline">\(f_2(x)\)</span> and <span class="math inline">\(g(x)\)</span> share the same increasing trend,while <span class="math inline">\(f_1(x)\)</span> is on the contrary.Further,plot the curves of <span class="math inline">\(\frac{g(x)}{f_1(x)},\frac{g(x)}{f_2(x)}\)</span>.<br />
</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>gf4<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f1</span>(x)),<span class="fu">expression</span>(<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f2</span>(x)))</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(x,<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f3</span>(x), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>), <span class="at">lwd =</span> <span class="fl">0.3</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">main=</span><span class="st">&#39;The plots of g/f&#39;</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">lines</span>(x, <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f4</span>(x), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="fl">0.3</span>,<span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> gf4, <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>),<span class="at">lwd =</span> <span class="fl">0.2</span>,<span class="at">cex=</span><span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
We can believe that <span class="math inline">\(f_2(x)\)</span> would surpass <span class="math inline">\(f_1(x)\)</span> for better simulation to <span class="math inline">\(g(x)\)</span> because compared with <span class="math inline">\(\frac{g(x)}{f_1(x)}\)</span>,<span class="math inline">\(\frac{g(x)}{f_2(x)}\)</span> is more nearly to be a constant,leading to a better estimation. Use <span class="math inline">\(f_1(x)\)</span> and <span class="math inline">\(f_2(x)\)</span> to estimate and compare.<br />
<br />
</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(N,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>integral3<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">-</span><span class="fu">mean</span>(<span class="fu">g</span>(z)<span class="sc">/</span><span class="fu">f3</span>(z))</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))         <span class="co">#Generate Rayleigh random numbers </span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span>x[x<span class="sc">&lt;=</span><span class="dv">1</span>]                   <span class="co">#Select the random numbers locating on [0,1]</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>integral4<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">mean</span>(y)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;The estimate of the integral using f1 is &quot;</span>,<span class="fu">round</span>(integral3,<span class="dv">5</span>),<span class="st">&quot;which is close to the real value&quot;</span>,<span class="fu">round</span>(Real<span class="sc">$</span>value,<span class="dv">5</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;The estimate of the integral using f1 is  0.39888 which is close to the real value 0.40063&quot;</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;The estimate of the integral using f2 is &quot;</span>,<span class="fu">round</span>(integral4,<span class="dv">5</span>),<span class="st">&quot;which is close to the real value&quot;</span>,<span class="fu">round</span>(Real<span class="sc">$</span>value,<span class="dv">5</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;The estimate of the integral using f2 is  0.40071 which is close to the real value 0.40063&quot;</code></pre>
<p>So we can use <span class="math inline">\(f_2\)</span> for estimation. And the estimate value of integral is 0.40071 while the real value is about 0.40063.</p>
<p><br />
<br />
</p>
</div>
<div id="title-20211014" class="section level2">
<h2>title: “2021—10—14”</h2>
</div>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p><br />
<strong>6.5</strong><br />
Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
<p><br />
<strong>6.A</strong><br />
Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) <span class="math inline">\(\chi^2(1)\)</span>, (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test <span class="math display">\[H_0 : \mu=\mu_0 \quad vs \quad H_1 : \mu \neq\mu_0,\]</span>where <span class="math inline">\(µ_0\)</span> is the mean of <span class="math inline">\(\chi^2(1)\)</span>, Uniform(0,2), and Exponential(1), respectively.</p>
<p><br />
<strong>Discussion</strong><br />
If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level. What is the corresponding hypothesis test problem? What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why? Please provide the least necessary information for hypothesis testing.</p>
<p><br />
</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<p><br />
</p>
<p><strong>6.5:</strong><br />
<br />
If <span class="math inline">\(X \sim N(\mu,\sigma^2),n\geq 2\)</span>,then <span class="math inline">\(\frac{X-\mu}{\sigma} \sim N(0,1)\)</span>,<span class="math inline">\(\frac{(n-1)S^2}{\sigma^2}\sim \chi ^2(n-1)\)</span>,<span class="math inline">\(\frac{X-\mu}{S} \sim t(n-1)\)</span>.</p>
<p>Use non-normal random samples (in this example,<span class="math inline">\(X\sim \chi ^2(2)\)</span>),to see how the estimation result will change.<br />
Note that a 95% symmetric t-interval is constructed.<br />
</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#t-interval</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fl">1e3</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>Lower<span class="ot">&lt;-</span>Upper<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n, <span class="dv">2</span>) </span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    Lower[i]<span class="ot">=</span><span class="fu">mean</span>(x)<span class="sc">-</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>,<span class="at">lower.tail =</span> <span class="cn">FALSE</span>)<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n) </span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">#lower.tail = FALSE calculates the upper quantile  </span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    Upper[i]<span class="ot">=</span><span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>,<span class="at">lower.tail =</span> <span class="cn">FALSE</span>)<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;The estimation of the coverage probability of the t-interval is&quot;</span>,<span class="fu">mean</span>(Lower<span class="sc">&lt;</span><span class="dv">2</span> <span class="sc">&amp;</span> Upper<span class="sc">&gt;</span><span class="dv">2</span>),<span class="st">&quot;while the nominal level is &quot;</span>,<span class="dv">1</span><span class="sc">-</span>alpha))  </span></code></pre></div>
<pre><code>## [1] &quot;The estimation of the coverage probability of the t-interval is 0.915 while the nominal level is  0.95&quot;</code></pre>
<p>The estimation of the coverage probability is visibly smaller than the nominal level.<br />
Compared with the result of example 6.4, which shows that <strong>if the sampled population is normal with variance <span class="math inline">\(σ^2\)</span>, then the probability that the confidence interval contains <span class="math inline">\(σ^2\)</span> is <span class="math inline">\(1−\alpha\)</span></strong>,the reason why the estimation of CP is liberal should be that the samples are non-normal.<br />
</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#variance interval</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>Upper2<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="dv">2</span>) </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    Upper2[i] <span class="ot">&lt;-</span> (n<span class="dv">-1</span>) <span class="sc">*</span> <span class="fu">var</span>(x) <span class="sc">/</span> <span class="fu">qchisq</span>(alpha, <span class="at">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;The estimation of the coverage probability of variance interval is&quot;</span>,<span class="fu">mean</span>(Upper2<span class="sc">&gt;</span><span class="dv">4</span>),<span class="st">&quot;while the nominal level is &quot;</span>,<span class="dv">1</span><span class="sc">-</span>alpha))  </span></code></pre></div>
<pre><code>## [1] &quot;The estimation of the coverage probability of variance interval is 0.785 while the nominal level is  0.95&quot;</code></pre>
<p>What’s more,the coverage probability for t-interval is approximately 92% ,which is greater than the interval for variance (78.5%).<br />
Therefore,we can draw the conclusion that t-interval is more robust to departures from normality than the interval for variance.<br />
<br />
<strong>6.A:</strong><br />
<br />
As the means of three distributions(<span class="math inline">\(\chi^2(1),U[0,1],Exp(1)\)</span>) are all 1,so the hypothesis test is:  <span class="math display">\[H_0:\mu=1 \quad vs \quad H_1:\mu\neq 1\]</span><br />
Different sample sizes(20,50,250,500) are considered in simulations.<br />
</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>num<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">50</span>,<span class="dv">250</span>,<span class="dv">500</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span>  </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>M<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="fu">length</span>(num),<span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sample size&quot;</span>,<span class="st">&quot;chi square(1)&quot;</span>,<span class="st">&quot;U[0,2]&quot;</span>,<span class="st">&quot;Exp(1)&quot;</span>)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> num){</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  quant<span class="ot">&lt;-</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a> X<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,<span class="dv">1</span>)</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a> T<span class="ot">&lt;-</span><span class="fu">abs</span>(<span class="fu">sqrt</span>(n)<span class="sc">*</span>(<span class="fu">mean</span>(X)<span class="sc">-</span>mu)<span class="sc">/</span><span class="fu">sd</span>(X))</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a> M[i]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(T<span class="sc">&gt;</span>quant)</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>results[<span class="fu">which</span>(num <span class="sc">==</span> n),<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(M)</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a> X<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>T<span class="ot">&lt;-</span><span class="fu">abs</span>(<span class="fu">sqrt</span>(n)<span class="sc">*</span>(<span class="fu">mean</span>(X)<span class="sc">-</span>mu)<span class="sc">/</span><span class="fu">sd</span>(X))</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a> M[i]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(T<span class="sc">&gt;</span>quant)</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>results[<span class="fu">which</span>(num <span class="sc">==</span> n),<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(M)</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a> X<span class="ot">&lt;-</span><span class="fu">rexp</span>(n,<span class="dv">1</span>)</span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a> T<span class="ot">&lt;-</span><span class="fu">abs</span>(<span class="fu">sqrt</span>(n)<span class="sc">*</span>(<span class="fu">mean</span>(X)<span class="sc">-</span>mu)<span class="sc">/</span><span class="fu">sd</span>(X))</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a> M[i]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(T<span class="sc">&gt;</span>quant)</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>results[<span class="fu">which</span>(num <span class="sc">==</span> n),<span class="dv">4</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(M)</span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(num)){</span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>  results[p,<span class="dv">1</span>]<span class="ot">&lt;-</span>num[p]</span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(results,<span class="at">align=</span><span class="fu">rep</span>(<span class="st">&#39;c&#39;</span>, <span class="dv">5</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">sample size</th>
<th align="center">chi square(1)</th>
<th align="center">U[0,2]</th>
<th align="center">Exp(1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">20</td>
<td align="center">0.1063</td>
<td align="center">0.0467</td>
<td align="center">0.0847</td>
</tr>
<tr class="even">
<td align="center">50</td>
<td align="center">0.0783</td>
<td align="center">0.0511</td>
<td align="center">0.0655</td>
</tr>
<tr class="odd">
<td align="center">250</td>
<td align="center">0.0563</td>
<td align="center">0.0513</td>
<td align="center">0.0538</td>
</tr>
<tr class="even">
<td align="center">500</td>
<td align="center">0.0523</td>
<td align="center">0.0513</td>
<td align="center">0.0541</td>
</tr>
</tbody>
</table>
<p><br />
We can see that the empirical Type I error rates of the t-test are approximately equal to the nominal significance level 0.05,when the sampled population is non-normal.And as sample size increases,the estimation tends to be more accurate.So t-test is robust to mild departures from normality.</p>
<p><br />
<br />
<strong>Discussion:</strong><br />
<br />
(1)The hypothesis test problem (to test if the powers are different) is:  <span class="math display">\[H_0:p_1=p_2 \quad vs \quad p_1\neq p_2\]</span><br />
(2) We can generate two binomial distributions <span class="math inline">\(b(n,p_1)\)</span> and <span class="math inline">\(b(n,p_2)\)</span>,then use the mean value of <span class="math inline">\(b(n,p_i)\)</span> to estimate <span class="math inline">\(p_i,i=1,2\)</span>. For each simulation, the outcome is a binomial experiment.<br />
Considering the powers obtained by two methods must be strongly correlated,(i.e. the two binomial samples are not independent),the two-sample t-test which requires independence should be discarded,and we can use the paired-t test.<br />
<br />
For paired-t test,under <span class="math inline">\(H_0\)</span>,<span class="math inline">\(T=\frac{\sqrt{n}(\bar{d}-\mu_d)}{S_d}\)</span>,where <span class="math inline">\(\bar{d}=\bar{x}-\bar{y},\mu_d=\mu_1-\mu_2\)</span>.<br />
(3)The feasibility of paired-t test may be demonstrated as follows:<br />
Note that this is a two-side test.<br />
</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fl">0.651</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span><span class="fl">0.676</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>quant<span class="ot">&lt;-</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>M<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rbinom</span>(n,<span class="dv">1</span>,p1)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">rbinom</span>(n,<span class="dv">1</span>,p2)</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  T<span class="ot">&lt;-</span>(<span class="fu">mean</span>(x<span class="sc">-</span>y))<span class="sc">/</span><span class="fu">sqrt</span>((<span class="fu">var</span>(x<span class="sc">-</span>y))<span class="sc">/</span>n)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  M[i]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(T<span class="sc">&gt;</span>quant)</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;the p-value is&quot;</span>,<span class="dv">2</span><span class="sc">*</span><span class="fu">mean</span>(M),<span class="st">&quot;while the significance level is&quot;</span>,alpha))</span></code></pre></div>
<pre><code>## [1] &quot;the p-value is 0.021 while the significance level is 0.05&quot;</code></pre>
<p>So at significance level <span class="math inline">\(0.05\)</span>,we can refuse the null hypothesis,which means that the powers are not the same at 0.05 level.</p>
<p><br />
<br />
## title: “2021—10—21”</p>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p><br />
<strong>6.C</strong><br />
<br />
Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test.Mardia proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis.If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are <span class="math inline">\(i.i.d.\)</span>,the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as<span class="math display">\[\beta_{1,d}=E[(X-\mu)^T\Sigma^{-1}(Y-\mu)]^3\]</span>.<br />
Under normality,<span class="math inline">\(\beta_{1,d}=0\)</span>.The multivariate skewness statistic is <span class="math display">\[b_{1,d}=\frac{1}{n^2}\sum_{i,j=1}^{n}((X_i-\bar{X})^T\hat{\Sigma}^{-1}(X_j-\bar{X}))^3,\]</span><br />
where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant.The asymptotic distribution of <span class="math inline">\(\frac{nb_{1,d}}{6}\)</span> is chisquared with <span class="math inline">\(\frac{d(d+1)(d+2)}{6}\)</span> degrees of freedom.</p>
<p><br />
</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p><br />
</p>
<p><strong>6.C</strong><br />
<br />
<strong>Skewness test of normality</strong><br />
<br />
Different sample sizes are considered in simulation(n=10,50,500).</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="dv">3</span>                       <span class="co">#dimension </span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>num<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">50</span>,<span class="dv">500</span>)          <span class="co">#sample size</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">500</span>                    <span class="co">#simulation times</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span>                <span class="co">#significance level</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">rep</span>(<span class="dv">1</span>,d))        <span class="co">#required in function mvnorm() as Sigma </span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>skk<span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>criticalvalue<span class="ot">&lt;-</span><span class="fu">qchisq</span>(<span class="dv">1</span><span class="sc">-</span>alpha,d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="co">#function to get b1d.</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>skew<span class="ot">&lt;-</span><span class="cf">function</span>(X) {</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>Xbar<span class="ot">&lt;-</span><span class="fu">colMeans</span>(X)</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>Sigma<span class="ot">&lt;-</span><span class="fu">cov</span>(X)</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>    b[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(((X[i,]<span class="sc">-</span>Xbar)<span class="sc">%*%</span><span class="fu">ginv</span>(Sigma)<span class="sc">%*%</span><span class="fu">t</span>((X<span class="sc">-</span>Xbar)))<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">mean</span>(b)<span class="sc">*</span>n<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a><span class="co">#The first loop is to produce results for different sample size,and the second is used for m simulations.</span></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> num){</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>  X<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(n,<span class="at">mu=</span><span class="fu">rep</span>(<span class="dv">0</span>, d),<span class="at">Sigma =</span> R)</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Or generate X,Y in this way:</span></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#X&lt;-matrix(rnorm(n*d),nrow=n,ncol=d)</span></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>  skk[k] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">skew</span>(X)<span class="sc">&gt;=</span>criticalvalue)</span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">mean</span>(skk)</span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;The critical probability for n=&quot;</span>,n,<span class="st">&quot;is&quot;</span>,p))</span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;The critical probability for n= 10 is 0.01&quot;
## [1] &quot;The critical probability for n= 50 is 0.044&quot;
## [1] &quot;The critical probability for n= 500 is 0.05&quot;</code></pre>
<p>We can see that as n increases, the sample proportion of significant tests tends to be 0.05,which is the significance level.</p>
<p><br />
<br />
<strong>Power of the skewness test of normality</strong><br />
<br />
Now consider the power.<br />
</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span>    <span class="co">#significance level</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">30</span>          <span class="co">#sample size  </span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">300</span>         <span class="co">#simulation times</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="dv">3</span>           <span class="co">#dimension </span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>criticalvalue2<span class="ot">&lt;-</span><span class="fu">qchisq</span>(<span class="dv">1</span><span class="sc">-</span>alpha,d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>eps<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.15</span>,<span class="fl">0.01</span>), <span class="fu">seq</span>(<span class="fl">0.15</span>,<span class="dv">1</span>,<span class="fl">0.05</span>))</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fu">length</span>(eps)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>power<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)    </span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>skk<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="co">#function to get b1d.</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>skew<span class="ot">&lt;-</span><span class="cf">function</span>(X) {</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>Xbar<span class="ot">&lt;-</span><span class="fu">colMeans</span>(X)</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>Sigma<span class="ot">&lt;-</span><span class="fu">cov</span>(X)</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>    b[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(((X[i,]<span class="sc">-</span>Xbar)<span class="sc">%*%</span><span class="fu">ginv</span>(Sigma)<span class="sc">%*%</span><span class="fu">t</span>((X<span class="sc">-</span>Xbar)))<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">mean</span>(b)<span class="sc">*</span>n<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a><span class="co">#for each epsilon,produce the contaminated probability.</span></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) { </span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> eps[j]</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a><span class="co">#The loop is produced for m simulations.</span></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) { </span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a> sigma<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">size =</span> n<span class="sc">*</span>d, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>e, e))</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a> X<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rnorm</span>(n<span class="sc">*</span>d,<span class="dv">0</span>,sigma),<span class="at">nrow=</span>n,<span class="at">ncol=</span>d)</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a> skk[i]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(<span class="fu">skew</span>(X)<span class="sc">&gt;=</span>criticalvalue2)</span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a> power[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(skk)</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a><span class="co">#plot power vs epsilon</span></span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(eps, power, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a><span class="at">xlab =</span> <span class="fu">bquote</span>(epsilon), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>alpha,<span class="at">lty =</span><span class="dv">3</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a>se<span class="ot">&lt;-</span><span class="fu">sqrt</span>(power<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>power)<span class="sc">/</span>m)     </span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(eps,power<span class="sc">+</span>se,<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(eps,power<span class="sc">-</span>se,<span class="at">lty=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The power curve crosses the horizontal line corresponding to <span class="math inline">\(\alpha=0.05\)</span> at both endpoints:<span class="math inline">\(\epsilon =0\)</span> and <span class="math inline">\(\epsilon =1\)</span>.<br />
Besides,for <span class="math inline">\(0&lt;\epsilon&lt;1\)</span>,the empirical power of the test is greater than <span class="math inline">\(\alpha=0.05\)</span> and reaches its peak when <span class="math inline">\(\epsilon\)</span> falls in [0.1,0.15].<br />
<br />
— title: “Homework to StatComp21040” author: “Jiaqi Zhang” date: “2021-12-19” output: rmarkdown::html_vignette vignette: &gt; % % % —</p>
</div>
<div id="title-20211028" class="section level2">
<h2>title: “2021—10—28”</h2>
</div>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p><br />
<strong>7.7</strong><br />
Refer to Exercise 7.6. Efron and Tibshirani discuss the following example The five-dimensional scores data have a <span class="math inline">\(5 × 5\)</span> covariance matrix <span class="math inline">\(\Sigma\)</span>, with positive eigenvalues <span class="math inline">\(\lambda_1 &gt; ··· &gt; \lambda_5\)</span>. In principal components analysis, <span class="math display">\[\theta =\frac{\lambda _1}{\sum_{j=1}^{5}\lambda _j}\]</span> measures the proportion of variance explained by the first principal component. Let <span class="math inline">\(\hat{\lambda_1} &gt; ··· &gt; \hat{\lambda_5}\)</span> be the eigenvalues of <span class="math inline">\(\hat{\Sigma}\)</span>, where <span class="math inline">\(\hat{\Sigma}\)</span>is the MLE of <span class="math inline">\(\Sigma\)</span>. Compute the sample estimate <span class="math display">\[\hat{\theta} =\frac{\hat{\lambda _1}}{\sum_{j=1}^{5}\hat{\lambda _j}}\]</span> Bootstrap and Jackknife 213 of<span class="math inline">\(\theta\)</span>. Use bootstrap to estimate the bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<p><br />
<strong>7.8</strong><br />
Refer to Exercise 7.7.Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<p><br />
<strong>7.9</strong><br />
Refer to Exercise 7.7.Compute 95% percentile and BCa confidence intervals for <span class="math inline">\(\hat{\theta}\)</span>.</p>
<p><br />
</p>
<p><strong>7.B</strong><br />
Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(\chi ^{2}(5)\)</span> distributions (positive skewness).<br />
<br />
</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p><br />
</p>
<p><strong>7.7:</strong><br />
<br />
Use Bootstrap method to estimate bias and standard error:<br />
</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)     <span class="co">#obtain scor data</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)          <span class="co">#use function boot()</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>lambdaesti<span class="ot">&lt;-</span><span class="fu">eigen</span>(<span class="fu">cov</span>(scor))<span class="sc">$</span>values</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>thetaesti<span class="ot">&lt;-</span>lambdaesti[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambdaesti)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">400</span>                <span class="co">#number of bootstrap samples</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>SCOR<span class="ot">&lt;-</span><span class="fu">cbind</span>(scor<span class="sc">$</span>mec,scor<span class="sc">$</span>vec,scor<span class="sc">$</span>alg,scor<span class="sc">$</span>ana,scor<span class="sc">$</span>sta)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Bootstrap</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>bs<span class="ot">&lt;-</span><span class="cf">function</span>(data,index){</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span>data[index,]</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>lambda<span class="ot">&lt;-</span><span class="fu">eigen</span>(<span class="fu">cov</span>(x))<span class="sc">$</span>values</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">&lt;-</span>lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(theta)</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>bsr<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="at">data=</span>SCOR,<span class="at">statistic=</span>bs,<span class="at">R=</span>N)</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>thetabs<span class="ot">&lt;-</span>bsr<span class="sc">$</span>t</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>biasbs<span class="ot">&lt;-</span><span class="fu">mean</span>(thetabs)<span class="sc">-</span>thetaesti</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>sebs<span class="ot">&lt;-</span><span class="fu">sd</span>(thetabs)</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(results)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Bootstrap&quot;</span>)</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;bias&quot;</span>,<span class="st">&quot;standard error&quot;</span>)</span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>results[<span class="dv">1</span>,<span class="dv">1</span>]<span class="ot">&lt;-</span>biasbs</span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>results[<span class="dv">1</span>,<span class="dv">2</span>]<span class="ot">&lt;-</span>sebs</span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(results,<span class="at">align=</span><span class="fu">rep</span>(<span class="st">&#39;c&#39;</span>, <span class="dv">5</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">bias</th>
<th align="center">standard error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Bootstrap</td>
<td align="center">0.0046118</td>
<td align="center">0.0465705</td>
</tr>
</tbody>
</table>
<p><br />
<br />
<strong>7.8:</strong><br />
<br />
Use Jackknife method to estimate bias and standard error:<br />
</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Jackknife</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">nrow</span>(scor)           <span class="co">#sample size</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>thetajk<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span>scor[<span class="sc">-</span>i,]</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>lambda<span class="ot">&lt;-</span><span class="fu">eigen</span>(<span class="fu">cov</span>(x))<span class="sc">$</span>values</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>thetajk[i]<span class="ot">&lt;-</span>lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>biasjk<span class="ot">&lt;-</span>(n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(thetajk)<span class="sc">-</span>thetaesti)</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>sejk<span class="ot">&lt;-</span>(n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="fu">var</span>(thetajk)<span class="sc">/</span>n)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>results2<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(results2)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Jackknife&quot;</span>)</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results2)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;bias&quot;</span>,<span class="st">&quot;standard error&quot;</span>)</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>results2[<span class="dv">1</span>,<span class="dv">1</span>]<span class="ot">&lt;-</span>biasjk</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>results2[<span class="dv">1</span>,<span class="dv">2</span>]<span class="ot">&lt;-</span>sejk</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(results2,<span class="at">align=</span><span class="fu">rep</span>(<span class="st">&#39;c&#39;</span>,<span class="dv">5</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">bias</th>
<th align="center">standard error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Jackknife</td>
<td align="center">0.0010691</td>
<td align="center">0.0495523</td>
</tr>
</tbody>
</table>
<p><br />
<br />
<strong>7.9:</strong><br />
<br />
Compute the 95% percentile and BCa confidence intervals:<br />
</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>bs<span class="ot">&lt;-</span><span class="cf">function</span>(data,index){</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span>data[index,]</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>lambda<span class="ot">&lt;-</span><span class="fu">eigen</span>(<span class="fu">cov</span>(x))<span class="sc">$</span>values</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">&lt;-</span>lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(theta)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>bsr<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="at">data=</span>SCOR,<span class="at">statistic=</span>bs,<span class="at">R=</span><span class="dv">1000</span>)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>bsCI<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(bsr,<span class="at">conf=</span><span class="fl">0.95</span>,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bsCI)</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = bsr, conf = 0.95, type = c(&quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level     Percentile            BCa          
## 95%   ( 0.5264,  0.7087 )   ( 0.5209,  0.7018 )  
## Calculations and Intervals on Original Scale</code></pre>
<p><br />
<br />
<strong>7.B:</strong><br />
<br />
For normal distribution,the skewness equals to 0.<br />
For <span class="math inline">\(X \sim \chi ^{2}(5)\)</span>,<span class="math inline">\(E(X)=5,Var(X)=10\)</span>,as <span class="math display">\[{E}(X^{m}) = \frac{2^{m} \Gamma\left( \frac{k}{2}+m \right)}{\Gamma\left( \frac{k}{2} \right)}.\]</span> Therefore,<span class="math inline">\({E}(X^{3}) = \frac{2^{3} \Gamma\left( \frac{5}{2}+3 \right)}{\Gamma\left( \frac{5}{2} \right)}=315.\)</span><br />
So <span class="math inline">\(\mu_3=E[(X-EX)^3]=E(X^{3})-3E(X^{2})E(X)+2({E(X)})^3=40,S_k=\frac{\mu_3}{\sigma ^3}=\frac{40}{10^{\frac{3}{2}}}=\frac{4}{\sqrt {10}}\)</span>.<br />
</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>sk<span class="ot">&lt;-</span><span class="cf">function</span>(data,index){</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span>data[index]</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>xbar<span class="ot">&lt;-</span><span class="fu">mean</span>(x)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>e3<span class="ot">&lt;-</span><span class="fu">mean</span>((x<span class="sc">-</span>xbar)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>e2<span class="ot">&lt;-</span><span class="fu">mean</span>((x<span class="sc">-</span>xbar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(e3<span class="sc">/</span>(e2<span class="sc">^</span><span class="fl">1.5</span>))</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">50</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>s1<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>s2<span class="ot">&lt;-</span><span class="dv">4</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">10</span>)     <span class="co">#THe skewness of χ2(5) distributions</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="dv">500</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>normCI1<span class="ot">&lt;-</span>basicCI1<span class="ot">&lt;-</span>percentCI1<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,B,<span class="dv">2</span>)</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>normCI2<span class="ot">&lt;-</span>basicCI2<span class="ot">&lt;-</span>percentCI2<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,B,<span class="dv">2</span>)</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>  X<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n)</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>  Y<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,<span class="dv">5</span>)</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>  boot.obj1<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="at">data=</span>X,<span class="at">statistic=</span>sk,<span class="at">R=</span><span class="dv">500</span>)</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>  boot.obj2<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="at">data=</span>Y,<span class="at">statistic=</span>sk,<span class="at">R=</span><span class="dv">500</span>)</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>  CI1<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(boot.obj1,<span class="at">conf=</span><span class="fl">0.95</span>,<span class="at">type =</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>  CI2<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(boot.obj2,<span class="at">conf=</span><span class="fl">0.95</span>,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>normCI1[i,]<span class="ot">&lt;-</span>CI1<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>basicCI1[i,]<span class="ot">&lt;-</span>CI1<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>percentCI1[i,]<span class="ot">&lt;-</span>CI1<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>normCI2[i,]<span class="ot">&lt;-</span>CI2<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>basicCI2[i,]<span class="ot">&lt;-</span>CI2<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>percentCI2[i,]<span class="ot">&lt;-</span>CI2<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><br />
</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>results3<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(results3)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;normal&quot;</span>,<span class="st">&quot;chi-suqared(5)&quot;</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results3)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;standard normal &quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;percentile&quot;</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>results3[<span class="dv">1</span>,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(normCI1[,<span class="dv">1</span>]<span class="sc">&lt;=</span>s1 <span class="sc">&amp;</span> normCI1[,<span class="dv">2</span>]<span class="sc">&gt;=</span>s1)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>results3[<span class="dv">1</span>,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(basicCI1[,<span class="dv">1</span>]<span class="sc">&lt;=</span>s1 <span class="sc">&amp;</span> basicCI1[,<span class="dv">2</span>]<span class="sc">&gt;=</span>s1)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>results3[<span class="dv">1</span>,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(percentCI1[,<span class="dv">1</span>]<span class="sc">&lt;=</span>s1 <span class="sc">&amp;</span> percentCI1[,<span class="dv">2</span>]<span class="sc">&gt;=</span>s1)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>results3[<span class="dv">2</span>,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(normCI2[,<span class="dv">1</span>]<span class="sc">&lt;=</span>s2 <span class="sc">&amp;</span> normCI2[,<span class="dv">2</span>]<span class="sc">&gt;=</span>s2)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>results3[<span class="dv">2</span>,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(basicCI2[,<span class="dv">1</span>]<span class="sc">&lt;=</span>s2 <span class="sc">&amp;</span> basicCI2[,<span class="dv">2</span>]<span class="sc">&gt;=</span>s2)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>results3[<span class="dv">2</span>,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(percentCI2[,<span class="dv">1</span>]<span class="sc">&lt;=</span>s2 <span class="sc">&amp;</span> percentCI2[,<span class="dv">2</span>]<span class="sc">&gt;=</span>s2)</span></code></pre></div>
<p><br />
The coverage rates for normal populations and <span class="math inline">\(\chi ^{2}(5)\)</span> distribution:<br />
</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(results3,<span class="at">align=</span><span class="fu">rep</span>(<span class="st">&#39;c&#39;</span>,<span class="dv">5</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">standard normal</th>
<th align="center">basic</th>
<th align="center">percentile</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">normal</td>
<td align="center">0.898</td>
<td align="center">0.890</td>
<td align="center">0.936</td>
</tr>
<tr class="even">
<td align="left">chi-suqared(5)</td>
<td align="center">0.768</td>
<td align="center">0.742</td>
<td align="center">0.744</td>
</tr>
</tbody>
</table>
<p><br />
</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>results4<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(results4)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;normal&quot;</span>,<span class="st">&quot;chi-suqared(5)&quot;</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results4)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;standard normal&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;percentile&quot;</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>results4[<span class="dv">1</span>,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(normCI1[,<span class="dv">1</span>]<span class="sc">&gt;</span>s1)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>results4[<span class="dv">1</span>,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(basicCI1[,<span class="dv">1</span>]<span class="sc">&gt;</span>s1)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>results4[<span class="dv">1</span>,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(percentCI1[,<span class="dv">1</span>]<span class="sc">&gt;</span>s1)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>results4[<span class="dv">2</span>,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(normCI2[,<span class="dv">1</span>]<span class="sc">&gt;</span>s2)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>results4[<span class="dv">2</span>,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(basicCI2[,<span class="dv">1</span>]<span class="sc">&gt;</span>s2)</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>results4[<span class="dv">2</span>,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(percentCI2[,<span class="dv">1</span>]<span class="sc">&gt;</span>s2)</span></code></pre></div>
<p><br />
the proportion of times that the confidence intervals miss on the left：<br />
</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(results4,<span class="at">align=</span><span class="fu">rep</span>(<span class="st">&#39;c&#39;</span>,<span class="dv">5</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">standard normal</th>
<th align="center">basic</th>
<th align="center">percentile</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">normal</td>
<td align="center">0.046</td>
<td align="center">0.05</td>
<td align="center">0.026</td>
</tr>
<tr class="even">
<td align="left">chi-suqared(5)</td>
<td align="center">0.016</td>
<td align="center">0.04</td>
<td align="center">0.000</td>
</tr>
</tbody>
</table>
<p><br />
</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>results5<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(results5)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;normal&quot;</span>,<span class="st">&quot;chi-suqared(5)&quot;</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results5)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;standard normal bootstrap CI &quot;</span>,<span class="st">&quot;basic bootstrap CI&quot;</span>,<span class="st">&quot;percentile bootstrap CI&quot;</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>results5[<span class="dv">1</span>,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(normCI1[,<span class="dv">2</span>]<span class="sc">&lt;</span>s1)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>results5[<span class="dv">1</span>,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(basicCI1[,<span class="dv">2</span>]<span class="sc">&lt;</span>s1)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>results5[<span class="dv">1</span>,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(percentCI1[,<span class="dv">2</span>]<span class="sc">&lt;</span>s1)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>results5[<span class="dv">2</span>,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(normCI2[,<span class="dv">2</span>]<span class="sc">&lt;</span>s2)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>results5[<span class="dv">2</span>,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(basicCI2[,<span class="dv">2</span>]<span class="sc">&lt;</span>s2)</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>results5[<span class="dv">2</span>,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(percentCI2[,<span class="dv">2</span>]<span class="sc">&lt;</span>s2)</span></code></pre></div>
<p><br />
the proportion of times that the confidence intervals miss on the right：</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(results5,<span class="at">align=</span><span class="fu">rep</span>(<span class="st">&#39;c&#39;</span>,<span class="dv">5</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">standard normal bootstrap CI</th>
<th align="center">basic bootstrap CI</th>
<th align="center">percentile bootstrap CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">normal</td>
<td align="center">0.056</td>
<td align="center">0.060</td>
<td align="center">0.038</td>
</tr>
<tr class="even">
<td align="left">chi-suqared(5)</td>
<td align="center">0.216</td>
<td align="center">0.218</td>
<td align="center">0.256</td>
</tr>
</tbody>
</table>
<p><br />
<br />
</p>
</div>
<div id="title-20211104" class="section level2">
<h2>title: “2021—11—04”</h2>
</div>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p><br />
<strong>8.2:</strong><br />
Implement the bivariate Spearman rank correlation test for independence as a permutation test. The Spearman rank correlation test statistic can be obtained from function cor with method = “spearman”. Compare the achieved significance level of the permutation test with the p-value reportedby cor.test on the same samples.</p>
<p><br />
<strong>Discussion:</strong><br />
Design experiments for evaluating the performance of the NN,energy, and ball methods in various situations.<br />
1.Unequal variances and equal expectations<br />
2.Unequal variances and unequal expectations<br />
3.Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)<br />
4.Unbalanced samples (say, 1 case versus 10 controls)<br />
Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p>
<p><br />
</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<p><br />
</p>
<p><strong>8.2:</strong><br />
<br />
Consider <span class="math inline">\(X \sim U[0,2]\)</span>,<span class="math inline">\(Y \sim Exp(1)\)</span> which should be independent to implement the bivariate Spearman rank correlation test for independence.<br />
</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">200</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">&lt;-</span><span class="fu">rexp</span>(n,<span class="dv">1</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>independence<span class="ot">&lt;-</span><span class="cf">function</span>(z,index) {</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co">#dims contains dimensions of x and y</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span>z[,<span class="dv">1</span>]       </span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span>z[index,<span class="dv">2</span>] </span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">cor</span>(x,y,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>))</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">cbind</span>(X,Y),<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>boot.obj<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic=</span>independence,<span class="at">R=</span><span class="dv">499</span>,<span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>)</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>tb<span class="ot">&lt;-</span><span class="fu">c</span>(boot.obj<span class="sc">$</span>t0, boot.obj<span class="sc">$</span>t)</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;The proportion of insignificant permutation is&quot;</span>,<span class="fu">mean</span>(<span class="fu">abs</span>(tb)<span class="sc">&gt;=</span><span class="fu">abs</span>(boot.obj<span class="sc">$</span>t0))))</span></code></pre></div>
<pre><code>## [1] &quot;The proportion of insignificant permutation is 0.756&quot;</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;The p-value obtained by function cor.test() is&quot;</span>,<span class="fu">round</span>(<span class="fu">cor.test</span>(X,Y,<span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value,<span class="dv">3</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;The p-value obtained by function cor.test() is 0.759&quot;</code></pre>
<p><br />
We cannot refuse the null hypothesis,therefore should regard the two samples are independent,which conforms with the ground truth.<br />
<br />
Then,consider a special dependent situation where <span class="math inline">\(X \sim U[0,2]\)</span>,<span class="math inline">\(Y=-X\)</span>.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">200</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span><span class="dv">2</span><span class="sc">-</span>X</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">cbind</span>(X,Z),<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>boot.obj<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic=</span>independence,<span class="at">R=</span><span class="dv">499</span>,<span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>)</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>tb<span class="ot">&lt;-</span><span class="fu">c</span>(boot.obj<span class="sc">$</span>t0, boot.obj<span class="sc">$</span>t)</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;The proportion of insignificant permutation is&quot;</span>,<span class="fu">mean</span>(<span class="fu">abs</span>(tb)<span class="sc">&gt;=</span><span class="fu">abs</span>(boot.obj<span class="sc">$</span>t0))))</span></code></pre></div>
<pre><code>## [1] &quot;The proportion of insignificant permutation is 0.002&quot;</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;The p-value obtained by function cor.test() is&quot;</span>,<span class="fu">round</span>(<span class="fu">cor.test</span>(X,Z,<span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value,<span class="dv">3</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;The p-value obtained by function cor.test() is 0&quot;</code></pre>
<p><br />
We have good reason to refuse the null hypothesis,therefore should regard the two samples are not independent,which conforms with the ground truth.<br />
<br />
<strong>Discussion:</strong><br />
<br />
(1) Unequal variances and equal expectations<br />
</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">500</span>               <span class="co">#Permutation times</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="dv">2</span>                 <span class="co">#The dimension of data</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">&lt;-</span>n2<span class="ot">&lt;-</span><span class="dv">30</span>           <span class="co">#The sample size of X and Y</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="dv">499</span>               <span class="co">#The number of bootstrap replicates.</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">2</span>                 <span class="co">#The Nearest Neighbor parameter</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span>n1<span class="sc">+</span>n2             <span class="co">#Total sample size</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>N<span class="ot">=</span><span class="fu">c</span>(n1,n2)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>p.values<span class="ot">&lt;-</span>p.values2<span class="ot">&lt;-</span>p.values3<span class="ot">&lt;-</span>p.values4<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)   <span class="co">#contains p-value for 3 methods.</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span>          <span class="co">#Significance level</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a><span class="co">#NN method</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>Tn<span class="ot">&lt;-</span><span class="cf">function</span>(z,ix,sizes,k){</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>  n1<span class="ot">&lt;-</span>sizes[<span class="dv">1</span>]; n2<span class="ot">&lt;-</span>sizes[<span class="dv">2</span>]; n<span class="ot">&lt;-</span>n1<span class="sc">+</span>n2</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.vector</span>(z))z<span class="ot">&lt;-</span><span class="fu">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">&lt;-</span>z[ix,];</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>  NN<span class="ot">&lt;-</span><span class="fu">nn2</span>(<span class="at">data=</span>z,<span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>  block1<span class="ot">&lt;-</span>NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>  block2<span class="ot">&lt;-</span>NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>  i1<span class="ot">&lt;-</span><span class="fu">sum</span>(block1<span class="sc">&lt;</span>n1<span class="fl">+.5</span>)</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>  i2<span class="ot">&lt;-</span><span class="fu">sum</span>(block2<span class="sc">&gt;</span>n1<span class="fl">+.5</span>)</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((i1<span class="sc">+</span>i2)<span class="sc">/</span>(k<span class="sc">*</span>n))</span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>eqdist.nn<span class="ot">&lt;-</span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>  boot.obj<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic=</span>Tn,<span class="at">R=</span>R,<span class="at">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="at">sizes=</span>sizes,<span class="at">k=</span>k)</span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>  ts<span class="ot">&lt;-</span><span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a>  p.value<span class="ot">&lt;-</span><span class="fu">mean</span>(ts<span class="sc">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">statistic=</span>ts[<span class="dv">1</span>],<span class="at">p.value=</span>p.value)</span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-30"><a href="#cb71-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-31"><a href="#cb71-31" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb71-32"><a href="#cb71-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb71-33"><a href="#cb71-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb71-34"><a href="#cb71-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb71-35"><a href="#cb71-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-36"><a href="#cb71-36" aria-hidden="true" tabindex="-1"></a><span class="co">#Unequal variances and equal expectations</span></span>
<span id="cb71-37"><a href="#cb71-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb71-38"><a href="#cb71-38" aria-hidden="true" tabindex="-1"></a>  X<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rnorm</span>(n1<span class="sc">*</span>d,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>),<span class="at">ncol=</span>d)</span>
<span id="cb71-39"><a href="#cb71-39" aria-hidden="true" tabindex="-1"></a>  Y<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rnorm</span>(n2<span class="sc">*</span>d,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">2</span>),<span class="at">ncol=</span>d)</span>
<span id="cb71-40"><a href="#cb71-40" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">&lt;-</span><span class="fu">rbind</span>(X,Y)</span>
<span id="cb71-41"><a href="#cb71-41" aria-hidden="true" tabindex="-1"></a>  <span class="co">#NN method</span></span>
<span id="cb71-42"><a href="#cb71-42" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.nn</span>(z,N,k)<span class="sc">$</span>p.value</span>
<span id="cb71-43"><a href="#cb71-43" aria-hidden="true" tabindex="-1"></a>  <span class="co">#energy methods</span></span>
<span id="cb71-44"><a href="#cb71-44" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb71-45"><a href="#cb71-45" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Ball method</span></span>
<span id="cb71-46"><a href="#cb71-46" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">bd.test</span>(<span class="at">x=</span>X,<span class="at">y=</span>Y,<span class="at">num.permutations=</span>R,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">2021</span>)<span class="sc">$</span>p.value</span>
<span id="cb71-47"><a href="#cb71-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-48"><a href="#cb71-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-49"><a href="#cb71-49" aria-hidden="true" tabindex="-1"></a>power1<span class="ot">&lt;-</span><span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb71-50"><a href="#cb71-50" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb71-51"><a href="#cb71-51" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;NN method&quot;</span>,<span class="st">&quot;energy method&quot;</span>,<span class="st">&quot;Ball method&quot;</span>)</span>
<span id="cb71-52"><a href="#cb71-52" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(results)<span class="ot">&lt;-</span><span class="st">&quot;power&quot;</span></span>
<span id="cb71-53"><a href="#cb71-53" aria-hidden="true" tabindex="-1"></a>results[<span class="dv">1</span>,<span class="dv">1</span>]<span class="ot">&lt;-</span>power1[<span class="dv">1</span>]</span>
<span id="cb71-54"><a href="#cb71-54" aria-hidden="true" tabindex="-1"></a>results[<span class="dv">1</span>,<span class="dv">2</span>]<span class="ot">&lt;-</span>power1[<span class="dv">2</span>]</span>
<span id="cb71-55"><a href="#cb71-55" aria-hidden="true" tabindex="-1"></a>results[<span class="dv">1</span>,<span class="dv">3</span>]<span class="ot">&lt;-</span>power1[<span class="dv">3</span>]</span>
<span id="cb71-56"><a href="#cb71-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-57"><a href="#cb71-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-58"><a href="#cb71-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb71-59"><a href="#cb71-59" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(results,<span class="at">align=</span><span class="fu">rep</span>(<span class="st">&#39;c&#39;</span>, <span class="dv">5</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">NN method</th>
<th align="center">energy method</th>
<th align="center">Ball method</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">power</td>
<td align="center">0.576</td>
<td align="center">0.726</td>
<td align="center">0.992</td>
</tr>
</tbody>
</table>
<p><br />
For samples with unequal variances and equal expectations,the Ball method is the most powerful method among 3.<br />
<br />
(2) Unequal variances and unequal expectations<br />
</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  X2<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rnorm</span>(n1<span class="sc">*</span>d,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>),<span class="at">ncol=</span>d)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  Y2<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rnorm</span>(n2<span class="sc">*</span>d,<span class="at">mean=</span><span class="fl">0.5</span>,<span class="at">sd=</span><span class="fl">1.5</span>),<span class="at">ncol=</span>d)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  z2<span class="ot">&lt;-</span><span class="fu">rbind</span>(X2,Y2)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#NN method</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  p.values2[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.nn</span>(z2,N,k)<span class="sc">$</span>p.value</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#energy methods</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  p.values2[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.etest</span>(z2,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Ball method</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  p.values2[i,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">bd.test</span>(<span class="at">x=</span>X2,<span class="at">y=</span>Y2,<span class="at">num.permutations=</span>R,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">2021</span>)<span class="sc">$</span>p.value</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>power2<span class="ot">&lt;-</span><span class="fu">colMeans</span>(p.values2<span class="sc">&lt;</span>alpha)</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;NN method&quot;</span>,<span class="st">&quot;energy method&quot;</span>,<span class="st">&quot;Ball method&quot;</span>)</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(results)<span class="ot">&lt;-</span><span class="st">&quot;power&quot;</span></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>results[<span class="dv">1</span>,<span class="dv">1</span>]<span class="ot">&lt;-</span>power2[<span class="dv">1</span>]</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>results[<span class="dv">1</span>,<span class="dv">2</span>]<span class="ot">&lt;-</span>power2[<span class="dv">2</span>]</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>results[<span class="dv">1</span>,<span class="dv">3</span>]<span class="ot">&lt;-</span>power2[<span class="dv">3</span>]</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(results,<span class="at">align=</span><span class="fu">rep</span>(<span class="st">&#39;c&#39;</span>, <span class="dv">5</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">NN method</th>
<th align="center">energy method</th>
<th align="center">Ball method</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">power</td>
<td align="center">0.294</td>
<td align="center">0.626</td>
<td align="center">0.802</td>
</tr>
</tbody>
</table>
<p><br />
For samples with unequal variances and unequal expectations,the Ball method is most powerful among 3 methods.<br />
<br />
3)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodal distribution (mixture of two normal distributions)<br />
</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  X3<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rt</span>(n1<span class="sc">*</span>d,<span class="at">df=</span><span class="dv">1</span>),<span class="at">ncol=</span>d)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  y1<span class="ot">=</span><span class="fu">rnorm</span>(n2<span class="sc">*</span>d,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>);</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  y2<span class="ot">=</span><span class="fu">rnorm</span>(n2<span class="sc">*</span>d,<span class="at">mean=</span><span class="dv">1</span>,<span class="at">sd=</span><span class="dv">2</span>)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  r<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),n,<span class="at">replace =</span><span class="cn">TRUE</span>,<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  Y3<span class="ot">&lt;-</span><span class="fu">matrix</span>(r<span class="sc">*</span>y1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>r)<span class="sc">*</span>y2,<span class="at">ncol=</span>d)</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  z3<span class="ot">&lt;-</span><span class="fu">rbind</span>(X3,Y3)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#NN method</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  p.values3[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.nn</span>(z3,N,k)<span class="sc">$</span>p.value</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#energy methods</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  p.values3[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.etest</span>(z3,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Ball method</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  p.values3[i,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">bd.test</span>(<span class="at">x=</span>X3,<span class="at">y=</span>Y3,<span class="at">num.permutations=</span>R,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">2021</span>)<span class="sc">$</span>p.value</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>power3<span class="ot">&lt;-</span><span class="fu">colMeans</span>(p.values3<span class="sc">&lt;</span>alpha)</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;NN method&quot;</span>,<span class="st">&quot;energy method&quot;</span>,<span class="st">&quot;Ball method&quot;</span>)</span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(results)<span class="ot">&lt;-</span><span class="st">&quot;power&quot;</span></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>results[<span class="dv">1</span>,<span class="dv">1</span>]<span class="ot">&lt;-</span>power3[<span class="dv">1</span>]</span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>results[<span class="dv">1</span>,<span class="dv">2</span>]<span class="ot">&lt;-</span>power3[<span class="dv">2</span>]</span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>results[<span class="dv">1</span>,<span class="dv">3</span>]<span class="ot">&lt;-</span>power3[<span class="dv">3</span>]</span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(results,<span class="at">align=</span><span class="fu">rep</span>(<span class="st">&#39;c&#39;</span>, <span class="dv">5</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">NN method</th>
<th align="center">energy method</th>
<th align="center">Ball method</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">power</td>
<td align="center">0.214</td>
<td align="center">0.598</td>
<td align="center">0.516</td>
</tr>
</tbody>
</table>
<p><br />
For samples of non-normal distributions,the energy method is most powerful among 3 methods.<br />
<br />
(4) Unbalanced samples (say, 1 case versus 10 controls)<br />
</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>N2<span class="ot">=</span><span class="fu">c</span>(n1,<span class="dv">2</span><span class="sc">*</span>n2)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  X4<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rnorm</span>(n1<span class="sc">*</span>d,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>),<span class="at">ncol=</span>d)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  Y4<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">2</span><span class="sc">*</span>n2<span class="sc">*</span>d,<span class="at">mean=</span><span class="fl">0.5</span>,<span class="at">sd=</span><span class="dv">1</span>),<span class="at">ncol=</span>d)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  z4<span class="ot">&lt;-</span><span class="fu">rbind</span>(X4,Y4)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#NN method</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  p.values4[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.nn</span>(z4,N2,k)<span class="sc">$</span>p.value</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#energy methods</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  p.values4[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.etest</span>(z4,<span class="at">sizes=</span>N2,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Ball method</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  p.values4[i,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">bd.test</span>(<span class="at">x=</span>X4,<span class="at">y=</span>Y4,<span class="at">num.permutations=</span>R,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">2021</span>)<span class="sc">$</span>p.value</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>power4<span class="ot">&lt;-</span><span class="fu">colMeans</span>(p.values4<span class="sc">&lt;</span>alpha)</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;NN method&quot;</span>,<span class="st">&quot;energy method&quot;</span>,<span class="st">&quot;Ball method&quot;</span>)</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(results)<span class="ot">&lt;-</span><span class="st">&quot;power&quot;</span></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>results[<span class="dv">1</span>,<span class="dv">1</span>]<span class="ot">&lt;-</span>power4[<span class="dv">1</span>]</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>results[<span class="dv">1</span>,<span class="dv">2</span>]<span class="ot">&lt;-</span>power4[<span class="dv">2</span>]</span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>results[<span class="dv">1</span>,<span class="dv">3</span>]<span class="ot">&lt;-</span>power4[<span class="dv">3</span>]</span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(results,<span class="at">align=</span><span class="fu">rep</span>(<span class="st">&#39;c&#39;</span>, <span class="dv">5</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">NN method</th>
<th align="center">energy method</th>
<th align="center">Ball method</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">power</td>
<td align="center">0.194</td>
<td align="center">0.752</td>
<td align="center">0.636</td>
</tr>
</tbody>
</table>
<p><br />
For unbalanced samples,the energy method is most powerful among 3 methods.<br />
<br />
In conclusion,Ball method is more suitable when the scale is different.<br />
Energy method is more suitable when the location is different.<br />
Both generally outperforms the NN method,but they cannot uniformly beat each other.</p>
<p><br />
<br />
</p>
</div>
<div id="title-20211111" class="section level2">
<h2>title: “2021—11—11”</h2>
<p><br />
</p>
</div>
<div id="question-7" class="section level2">
<h2>Question</h2>
<p><br />
<strong>9.3:</strong><br />
<br />
Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see qcauchy or qt with df=1). Recall that a Cauchy<span class="math inline">\((\theta,\mu)\)</span> distribution has density function <span class="math display">\[f(x)=\frac{1}{\pi \theta (1+[(x-\mu)/\theta]^2)},  -\infty&lt;x&lt;\infty,\theta&gt;0.\]</span> The standard Cauchy has the Cauchy(<span class="math inline">\(\theta = 1\)</span>,<span class="math inline">\(\mu = 0\)</span>) density. (Note that the standard Cauchy density is equal to the Student t density with one degree of freedom.)<br />
<br />
</p>
<p><strong>9.8:</strong><br />
<br />
This example appears in [40]. Consider the bivariate density <span class="math display">\[f(x,y)\propto\binom{n}{x}y^{x+a+1}(1-y)^{n-x+b-1},x=0,1,\cdots,n,0\leq y\leq 1\]</span> It can be shown that for fixed a, b, n, the conditional distributions are Binomial(n, y) and Beta(x + a, n − x + b). Use the Gibbs sampler to generate a chain with target joint density f(x, y).<br />
<br />
<br />
</p>
<p>For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to &lt; 1.2.<br />
</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<p><br />
</p>
<p><strong>9.3:</strong><br />
<br />
Choose <span class="math inline">\(U[-1,1]\)</span>(which is symmetric and therefore qualified as Metropolis-Hastings sampler) as the proposal distribution of this exercise.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="co">#The standard Cauchy distribution&#39;s density function</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(x) {</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span><span class="sc">/</span>(pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span>                     <span class="co">#the number of samples</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)                <span class="co">#the vector that stores samples</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)            <span class="co">#the first sample</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">0</span>              <span class="co">#k records the number of rejected candidate points.</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>burntime<span class="ot">&lt;-</span><span class="dv">100</span>    <span class="co">#discard the first 1000 samples</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(m)       <span class="co">#useful for acceptance probability. </span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a><span class="co">#generate the chain</span></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>  xt<span class="ot">&lt;-</span>x[i<span class="dv">-1</span>]</span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span>xt<span class="sc">+</span><span class="fu">runif</span>(<span class="dv">1</span>,<span class="at">min=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">max=</span><span class="dv">1</span>)</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>  num<span class="ot">&lt;-</span><span class="fu">f</span>(y)<span class="sc">*</span><span class="fu">dnorm</span>(xt,<span class="at">mean=</span>y,<span class="at">sd=</span><span class="dv">1</span>)          <span class="co">#the numerator</span></span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>  den<span class="ot">&lt;-</span><span class="fu">f</span>(xt)<span class="sc">*</span><span class="fu">dnorm</span>(y,<span class="at">mean=</span>xt,<span class="at">sd=</span><span class="dv">1</span>)         <span class="co">#the denominator</span></span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (u[i]<span class="sc">&lt;=</span>num<span class="sc">/</span>den) x[i]<span class="ot">&lt;-</span>y </span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>    x[i]<span class="ot">&lt;-</span>xt</span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a>    k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span>               <span class="co">#y is rejected </span></span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;The rate of candidate points rejected is &quot;</span>,k<span class="sc">/</span>m))</span></code></pre></div>
<pre><code>## [1] &quot;The rate of candidate points rejected is  0.152&quot;</code></pre>
<p><br />
In this example, approximately 17% of the candidate points are rejected, so the chain is relatively efficient.<br />
<br />
To see the generated sample as a realization of a stochastic process, we can plot the sample vs the time index.<br />
The following code will display a partial plot starting at time index 1001 after discarding the burn-in time.<br />
</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span>x[burntime<span class="sc">+</span><span class="dv">1</span><span class="sc">:</span>m]             <span class="co">#discard the first 1000 samples.</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>index<span class="ot">&lt;-</span>burntime<span class="sc">+</span><span class="dv">1</span><span class="sc">:</span>m</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(index,X,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">main=</span><span class="st">&quot;trace plot&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;random number&quot;</span>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="sc">-</span><span class="dv">5</span>,<span class="at">lty =</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)     </span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="co">#to highlight the range where most samples from t(1) fall in.</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">5</span>,<span class="at">lty =</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
Note that for samples generated from t(1),most fall in <span class="math inline">\([-5,5]\)</span>,which is highlighted using red dot lines.<br />
The trace plot above indicates good convergence of the chain.<br />
Now plot the histogram of the chain to see if it converges to standard Cauchy.<br />
</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X,<span class="at">breaks=</span><span class="st">&quot;scott&quot;</span>,<span class="at">main=</span><span class="st">&quot;histogram  of the generated samples&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">freq=</span><span class="cn">FALSE</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.35</span>))</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(k,<span class="fu">dcauchy</span>(k),<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">lwd=</span><span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><br />
And the histogram of the generated samples confirms that.(the red line stands for the density of the standard Cauchy distribution.)<br />
<br />
The following code compares the deciles of the generated observations with the deciles of the standard Cauchy distribution:<br />
</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>Q<span class="ot">&lt;-</span><span class="fu">quantile</span>(X,<span class="at">probs=</span><span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>),<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>Qqc<span class="ot">&lt;-</span><span class="fu">qcauchy</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>),<span class="at">loc=</span><span class="dv">0</span>,<span class="at">scale=</span><span class="dv">1</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>,<span class="fl">0.01</span>)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">9</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(results)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;10%&quot;</span>,<span class="st">&quot;20%&quot;</span>,<span class="st">&quot;30%&quot;</span>,<span class="st">&quot;40%&quot;</span>,<span class="st">&quot;50%&quot;</span>,<span class="st">&quot;60%&quot;</span>,<span class="st">&quot;70%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;90%&quot;</span>)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Generated observations&quot;</span>,<span class="st">&quot;standard Cauchy distribution&quot;</span>)</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>results[,<span class="dv">1</span>]<span class="ot">&lt;-</span>Q</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>results[,<span class="dv">2</span>]<span class="ot">&lt;-</span>Qqc</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(results,<span class="at">align=</span><span class="fu">rep</span>(<span class="st">&#39;c&#39;</span>, <span class="dv">5</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">Generated observations</th>
<th align="center">standard Cauchy distribution</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">10%</td>
<td align="center">-2.1987496</td>
<td align="center">-3.0776835</td>
</tr>
<tr class="even">
<td align="left">20%</td>
<td align="center">-1.4467293</td>
<td align="center">-1.3763819</td>
</tr>
<tr class="odd">
<td align="left">30%</td>
<td align="center">-0.8100561</td>
<td align="center">-0.7265425</td>
</tr>
<tr class="even">
<td align="left">40%</td>
<td align="center">-0.3799002</td>
<td align="center">-0.3249197</td>
</tr>
<tr class="odd">
<td align="left">50%</td>
<td align="center">-0.1128804</td>
<td align="center">0.0000000</td>
</tr>
<tr class="even">
<td align="left">60%</td>
<td align="center">0.1885793</td>
<td align="center">0.3249197</td>
</tr>
<tr class="odd">
<td align="left">70%</td>
<td align="center">0.5609564</td>
<td align="center">0.7265425</td>
</tr>
<tr class="even">
<td align="left">80%</td>
<td align="center">1.0904890</td>
<td align="center">1.3763819</td>
</tr>
<tr class="odd">
<td align="left">90%</td>
<td align="center">2.1157689</td>
<td align="center">3.0776835</td>
</tr>
</tbody>
</table>
<p><br />
<br />
Now we usse the Gelman-Rubin method to monitor convergence of the chain.<br />
Note that for Cauchy distribution,the expectation doesn’t exist,so monitoring the mean of the chain may not be a wise and robust method,instead,we can use median as the scalar summary statistic that estimates some parameter of the target distribution.<br />
<br />
Target distribution: <span class="math inline">\(t(1)\)</span><br />
Proposal distribution: <span class="math inline">\(N(X_t,1)\)</span><br />
The scalar summary statistic of the target distribution <span class="math inline">\(\phi_{ij}\)</span>: median of the <span class="math inline">\(j\)</span>th chain up to time <span class="math inline">\(i\)</span>.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>    Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>        <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>        <span class="co"># for chain in i-th row of X</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>        psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>        n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>        k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>        psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>        B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>        psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>        W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>        v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>        r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W             <span class="co">#G-R statistic</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(r.hat)</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>    Chain<span class="ot">&lt;-</span><span class="cf">function</span>(sigma,N,StartPoint) { </span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a><span class="co">#generates a Metropolis chain for t(1) with N(X[t],sigma) proposal distribution and deterimined starting value. </span></span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>        x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>        x[<span class="dv">1</span>] <span class="ot">&lt;-</span>StartPoint</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>        u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>        xt<span class="ot">&lt;-</span>x[i<span class="dv">-1</span>]</span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>        y<span class="ot">&lt;-</span>xt<span class="sc">+</span><span class="fu">runif</span>(<span class="dv">1</span>,<span class="at">min=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">max=</span><span class="dv">1</span>)</span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>        num<span class="ot">&lt;-</span><span class="fu">dt</span>(y,<span class="dv">1</span>)<span class="sc">*</span><span class="fu">dnorm</span>(xt,<span class="at">mean=</span>y,<span class="at">sd=</span>sigma)         </span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a>        den<span class="ot">&lt;-</span><span class="fu">dt</span>(xt,<span class="dv">1</span>)<span class="sc">*</span><span class="fu">dnorm</span>(y,<span class="at">mean=</span>xt,<span class="at">sd=</span>sigma)</span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a>        s<span class="ot">&lt;-</span>num<span class="sc">/</span>den</span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (u[i]<span class="sc">&lt;=</span>s)    x[i]<span class="ot">&lt;-</span>y </span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a>          <span class="cf">else</span>            x[i]<span class="ot">&lt;-</span>xt</span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(x)</span>
<span id="cb80-33"><a href="#cb80-33" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb80-34"><a href="#cb80-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-35"><a href="#cb80-35" aria-hidden="true" tabindex="-1"></a>    sigma<span class="ot">&lt;-</span><span class="dv">1</span>     <span class="co">#parameter of proposal distribution  N(X[t],sigma)</span></span>
<span id="cb80-36"><a href="#cb80-36" aria-hidden="true" tabindex="-1"></a>    k<span class="ot">&lt;-</span><span class="dv">4</span>         <span class="co">#number of chains to generate</span></span>
<span id="cb80-37"><a href="#cb80-37" aria-hidden="true" tabindex="-1"></a>    n<span class="ot">&lt;-</span> <span class="dv">10000</span>      <span class="co">#length of chains</span></span>
<span id="cb80-38"><a href="#cb80-38" aria-hidden="true" tabindex="-1"></a>    burntime <span class="ot">&lt;-</span> <span class="dv">1000</span>       <span class="co">#burn-in length</span></span>
<span id="cb80-39"><a href="#cb80-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-40"><a href="#cb80-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">#choose overdispersed initial values</span></span>
<span id="cb80-41"><a href="#cb80-41" aria-hidden="true" tabindex="-1"></a>    x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb80-42"><a href="#cb80-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-43"><a href="#cb80-43" aria-hidden="true" tabindex="-1"></a>    <span class="co">#generate the chains</span></span>
<span id="cb80-44"><a href="#cb80-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb80-45"><a href="#cb80-45" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb80-46"><a href="#cb80-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb80-47"><a href="#cb80-47" aria-hidden="true" tabindex="-1"></a>        X[i, ] <span class="ot">&lt;-</span> <span class="fu">Chain</span>(sigma, n, x0[i])</span>
<span id="cb80-48"><a href="#cb80-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-49"><a href="#cb80-49" aria-hidden="true" tabindex="-1"></a>    <span class="co">#compute diagnostic statistics : median</span></span>
<span id="cb80-50"><a href="#cb80-50" aria-hidden="true" tabindex="-1"></a>    ind<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb80-51"><a href="#cb80-51" aria-hidden="true" tabindex="-1"></a>    psi<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="at">nrow=</span>k,<span class="at">ncol=</span>n)</span>
<span id="cb80-52"><a href="#cb80-52" aria-hidden="true" tabindex="-1"></a>    <span class="co">#for a matrix 1 indicates rows, 2 indicates columns</span></span>
<span id="cb80-53"><a href="#cb80-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb80-54"><a href="#cb80-54" aria-hidden="true" tabindex="-1"></a>       <span class="cf">for</span> (ind <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb80-55"><a href="#cb80-55" aria-hidden="true" tabindex="-1"></a>         Z<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(X[i,<span class="dv">1</span><span class="sc">:</span>ind])</span>
<span id="cb80-56"><a href="#cb80-56" aria-hidden="true" tabindex="-1"></a>     psi[i,ind]<span class="ot">&lt;-</span><span class="fu">apply</span>(Z,<span class="dv">2</span>,median)</span>
<span id="cb80-57"><a href="#cb80-57" aria-hidden="true" tabindex="-1"></a>     ind<span class="ot">&lt;-</span>ind<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb80-58"><a href="#cb80-58" aria-hidden="true" tabindex="-1"></a>       }</span>
<span id="cb80-59"><a href="#cb80-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb80-60"><a href="#cb80-60" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plot psi for the four chains</span></span>
<span id="cb80-61"><a href="#cb80-61" aria-hidden="true" tabindex="-1"></a>     <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb80-62"><a href="#cb80-62" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb80-63"><a href="#cb80-63" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot</span>((burntime<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,psi[i, (burntime<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n],<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb80-64"><a href="#cb80-64" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab=</span><span class="st">&#39;index&#39;</span>, <span class="at">ylab=</span><span class="fu">bquote</span>(phi),<span class="at">main=</span><span class="st">&quot;trace plot&quot;</span>)</span>
<span id="cb80-65"><a href="#cb80-65" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb80-66"><a href="#cb80-66" aria-hidden="true" tabindex="-1"></a>        <span class="fu">lines</span>((burntime<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,psi[i,(burntime<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n],<span class="at">col=</span>i)</span>
<span id="cb80-67"><a href="#cb80-67" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
We can see that <span class="math inline">\(\phi\)</span> converges to 0,which is reasonable as t(1) is a symmetric distribution,so the median should be close to 0.<br />
In light of this observation,we can say that the chain converges approximately to the target distribution.<br />
<br />
Further consider the Gelman-Rubin statistic <span class="math inline">\(\sqrt{\hat{R}}\)</span>,and follow the rule that the chain converges approximately to the target distribution when <span class="math inline">\(\sqrt{\hat{R}}&lt;1.2\)</span>.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>    rhat<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> (burntime<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>        rhat[j]<span class="ot">&lt;-</span><span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(rhat[(burntime<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;R&quot;</span>,<span class="at">main =</span> <span class="st">&quot;the Gelman-Rubin statistic &quot;</span>)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
Therefore we can draw the conclusion that the chain finally converges to the target distribution.<br />
<br />
</p>
<p><strong>9.8:</strong><br />
<br />
For the target joint density in the form : <span class="math display">\[f(x,y)\propto\binom{n}{x}y^{x+a+1}(1-y)^{n-x+b-1},x=0,1,\cdots,n,0\leq y\leq 1\]</span></p>
<p>the conditional distribution of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is Binomial <span class="math inline">\((n,y)\)</span> and Beta <span class="math inline">\((x + a, n − x + b)\)</span>,respectively.<br />
The code using the Gibbs sampler to generate a chain with such target joint density is as follows.<br />
</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">1000</span>                    <span class="co">#length of chain</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>burntime<span class="ot">&lt;-</span><span class="dv">100</span>             <span class="co">#burn-in length</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)            <span class="co">#bivariate sample</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Beta(1,1) is equivalent to U[0,1]</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">25</span> </span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>,]<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)              <span class="co">#initialize starting point</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="at">size=</span>n,<span class="at">prob=</span>x2)</span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span> X[i,<span class="dv">1</span>]</span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x1<span class="sc">+</span>a,n<span class="sc">-</span>x1<span class="sc">+</span>b)</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Obtain the trace plot of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.<br />
</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span>X[(burntime<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,]</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x[,<span class="dv">1</span>],<span class="at">main=</span><span class="st">&quot;trace plot for X and Y&quot;</span>,<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">lwd=</span><span class="fl">0.7</span>,<span class="at">xlab=</span><span class="st">&#39;index&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;Random numbers&#39;</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x[,<span class="dv">2</span>],<span class="at">lwd=</span><span class="fl">0.7</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topright&#39;</span>,<span class="fu">c</span>(<span class="st">&quot;X&quot;</span>,<span class="st">&quot;Y&quot;</span>),<span class="at">lwd=</span><span class="dv">1</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>),<span class="at">cex=</span><span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
Further we can give the bivariate chain plot.<br />
</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">main=</span><span class="st">&quot;Bivariate chain generated by the Gibbs sampler&quot;</span>,<span class="at">cex=</span><span class="fl">0.5</span>,<span class="at">xlab=</span><span class="st">&quot;X&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Y&quot;</span>,<span class="at">ylim=</span><span class="fu">range</span>(x[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
The above figure exhibits the elliptical symmetry of the bivariate chain, with strong positive correlation.(printed after discarding the burn-in sample.)<br />
<br />
Note that the mean of <span class="math inline">\(X\)</span> should be <span class="math inline">\(ny\)</span>,and the mean of <span class="math inline">\(Y\)</span> should be <span class="math inline">\(\frac{x+a}{n+a+b}\)</span>.<br />
Then we can compare the mean of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> to see if they are close to theoretical value.<br />
</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;The mean of X and Y is &quot;</span>,<span class="fu">round</span>(<span class="fu">colMeans</span>(x)[<span class="dv">1</span>],<span class="dv">4</span>),<span class="st">&quot;and &quot;</span>,<span class="fu">round</span>(<span class="fu">colMeans</span>(x)[<span class="dv">2</span>],<span class="dv">4</span>),<span class="st">&quot;,respectively.&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;The mean of X and Y is  14.0056 and  0.5576 ,respectively.&quot;</code></pre>
<p>Note that n=25 in this case,and 25 <span class="math inline">\(\times\)</span> 0.5003 is close to 12.5113,which indicates that the chain converges well.<br />
<br />
Finally,use the Gelman-Rubin statistic <span class="math inline">\(\sqrt{\hat{R}}\)</span>,and follow the rule that the chain converges approximately to the target distribution when <span class="math inline">\(\sqrt{\hat{R}}&lt;1.2\)</span>.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">25</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">3</span>                     <span class="co">#number of chains to generate</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span> <span class="dv">1000</span>                <span class="co">#length of chains</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>burntime <span class="ot">&lt;-</span> <span class="dv">100</span>         <span class="co">#burn-in length</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>X1<span class="ot">&lt;-</span>X2<span class="ot">&lt;-</span>X3<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)         <span class="co">#bivariate sample</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a> <span class="co">#initialize starting point</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>X1[<span class="dv">1</span>,]<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)             </span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>X2[<span class="dv">1</span>,]<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.4</span>,<span class="fl">0.2</span>)</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>X3[<span class="dv">1</span>,]<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.6</span>)</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a> Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># for chain in i-th row of X</span></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>        psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>        n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>        k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>        psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>        B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>        psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>        W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>        v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a>        r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W             <span class="co">#G-R statistic</span></span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(r.hat)</span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> X1[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a>X1[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="at">size=</span>n,<span class="at">prob=</span>x2)</span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span> X1[i,<span class="dv">1</span>]</span>
<span id="cb87-35"><a href="#cb87-35" aria-hidden="true" tabindex="-1"></a>X1[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x1<span class="sc">+</span>a,n<span class="sc">-</span>x1<span class="sc">+</span>b)</span>
<span id="cb87-36"><a href="#cb87-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-37"><a href="#cb87-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-38"><a href="#cb87-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb87-39"><a href="#cb87-39" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> X2[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb87-40"><a href="#cb87-40" aria-hidden="true" tabindex="-1"></a>X2[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="at">size=</span>n,<span class="at">prob=</span>x2)</span>
<span id="cb87-41"><a href="#cb87-41" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span> X2[i,<span class="dv">1</span>]</span>
<span id="cb87-42"><a href="#cb87-42" aria-hidden="true" tabindex="-1"></a>X2[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x1<span class="sc">+</span>a,n<span class="sc">-</span>x1<span class="sc">+</span>b)</span>
<span id="cb87-43"><a href="#cb87-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-44"><a href="#cb87-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-45"><a href="#cb87-45" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb87-46"><a href="#cb87-46" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> X3[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb87-47"><a href="#cb87-47" aria-hidden="true" tabindex="-1"></a>X3[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="at">size=</span>n,<span class="at">prob=</span>x2)</span>
<span id="cb87-48"><a href="#cb87-48" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span> X3[i,<span class="dv">1</span>]</span>
<span id="cb87-49"><a href="#cb87-49" aria-hidden="true" tabindex="-1"></a>X3[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x1<span class="sc">+</span>a,n<span class="sc">-</span>x1<span class="sc">+</span>b)</span>
<span id="cb87-50"><a href="#cb87-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-51"><a href="#cb87-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-52"><a href="#cb87-52" aria-hidden="true" tabindex="-1"></a>Z1<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>k,<span class="at">ncol=</span>N)</span>
<span id="cb87-53"><a href="#cb87-53" aria-hidden="true" tabindex="-1"></a>Z2<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>k,<span class="at">ncol=</span>N)</span></code></pre></div>
<p>Give the Gelman-Rubin statistic plots of X and Y,respectively.<br />
</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>Z1[<span class="dv">1</span>,]<span class="ot">&lt;-</span>X1[,<span class="dv">1</span>]</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>Z1[<span class="dv">2</span>,]<span class="ot">&lt;-</span>X2[,<span class="dv">1</span>]</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>Z1[<span class="dv">3</span>,]<span class="ot">&lt;-</span>X3[,<span class="dv">1</span>]</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>psi<span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(Z1, <span class="dv">1</span>, cumsum))</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>        psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,N)</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> (burntime<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N)</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>        rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(rhat[(burntime<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>,<span class="at">main=</span><span class="st">&quot;the Gelman-Rubin statistic for X&quot;</span>)</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>Z2[<span class="dv">1</span>,]<span class="ot">&lt;-</span>X1[,<span class="dv">2</span>]</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>Z2[<span class="dv">2</span>,]<span class="ot">&lt;-</span>X2[,<span class="dv">2</span>]</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>Z2[<span class="dv">3</span>,]<span class="ot">&lt;-</span>X3[,<span class="dv">2</span>]</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>psi2<span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(Z2, <span class="dv">1</span>, cumsum))</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi2))</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>        psi2[i,] <span class="ot">&lt;-</span> psi2[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi2))</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>rhat2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,N)</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> (burntime<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N)</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>        rhat2[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi2[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(rhat2[(burntime<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>,<span class="at">main=</span><span class="st">&quot;the Gelman-Rubin statistic for Y&quot;</span>)</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
We can see that both tends to be below 1.2 as n increases.<br />
Therefore we can believe that the bivariate chain converges to the target joint density well.</p>
<p><br />
<br />
## title: “2021—11—18”<br />
</p>
</div>
<div id="question-8" class="section level2">
<h2>Question</h2>
<p><br />
<strong>11.3:</strong><br />
<br />
(a) Write a function to compute the <span class="math inline">\(k^{th}\)</span> term in, <span class="math display">\[\sum_{k=0}^{\infty}\frac{(-1)^k}{k!2^k}\frac{\left \| a \right \|^{2k+2}}{(2k+1)(2k+2)}\frac{\Gamma (\frac{d+1}{2})\Gamma (k+\frac{3}{2})}{\Gamma (k+\frac{d}{2}+1)},\]</span> where <span class="math inline">\(d ≥ 1\)</span> is an integer,<span class="math inline">\(a\)</span> is a vector in <span class="math inline">\(\mathbb{R}^d\)</span>, and <span class="math inline">\(\left \| \cdot \right \|\)</span> denotes the Euclidean norm.<br />
Perform the arithmetic so that the coefficients can be computed for (almost) arbitrarily large <span class="math inline">\(k\)</span> and <span class="math inline">\(d\)</span>. (This sum converges for all <span class="math inline">\(a \in \mathbb{R}^d\)</span>.<br />
(b) Modify the function so that it computes and returns the sum.<br />
(c) Evaluate the sum when <span class="math inline">\(a = (1, 2)^T\)</span> .<br />
<br />
</p>
<p><strong>11.5:</strong><br />
<br />
Write a function to solve the equation <span class="math display">\[\frac{2\Gamma (\frac{k}{2})}{\sqrt{\pi(k-1)}(\frac{k-1}{2})}\int_{0}^{c_{k-1}}(1+\frac{u^2}{k-1})^{-\frac{k}{2}}du=\frac{2\Gamma (\frac{k+1}{2})}{\sqrt{\pi k}(\frac{k}{2})}\int_{0}^{c_{k}}(1+\frac{u^2}{k})^{-\frac{k+1}{2}}du\]</span> for a, where <span class="math display">\[c_k=\sqrt{  \frac{a^2k}{k+1-a^2}  }\]</span> Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4.<br />
<br />
</p>
<p><strong>EM exercise:</strong><br />
<br />
Suppose $T_1,,T_n $ are i.i.d. samples drawn from the exponential distribution with expectation <span class="math inline">\(λ\)</span>. Those values greater than <span class="math inline">\(\tau\)</span> are not observed due to right censorship, so that the observed values are <span class="math inline">\(Y_i=T_iI(T_i≤τ)+τI(T_i&gt;τ),i = 1,\cdots, n\)</span>. Suppose $= 1 $and the observed <span class="math inline">\(Y_i\)</span> values are as follows: <span class="math display">\[0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85\]</span> Use the E-M algorithm to estimate <span class="math inline">\(λ\)</span>, compare your result with the observed data MLE (note: <span class="math inline">\(Y_i\)</span> follows a mixture distribution).<br />
<br />
</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<p><br />
</p>
<p><strong>11.3:</strong><br />
<br />
(a) As <span class="math inline">\(k!=\Gamma(k+1)\)</span>, <span class="math display">\[\frac{(-1)^k}{k!2^k}\frac{\left \| a \right \|^{2k+2}}{(2k+1)(2k+2)}\frac{\Gamma (\frac{d+1}{2})\Gamma (k+\frac{3}{2})}{\Gamma (k+\frac{d}{2}+1)},\]</span> can be rewritten as <span class="math display">\[\frac{(-1)^k}{2^k}\frac{\left \| a \right \|^{2k+2}}{(2k+1)(2k+2)}\frac{\Gamma (\frac{d+1}{2})\Gamma (k+\frac{3}{2})}{\Gamma (k+\frac{d}{2}+1)\Gamma (k+1)}\]</span> Use the idea that <span class="math inline">\(\frac{b}{a}=exp(lg{\frac{b}{a}} )=exp(lgb-lga)\)</span>,we can compute the kth term in the following way:<br />
</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#compute the Euclidean norm of a vector</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>norm_vec<span class="ot">&lt;-</span><span class="cf">function</span>(x,k)    <span class="fu">sqrt</span>(<span class="fu">sum</span>(x<span class="sc">*</span>x)<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>))</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="co">#compute the kth term of the series</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>kth<span class="ot">&lt;-</span><span class="cf">function</span>(vector,d,k){</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(d<span class="sc">&gt;=</span><span class="dv">1</span>) </span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  term<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">*</span><span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">1</span>))<span class="sc">*</span><span class="fu">norm_vec</span>(a,k)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">^</span>k)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span> (term)</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><br />
(b) Modify the function so that it computes and returns the sum.<br />
</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">#compute the sum of the series</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>series<span class="ot">&lt;-</span><span class="cf">function</span>(vector,d,eps){</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="dv">0</span>                           <span class="co">#the nth term</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  total<span class="ot">&lt;-</span><span class="dv">0</span>                       <span class="co">#to store the sum</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">repeat</span>{</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>    total<span class="ot">&lt;-</span>total<span class="sc">+</span><span class="fu">kth</span>(vector,d,n)</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>    n<span class="ot">&lt;-</span>n<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>    s<span class="ot">&lt;-</span><span class="fu">abs</span>(<span class="fu">kth</span>(vector,d,n))      <span class="co">#when   </span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (s<span class="sc">&lt;</span>eps){</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span> </span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(total)</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><br />
(c)Evaluate the sum when <span class="math inline">\(a = (1, 2)^T\)</span>.<br />
</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>eps<span class="ot">&lt;-</span>.Machine<span class="sc">$</span>double.eps<span class="sc">^</span><span class="fl">0.25</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;The sum of the series is&quot;</span>,<span class="fu">round</span>(<span class="fu">series</span>(a,d,eps),<span class="dv">5</span>),<span class="st">&quot;when a=(1,2)T&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;The sum of the series is 1.5322 when a=(1,2)T&quot;</code></pre>
<p><br />
<strong>11.5:</strong><br />
<br />
Set <span class="math inline">\(k=4,5,\cdots,10.\)</span>Compare the solution with 11.4.<br />
</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>K<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fu">length</span>(K)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>root<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>eps<span class="ot">&lt;-</span>.Machine<span class="sc">$</span>double.eps<span class="sc">^</span><span class="fl">0.25</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">&lt;-</span>K[n]</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>  f<span class="ot">&lt;-</span><span class="cf">function</span>(a){</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>  z1<span class="ot">&lt;-</span><span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">/</span>(k<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>  z2<span class="ot">&lt;-</span><span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>  f1<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">lgamma</span>(k<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>((k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>(z1<span class="sc">*</span>x)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span>(k<span class="dv">-1</span>))<span class="sc">^</span>(<span class="sc">-</span>k<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span>z1<span class="sc">/</span><span class="fu">sqrt</span>((k<span class="dv">-1</span>)<span class="sc">*</span>pi)<span class="sc">-</span><span class="fu">exp</span>(<span class="fu">lgamma</span>((k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">/</span><span class="dv">2</span>))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>(z2<span class="sc">*</span>x)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span>k)<span class="sc">^</span>(<span class="sc">-</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span>z2<span class="sc">/</span><span class="fu">sqrt</span>(k<span class="sc">*</span>pi) }</span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">integrate</span>(f1,eps,<span class="dv">1</span>)<span class="sc">$</span>value)</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a> times<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a> b0<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a> b1<span class="ot">&lt;-</span><span class="fu">sqrt</span>(k)<span class="sc">-</span>eps</span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a> r<span class="ot">&lt;-</span><span class="fu">seq</span>(b0, b1, <span class="at">length=</span><span class="dv">3</span>)</span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a> y<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">f</span>(r[<span class="dv">1</span>]),<span class="fu">f</span>(r[<span class="dv">2</span>]),<span class="fu">f</span>(r[<span class="dv">3</span>]))</span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span> (y[<span class="dv">1</span>]<span class="sc">*</span>y[<span class="dv">3</span>] <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a><span class="fu">stop</span>(<span class="st">&quot;f does not have opposite sign at endpoints&quot;</span>)</span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a> <span class="cf">while</span>(times<span class="sc">&lt;</span><span class="dv">1000</span> <span class="sc">&amp;&amp;</span> <span class="fu">abs</span>(y[<span class="dv">2</span>])<span class="sc">&gt;</span>eps) {</span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a>    times<span class="ot">&lt;-</span>times <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (y[<span class="dv">1</span>]<span class="sc">*</span>y[<span class="dv">2</span>]<span class="sc">&lt;</span><span class="dv">0</span>) {</span>
<span id="cb94-27"><a href="#cb94-27" aria-hidden="true" tabindex="-1"></a>  r[<span class="dv">3</span>]<span class="ot">&lt;-</span>r[<span class="dv">2</span>]</span>
<span id="cb94-28"><a href="#cb94-28" aria-hidden="true" tabindex="-1"></a>  y[<span class="dv">3</span>]<span class="ot">&lt;-</span>y[<span class="dv">2</span>]</span>
<span id="cb94-29"><a href="#cb94-29" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb94-30"><a href="#cb94-30" aria-hidden="true" tabindex="-1"></a> <span class="cf">else</span> {</span>
<span id="cb94-31"><a href="#cb94-31" aria-hidden="true" tabindex="-1"></a>   r[<span class="dv">1</span>]<span class="ot">&lt;-</span>r[<span class="dv">2</span>]</span>
<span id="cb94-32"><a href="#cb94-32" aria-hidden="true" tabindex="-1"></a>  y[<span class="dv">1</span>]<span class="ot">&lt;-</span>y[<span class="dv">2</span>]</span>
<span id="cb94-33"><a href="#cb94-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-34"><a href="#cb94-34" aria-hidden="true" tabindex="-1"></a>r[<span class="dv">2</span>]<span class="ot">&lt;-</span>(r[<span class="dv">1</span>]<span class="sc">+</span>r[<span class="dv">3</span>])<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb94-35"><a href="#cb94-35" aria-hidden="true" tabindex="-1"></a>y[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">f</span>(r[<span class="dv">2</span>])</span>
<span id="cb94-36"><a href="#cb94-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-37"><a href="#cb94-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-38"><a href="#cb94-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-39"><a href="#cb94-39" aria-hidden="true" tabindex="-1"></a> root[n]<span class="ot">&lt;-</span>r[<span class="dv">2</span>]</span>
<span id="cb94-40"><a href="#cb94-40" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><br />
Present the solutions:<br />
</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># results&lt;-matrix(0,nrow=7,ncol=1)</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="co"># rownames(results)&lt;-4:10</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(results)&lt;-c(&quot;Solution&quot;)</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="co"># results[,1]&lt;-root</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="co"># library(knitr)</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="co"># knitr::kable(results,align=rep(&#39;c&#39;, 5))</span></span></code></pre></div>
<p><br />
For exercise 11.4:<br />
</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>K1<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>N1<span class="ot">&lt;-</span><span class="fu">length</span>(K1)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>eps<span class="ot">&lt;-</span>.Machine<span class="sc">$</span>double.eps<span class="sc">^</span><span class="fl">0.25</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>root2<span class="ot">&lt;-</span><span class="fu">numeric</span>(N1)</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="co">#root-finding function,with regard to a</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>findinter<span class="ot">&lt;-</span><span class="cf">function</span>(a) {</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>  c1<span class="ot">&lt;-</span><span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">/</span>(k<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>  c2<span class="ot">&lt;-</span><span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>  difference<span class="ot">&lt;-</span><span class="fu">pt</span>(c1,<span class="at">df=</span>k<span class="dv">-1</span>)<span class="sc">-</span><span class="fu">pt</span>(c2,<span class="at">df=</span>k)</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#lower.tail=TRUE by default,computing P(X&lt;=x)</span></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (difference)</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N1) {</span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">&lt;-</span>K1[n]</span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>  b0<span class="ot">&lt;-</span>eps</span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>  b1<span class="ot">&lt;-</span><span class="fu">sqrt</span>(k)<span class="sc">-</span>eps</span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a> root2[n]<span class="ot">&lt;-</span><span class="fu">uniroot</span>(findinter,<span class="at">interval=</span><span class="fu">c</span>(b0, b1))<span class="sc">$</span>root</span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a>results2<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">25</span>,<span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(results2)<span class="ot">&lt;-</span>K1</span>
<span id="cb96-26"><a href="#cb96-26" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results2)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Intersection point&quot;</span>)</span>
<span id="cb96-27"><a href="#cb96-27" aria-hidden="true" tabindex="-1"></a>results2[,<span class="dv">1</span>]<span class="ot">&lt;-</span>root2</span>
<span id="cb96-28"><a href="#cb96-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-29"><a href="#cb96-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb96-30"><a href="#cb96-30" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(results2,<span class="at">align=</span><span class="fu">rep</span>(<span class="st">&#39;c&#39;</span>, <span class="dv">5</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">Intersection point</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">4</td>
<td align="center">1.492103</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="center">1.533549</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="center">1.562768</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="center">1.584421</td>
</tr>
<tr class="odd">
<td align="left">8</td>
<td align="center">1.601196</td>
</tr>
<tr class="even">
<td align="left">9</td>
<td align="center">1.614530</td>
</tr>
<tr class="odd">
<td align="left">10</td>
<td align="center">1.625368</td>
</tr>
<tr class="even">
<td align="left">11</td>
<td align="center">1.634405</td>
</tr>
<tr class="odd">
<td align="left">12</td>
<td align="center">1.642024</td>
</tr>
<tr class="even">
<td align="left">13</td>
<td align="center">1.648540</td>
</tr>
<tr class="odd">
<td align="left">14</td>
<td align="center">1.654170</td>
</tr>
<tr class="even">
<td align="left">15</td>
<td align="center">1.659099</td>
</tr>
<tr class="odd">
<td align="left">16</td>
<td align="center">1.663452</td>
</tr>
<tr class="even">
<td align="left">17</td>
<td align="center">1.667288</td>
</tr>
<tr class="odd">
<td align="left">18</td>
<td align="center">1.670736</td>
</tr>
<tr class="even">
<td align="left">19</td>
<td align="center">1.673840</td>
</tr>
<tr class="odd">
<td align="left">20</td>
<td align="center">1.676588</td>
</tr>
<tr class="even">
<td align="left">21</td>
<td align="center">1.679139</td>
</tr>
<tr class="odd">
<td align="left">22</td>
<td align="center">1.681461</td>
</tr>
<tr class="even">
<td align="left">23</td>
<td align="center">4.795710</td>
</tr>
<tr class="odd">
<td align="left">24</td>
<td align="center">4.898857</td>
</tr>
<tr class="even">
<td align="left">25</td>
<td align="center">4.999878</td>
</tr>
<tr class="odd">
<td align="left">100</td>
<td align="center">9.999878</td>
</tr>
<tr class="even">
<td align="left">500</td>
<td align="center">22.360558</td>
</tr>
<tr class="odd">
<td align="left">1000</td>
<td align="center">31.622654</td>
</tr>
</tbody>
</table>
<p><br />
Note that when k reaches a certain level,the solution is always approximately <span class="math inline">\(\sqrt{k}\)</span>,which is no longer reliable.But below a relatively low level,like <span class="math inline">\(k=4,5,\cdots,10\)</span>,we can see the result is similar to the one of 11.5.<br />
<br />
</p>
<p><strong>EM exercise:</strong><br />
<br />
</p>
<p>Observed data: <span class="math inline">\(Y_i,i=1,\cdots,10.\)</span><br />
Missed data: <span class="math inline">\(T_i,i=1,\cdots,10.\)</span><br />
As the mean of <span class="math inline">\(Exp(\lambda)\)</span> is <span class="math inline">\(\frac{1}{\lambda}\)</span>,<span class="math inline">\(T_i,i=1,\cdots,n\)</span> are drawn from <span class="math inline">\(Exp(\frac{1}{\lambda})\)</span>.<br />
<br />
According to <span class="math inline">\(Y_i=T_iI(T_i≤τ)+τI(T_i&gt;τ),i=1,\cdots,n\)</span>,for <span class="math inline">\(Y_i&lt;1\)</span>,we can actually know the corresponding missed data is itself.<br />
<br />
Rearrange <span class="math inline">\(Y_i\)</span> so that the first 7 elements are less than 1,the last 3 elements are 1,for example: <span class="math display">\[(X_1,\cdots,X_{10})=(0.54,0.48,0.33,0.43,0.91,0.21,0.85,1,1,1).\]</span><br />
<br />
Observed likelihood: <span class="math display">\[\begin{split}
L(\lambda|Y_1,\cdots,Y_{10})&amp;=\prod_{i=1}^{7}[\frac{1}{\lambda}exp(-\frac{X_i}{\lambda})]\prod_{i=8}^{10}P(X_i&gt;\tau)\\
&amp;=\lambda^{-7}exp(\frac{-\sum_{i=1}^{7}X_i}{\lambda})exp(\frac{-3\tau}{\lambda})
\end{split}\]</span> <span class="math display">\[ln L(\lambda|Y_1,\cdots,Y_{10})=-7ln\lambda-\frac{\sum_{i=1}^{7}X_i+3\tau }{\lambda}=-7ln\lambda-\frac{\sum_{i=1}^{10}Y_i}{\lambda}\]</span> <span class="math display">\[\frac{\partial L(\lambda|Y_1,\cdots,Y_{10})}{\partial \lambda}=-\frac{7}{\lambda}+\frac{\sum_{i=1}^{10}Y_i}{\lambda ^2}.\]</span><br />
Therefore,the MLE for observed data is <span class="math inline">\(\hat{\lambda}=\frac{\sum_{i=1}^{10}Y_i}{7}\)</span>.<br />
<br />
<br />
According to E-M algorithm,impute missed data <span class="math inline">\(T\)</span> with the conditional expectation <span class="math inline">\(E(T|Y,\lambda^{(k)})\)</span>,which maximizes the log-likelihood of the complete data.<br />
As said before,the first 7 <span class="math inline">\(T_i\)</span> is <span class="math inline">\(Y_i\)</span>,so we just consider <span class="math inline">\(E(T_j|\tau,\lambda^{(k)}).\)</span><br />
<span class="math display">\[\begin{split}
E(T_j|\tau,\lambda^{(k)})&amp;=\frac{E(T_jI(T_j&gt;\tau) |\lambda^{(k)}  )}{P(T_j&gt;\tau|\lambda^{(k)})} \\
&amp;=\frac{\int_{\tau}^{+\infty}x\frac{1}{\lambda^{(k)}}exp(-\frac{x}{\lambda^{(k)}})dx    }{exp(-\frac{\tau}{\lambda^{(k)}})]}  \\
&amp;=\frac{[\tau+ \lambda^{(k)}]exp(-\frac{\tau}{\lambda^{(k)}})}{exp(-\frac{\tau}{\lambda^{(k)}})]} \\
&amp;=\tau+ \lambda^{(k)}
\end{split}\]</span>.<br />
Complete likelihood:<br />
<span class="math display">\[\begin{split}
L^*(\lambda)&amp;=\lambda^{-10}exp(\frac{-\sum_{i=1}^{7}X_i}{\lambda})exp(\frac{-3[\tau+\lambda^{(k)}]}{\lambda})\\
&amp;=\lambda^{-10}exp(\sum_{i=1}^{10}Y_i+3\lambda^{(k)})
\end{split}\]</span> <span class="math display">\[lnL^*(\lambda)=-10ln\lambda-\frac{\sum_{i=1}^{10}Y_i+3\lambda^{(k)}}{\lambda}\]</span> Therefore,the MLE for complete data is <span class="math inline">\(\hat{\lambda}^{(k+1)}=\frac{\sum_{i=1}^{10}Y_i+3\lambda^{(k)}}{10}\)</span>.<br />
Assume the limit of <span class="math inline">\(\lambda^{(k)}\)</span> exists and equals to <span class="math inline">\(A\)</span>,then it satisfies <span class="math inline">\(A=\frac{\sum_{i=1}^{10}Y_i+3A}{10}\)</span>.<br />
We can get <span class="math inline">\(A=\frac{\sum_{i=1}^{10}Y_i}{7}\)</span>,which is just the MLE for observed data.<br />
<br />
The following codes verify this conclusion.<br />
</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.54</span>,<span class="fl">0.48</span>,<span class="fl">0.33</span>,<span class="fl">0.43</span>,<span class="fl">0.91</span>,<span class="fl">0.21</span>,<span class="fl">0.85</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="co">#log-likelihood for observed data </span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>loglike<span class="ot">&lt;-</span> <span class="cf">function</span>(lambda) {</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>        <span class="sc">-</span><span class="dv">7</span><span class="sc">*</span><span class="fu">log</span>(lambda)<span class="sc">-</span><span class="fu">sum</span>(Y)<span class="sc">/</span>lambda</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="co">#MLE for observed data </span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>lambdahat<span class="ot">&lt;-</span><span class="fu">optimize</span>(loglike,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>),<span class="at">maximum =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>maximum</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>prior<span class="ot">&lt;-</span>posterior<span class="ot">&lt;-</span>lambdahat     <span class="co">#initialize lambda^(k)</span></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>eps<span class="ot">&lt;-</span><span class="dv">1</span>                </span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a><span class="co">#log-likelihood for complete data </span></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>conditional<span class="ot">&lt;-</span><span class="cf">function</span>(lambda) {</span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>        <span class="sc">-</span><span class="dv">10</span><span class="sc">*</span><span class="fu">log</span>(lambda)<span class="sc">-</span>(<span class="fu">sum</span>(Y)<span class="sc">+</span><span class="dv">3</span><span class="sc">*</span>prior)<span class="sc">/</span>lambda</span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a><span class="co">#E-M iteration:</span></span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (eps<span class="sc">&gt;</span>.Machine<span class="sc">$</span>double.eps<span class="sc">^</span><span class="fl">0.25</span>) {</span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a>    prior<span class="ot">&lt;-</span>posterior</span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a>    posterior<span class="ot">&lt;-</span><span class="fu">optimize</span>(conditional,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="at">maximum =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>maximum</span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a>    eps<span class="ot">&lt;-</span><span class="fu">abs</span>(posterior<span class="sc">-</span>prior)</span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-27"><a href="#cb97-27" aria-hidden="true" tabindex="-1"></a><span class="co">#Present the result</span></span>
<span id="cb97-28"><a href="#cb97-28" aria-hidden="true" tabindex="-1"></a>results3<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb97-29"><a href="#cb97-29" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(results3)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;lambda&quot;</span>)</span>
<span id="cb97-30"><a href="#cb97-30" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results3)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;MLE for observed data&quot;</span>,<span class="st">&quot;E-M result&quot;</span>)</span>
<span id="cb97-31"><a href="#cb97-31" aria-hidden="true" tabindex="-1"></a>results3[,<span class="dv">1</span>]<span class="ot">&lt;-</span>lambdahat</span>
<span id="cb97-32"><a href="#cb97-32" aria-hidden="true" tabindex="-1"></a>results3[,<span class="dv">2</span>]<span class="ot">&lt;-</span>posterior</span>
<span id="cb97-33"><a href="#cb97-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-34"><a href="#cb97-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb97-35"><a href="#cb97-35" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(results3,<span class="at">align=</span><span class="fu">rep</span>(<span class="st">&#39;c&#39;</span>, <span class="dv">5</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">MLE for observed data</th>
<th align="center">E-M result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">lambda</td>
<td align="center">0.9642792</td>
<td align="center">0.9642879</td>
</tr>
</tbody>
</table>
<p><br />
We can see that the result of E-M algorithm is very similar to the MLE of observed data.<br />
<br />
## title: “2021—11—25”<br />
</p>
</div>
<div id="question-9" class="section level2">
<h2>Question</h2>
<p><br />
<strong>P204.1:</strong><br />
<br />
Why are the following two invocations of lapply() equivalent?<br />
trims&lt;-c(0, 0.1, 0.2, 0.5)<br />
x&lt;-rcauchy(100)<br />
lapply(trims, function(trim) mean(x, trim = trim))<br />
lapply(trims,mean,x=x)<br />
<br />
</p>
<p><strong>P204.5:</strong><br />
<br />
For each model in the previous two exercises, extract R2 using the function below.<br />
rsq &lt;- function(mod) summary(mod)$r.squared<br />
<br />
</p>
<p><strong>P213.1:</strong><br />
<br />
1. Use vapply() to:<br />
a) Compute the standard deviation of every column in a numeric data frame.<br />
b) Compute the standard deviation of every numeric column in a mixed data frame. (Hint: you’ll need to use vapply() twice.)</p>
<p><br />
<br />
</p>
<p><strong>P214.7:</strong><br />
<br />
Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(), a parallel version of vapply()?Why or why not?<br />
<br />
</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<p><br />
</p>
<p><strong>P204.1:</strong><br />
<br />
</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>trims <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rcauchy</span>(<span class="dv">100</span>)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="co">#For conciseness,use unlist() to convert the output from a list to a vector.</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="co">#the trim option in mean() is the fraction (0 to 0.5) of observations to be trimmed from each end of x before the mean is computed. </span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">lapply</span>(trims, <span class="cf">function</span>(trim) <span class="fu">mean</span>(x, <span class="at">trim =</span> trim)))</span></code></pre></div>
<pre><code>## [1] -0.6833833 -0.1376724 -0.1554591 -0.1689778</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">lapply</span>(trims, mean, <span class="at">x =</span> x))</span></code></pre></div>
<pre><code>## [1] -0.6833833 -0.1376724 -0.1554591 -0.1689778</code></pre>
<p><br />
The result is the same.<br />
<br />
The reason may be that:<br />
The first code uses an anonymous function to vary the amount of trimming applied when computing the mean of a fixed x.<br />
While the second code directly calls the mean function with its argument 1 “x” (which is assigned by “lapply” ) and argument 2 “trim” (which reflects the value of the current element).<br />
Therefore they are equivalent.<br />
<br />
</p>
<p><strong>P204.5:</strong><br />
<br />
</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exercise 3</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;mtcars&quot;</span>)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="co">#using the formulas stored in this list</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>( </span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>  mtcars<span class="sc">$</span>mpg <span class="sc">~</span> mtcars<span class="sc">$</span>disp,</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>  mtcars<span class="sc">$</span>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> mtcars<span class="sc">$</span>disp),</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>  mtcars<span class="sc">$</span>mpg <span class="sc">~</span> mtcars<span class="sc">$</span>disp <span class="sc">+</span> mtcars<span class="sc">$</span>wt,</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>  mtcars<span class="sc">$</span>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> mtcars<span class="sc">$</span>disp) <span class="sc">+</span> mtcars<span class="sc">$</span>wt</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(formulas)</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a><span class="co"># loop</span></span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>result<span class="ot">&lt;-</span><span class="fu">list</span>(n)</span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>   result[[i]]<span class="ot">&lt;-</span><span class="fu">summary</span>(<span class="fu">lm</span>(formulas[[i]]))<span class="sc">$</span>r.squared</span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(result)</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lapply</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">lapply</span>(formulas,<span class="cf">function</span>(x){</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="fu">lm</span>(x))<span class="sc">$</span>r.squared</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>}))</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<p><br />
Two methods derive the same result.<br />
</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exercise 4</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="co"># loop</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>result2<span class="ot">&lt;-</span><span class="fu">list</span>(<span class="dv">10</span>)</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>  result2[[i]]<span class="ot">&lt;-</span><span class="fu">summary</span>(<span class="fu">lm</span>(bootstraps[[i]]<span class="sc">$</span>mpg<span class="sc">~</span>bootstraps[[i]]<span class="sc">$</span>disp))<span class="sc">$</span>r.squared</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(result2)</span></code></pre></div>
<pre><code>##  [1] 0.8100899 0.7905919 0.7369329 0.6503512 0.6807263 0.7133723 0.5966238
##  [8] 0.7211264 0.7170140 0.8049097</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lapply</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">lapply</span>(bootstraps,<span class="cf">function</span>(x){</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summary</span>(<span class="fu">lm</span>(x<span class="sc">$</span>mpg<span class="sc">~</span>x<span class="sc">$</span>disp))<span class="sc">$</span>r.squared}))</span></code></pre></div>
<pre><code>##  [1] 0.8100899 0.7905919 0.7369329 0.6503512 0.6807263 0.7133723 0.5966238
##  [8] 0.7211264 0.7170140 0.8049097</code></pre>
<p><br />
Two methods derive the same result.<br />
<br />
</p>
<p><strong>P213.1:</strong><br />
<br />
(a)<br />
</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">rexp</span>(<span class="dv">1000</span>,<span class="dv">1</span>)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(x,y)</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(df,sd,<span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##         x         y 
## 0.2932324 1.0187673</code></pre>
<p>which is close to the standard deviation of U[0,1] (sd=$ $) and Exp(1) (sd=1).<br />
<br />
(b)<br />
Take an easy mixed data frame for example.<br />
</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>df2<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">y=</span><span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>))</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(df2[<span class="fu">vapply</span>(df2,is.numeric,<span class="fu">logical</span>(<span class="dv">1</span>))],sd,<span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##        x 
## 1.581139</code></pre>
<p><br />
</p>
<p><strong>P214.7:</strong><br />
<br />
The following codes implements a multi-core version of sapply().<br />
Note that Windows needs to set up a local cluster first.<br />
</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Error: processing vignette &#39;homework.Rmd&#39; failed with diagnostics:</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  4 simultaneous processes spawned,so don&#39;t present the result</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(parallel)</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="co"># options(warn=-1)           #neglect all the warnings</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="co"># cores&lt;-detectCores()</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="co"># cluster&lt;-makePSOCKcluster(cores)</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="co"># mcsapply&lt;-function(x,f){</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a><span class="co">#        out&lt;-parSapply(cluster,x,f)</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a><span class="co">#        simplify2array(out)</span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="co">#    }</span></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a><span class="co"># #Take an easy problem for example.</span></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a><span class="co"># system.time(mcsapply(x=1:1e6,f=mean))</span></span></code></pre></div>
<p><br />
The following codes implements a multi-core version of vapply().<br />
<br />
</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(parallel)</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="co"># options(warn=-1)           #neglect all the warnings</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="co"># cores&lt;-detectCores()</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="co"># cluster&lt;-makePSOCKcluster(cores)</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="co"># #FUN.VALUE=1.0 means the return value should be double(numeric) type.</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="co"># mcvapply&lt;-function(x,f,FUN.VALUE) {</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="co">#        out_list&lt;-parSapply(cluster,x,f)</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="co">#        out&lt;-matrix(rep(FUN.VALUE,length(x)),nrow=length(x))</span></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a><span class="co">#        for (i in seq_along(x)){</span></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a><span class="co">#            out[i,]&lt;-out_list[[i]]</span></span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a><span class="co">#        }</span></span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a><span class="co">#        out</span></span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a><span class="co"># #Take an easy problem for example.</span></span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a><span class="co"># system.time(mcvapply(x=1:1e6,f=mean,FUN.VALUE = 1.0))</span></span></code></pre></div>
<p><br />
<br />
</p>
</div>
<div id="title-20211202" class="section level2">
<h2>title: “2021—12—02”</h2>
<p><br />
</p>
</div>
<div id="question-10" class="section level2">
<h2>Question</h2>
<p><br />
<strong>Extension of 9.8:</strong><br />
<br />
This example appears in [40]. Consider the bivariate density <span class="math display">\[f(x,y)\propto\binom{n}{x}y^{x+a+1}(1-y)^{n-x+b-1},x=0,1,\cdots,n,0\leq y\leq 1\]</span> It can be shown that for fixed a, b, n, the conditional distributions are Binomial(n,y) and Beta(x+a,n−x+b). Use the Gibbs sampler to generate a chain with target joint density f(x,y).<br />
<br />
<br />
</p>
<p>For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to &lt; 1.2.<br />
<br />
Compare the corresponding generated random numbers with pure R language using the function “qqplot”.<br />
<br />
Compare the computation time of the two functions with the function “microbenchmark”.<br />
<br />
Comments your results.<br />
<br />
</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<p><br />
</p>
<p><strong>Rcpp function:</strong><br />
<br />
</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn=</span><span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Gibbs Sampler method using R</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>GibbsR<span class="ot">&lt;-</span><span class="cf">function</span> (a,b,N) {</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)            </span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>,]<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)                 <span class="co">#initialize       </span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span>X[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>X[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="at">size=</span>n,<span class="at">prob=</span>x2)</span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span>X[i,<span class="dv">1</span>]</span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>X[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1</span>,x1<span class="sc">+</span>a,n<span class="sc">-</span>x1<span class="sc">+</span>b)</span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span> (X)</span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Gibbs Sampler method using C</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cppFunction</span>(</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;NumericMatrix GibbsC (int a,int b,int N){</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="st">  NumericMatrix X(N,2); </span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="st">  X(0,0)=0;</span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a><span class="st">  X(0,1)=0;</span></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a><span class="st">  double n=25;</span></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a><span class="st">  double x1=0;</span></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a><span class="st">  double x2=0;</span></span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a><span class="st">  for (int i=1;i&lt;N;i++){ </span></span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a><span class="st">    x2=X(i-1,1);</span></span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a><span class="st">    X(i,0)=rbinom(1,n,x2)[0];</span></span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a><span class="st">    x1=X(i,0);</span></span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a><span class="st">    X(i,1)=rbeta(1,x1+a,n-x1+b)[0];</span></span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a><span class="st">  return X;</span></span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span>)</span></code></pre></div>
<p><br />
<strong>Comparison via qqplot():</strong><br />
</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">1</span>       </span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">25</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">10000</span>                 <span class="co">#length of chain</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>GR<span class="ot">&lt;-</span><span class="fu">GibbsR</span>(a,b,N)  </span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>GC<span class="ot">&lt;-</span><span class="fu">GibbsC</span>(a,b,N)</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Binomial condition function</span></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(GR[,<span class="dv">1</span>],GC[,<span class="dv">1</span>],<span class="at">xlab =</span> <span class="st">&quot;R function&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;C++ function&quot;</span>,<span class="at">main=</span> <span class="fu">paste</span>(<span class="st">&quot;a=&quot;</span>,a,<span class="st">&quot;,b=&quot;</span>,b,<span class="st">&quot;,n=&quot;</span>,n,<span class="st">&quot;,Condition function:Binomial&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Beta condition function</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(GR[,<span class="dv">2</span>],GC[,<span class="dv">2</span>],<span class="at">xlab =</span> <span class="st">&quot;R function&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;C++ function&quot;</span>,<span class="at">main=</span> <span class="fu">paste</span>(<span class="st">&quot;a=&quot;</span>,a,<span class="st">&quot;,b=&quot;</span>,b,<span class="st">&quot;,n=&quot;</span>,n,<span class="st">&quot;,Condition function:Beta&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
<strong>Comparison of running-time via microbenchmark():</strong><br />
</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>ts<span class="ot">&lt;-</span><span class="fu">microbenchmark</span>(<span class="at">GibbsUsingR=</span><span class="fu">GibbsR</span>(a,b,N), <span class="at">GibbsUsingC=</span><span class="fu">GibbsC</span>(a,b,N))</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)],<span class="at">align=</span><span class="fu">rep</span>(<span class="st">&#39;c&#39;</span>, <span class="dv">5</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">expr</th>
<th align="center">lq</th>
<th align="center">mean</th>
<th align="center">median</th>
<th align="center">uq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">GibbsUsingR</td>
<td align="center">63.992388</td>
<td align="center">67.257923</td>
<td align="center">65.149721</td>
<td align="center">66.554608</td>
</tr>
<tr class="even">
<td align="center">GibbsUsingC</td>
<td align="center">4.468663</td>
<td align="center">4.933231</td>
<td align="center">4.651774</td>
<td align="center">5.197774</td>
</tr>
</tbody>
</table>
<p><br />
Note that the unit of the result is millisecond.<br />
<br />
<strong>Comments:</strong><br />
<br />
From the Q-Q plot, we can believe that the random numbers generated by two methods approximately follow the same distribution.What’s more,both R method and C++ method (via rcpp function) yields satisfactory result.<br />
<br />
However,the running time of pure R function is much slower than the method using rcpp function,so consider using rcpp when faced with complex problems,especially when a loop is used.</p>
<p><br />
<br />
</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
